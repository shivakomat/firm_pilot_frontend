"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[514],{9514:(We,j,p)=>{p.r(j),p.d(j,{TaxConsultantModule:()=>Ke});var m=p(177),a=p(9417),g=p(803),k=p(8032),c=p.n(k),e=p(4438),f=p(6344);function C(i,s){1&i&&(e.j41(0,"tr")(1,"td",50)(2,"div",51)(3,"span",52),e.EFF(4,"Loading..."),e.k0s()(),e.j41(5,"p",53),e.EFF(6,"Loading intake forms..."),e.k0s()()())}function x(i,s){1&i&&(e.j41(0,"tr")(1,"td",50)(2,"div",54),e.nrm(3,"i",55),e.j41(4,"h5"),e.EFF(5,"No intake forms found"),e.k0s(),e.j41(6,"p"),e.EFF(7,"No intake forms match your current filters."),e.k0s()()()())}function P(i,s){if(1&i&&(e.j41(0,"div")(1,"h6",57),e.EFF(2),e.k0s(),e.j41(3,"span",67),e.EFF(4),e.k0s()()),2&i){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.projectName),e.R7$(2),e.SpI("ID: ",t.projectId,"")}}function y(i,s){1&i&&(e.j41(0,"span",54),e.EFF(1,"No Project"),e.k0s())}function w(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",74),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"reviewed"))}),e.nrm(1,"i",75),e.EFF(2,"Review "),e.k0s()}}function E(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",76),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"approved"))}),e.nrm(1,"i",77),e.EFF(2,"Approve "),e.k0s()}}function I(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",78),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"needs-revision"))}),e.nrm(1,"i",79),e.EFF(2,"Revise "),e.k0s()}}function R(i,s){if(1&i){const t=e.RV6();e.j41(0,"tr",56)(1,"td")(2,"div")(3,"h6",57),e.EFF(4),e.k0s(),e.j41(5,"p",58),e.EFF(6),e.k0s()()(),e.j41(7,"td"),e.DNE(8,P,5,2,"div",48)(9,y,2,0,"span",59),e.k0s(),e.j41(10,"td")(11,"span",60),e.EFF(12),e.k0s()(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"date"),e.k0s(),e.j41(16,"td")(17,"div",61)(18,"span",62),e.EFF(19),e.nI1(20,"titlecase"),e.k0s(),e.j41(21,"ul",63)(22,"li")(23,"a",64),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"draft"))}),e.EFF(24,"Draft"),e.k0s()(),e.j41(25,"li")(26,"a",64),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"submitted"))}),e.EFF(27,"Submitted"),e.k0s()(),e.j41(28,"li")(29,"a",64),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"reviewed"))}),e.EFF(30,"Reviewed"),e.k0s()(),e.j41(31,"li")(32,"a",64),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"approved"))}),e.EFF(33,"Approved"),e.k0s()(),e.j41(34,"li")(35,"a",64),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.updateStatus(n,"needs-revision"))}),e.EFF(36,"Needs Revision"),e.k0s()()()()(),e.j41(37,"td")(38,"div",11)(39,"div",65),e.nrm(40,"div",66),e.k0s(),e.j41(41,"span",67),e.EFF(42),e.k0s()()(),e.j41(43,"td"),e.EFF(44),e.nI1(45,"date"),e.k0s(),e.j41(46,"td")(47,"div",68)(48,"button",69),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.viewForm(n))}),e.nrm(49,"i",70),e.EFF(50,"View "),e.k0s(),e.DNE(51,w,3,0,"button",71)(52,E,3,0,"button",72)(53,I,3,0,"button",73),e.k0s()()()}if(2&i){const t=s.$implicit,o=e.XpG();e.Y8G("hidden",o.isLoading),e.R7$(4),e.JRh(t.clientName),e.R7$(2),e.JRh(t.clientEmail),e.R7$(2),e.Y8G("ngIf",t.projectName),e.R7$(),e.Y8G("ngIf",!t.projectName),e.R7$(3),e.SpI(" ",o.getFormTypeDisplay(t.title)," "),e.R7$(2),e.JRh(e.i5U(15,19,t.submittedAt,"short")),e.R7$(4),e.HbH(o.getStatusClass(t.responseStatus)),e.R7$(),e.SpI(" ",e.bMT(20,22,t.responseStatus)," "),e.R7$(21),e.HbH(100===o.getProgressPercentage(t.responseStatus)?"bg-success":"bg-warning"),e.xc7("width",o.getProgressPercentage(t.responseStatus),"%"),e.R7$(2),e.SpI("",o.getProgressPercentage(t.responseStatus),"%"),e.R7$(2),e.JRh(e.i5U(45,24,t.updatedAt,"short")),e.R7$(7),e.Y8G("ngIf","submitted"===t.responseStatus),e.R7$(),e.Y8G("ngIf","reviewed"===t.responseStatus),e.R7$(),e.Y8G("ngIf","submitted"===t.responseStatus||"reviewed"===t.responseStatus)}}let T=(()=>{class i{constructor(t,o){this.apiService=t,this.router=o,this.intakeForms=[],this.filteredForms=[],this.selectedStatus="all",this.selectedFormType="all",this.searchTerm="",this.isLoading=!1,this.stats={total:0,pending:0,reviewed:0,approved:0,needsRevision:0}}ngOnInit(){this.loadIntakeForms(),this.calculateStats()}loadIntakeForms(){this.isLoading=!0,console.log("\u{1f4dd} Loading intake forms from API..."),this.apiService.getAccountantIntakeForms(50,0).subscribe({next:t=>{this.isLoading=!1,t.success&&t.intakeForms?(this.intakeForms=t.intakeForms,this.filteredForms=[...this.intakeForms],this.calculateStats(),console.log("\u2705 Loaded intake forms:",this.intakeForms),console.log("\u{1f4ca} Total count:",t.totalCount,"Has more:",t.hasMore)):(console.warn("\u26a0\ufe0f API returned no forms or failed:",t),this.intakeForms=[],this.filteredForms=[],this.calculateStats())},error:t=>{this.isLoading=!1,console.error("\u274c Error loading intake forms:",t),c().fire({title:"Error Loading Forms",text:"Unable to load intake forms. Please try again later.",icon:"error",confirmButtonText:"OK"}),this.intakeForms=[],this.filteredForms=[],this.calculateStats()}})}calculateStats(){this.stats.total=this.intakeForms.length,this.stats.pending=this.intakeForms.filter(t=>"draft"===t.responseStatus).length,this.stats.reviewed=this.intakeForms.filter(t=>"reviewed"===t.responseStatus).length,this.stats.approved=this.intakeForms.filter(t=>"approved"===t.responseStatus).length,this.stats.needsRevision=this.intakeForms.filter(t=>"needs-revision"===t.responseStatus).length}filterForms(){this.filteredForms=this.intakeForms.filter(t=>{const o="all"===this.selectedStatus||t.responseStatus===this.selectedStatus,n="all"===this.selectedFormType,r=t.clientName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.clientEmail.toLowerCase().includes(this.searchTerm.toLowerCase())||t.title&&t.title.toLowerCase().includes(this.searchTerm.toLowerCase())||t.projectName&&t.projectName.toLowerCase().includes(this.searchTerm.toLowerCase());return o&&n&&r})}onStatusChange(){this.filterForms()}onFormTypeChange(){this.filterForms()}onSearchChange(){this.filterForms()}getStatusClass(t){switch(t){case"approved":return"badge bg-success";case"reviewed":return"badge bg-info";case"submitted":return"badge bg-primary";case"draft":return"badge bg-warning";case"needs-revision":return"badge bg-danger";default:return"badge bg-secondary"}}getFormTypeDisplay(t){return t.toLowerCase().includes("tax")?"Tax Form":t.toLowerCase().includes("business")?"Business Form":"Intake Form"}getProgressPercentage(t){switch(t){case"draft":return 25;case"submitted":return 50;case"reviewed":return 75;case"approved":return 100;case"needs-revision":return 60;default:return 0}}viewForm(t){console.log("\u{1f4cb} Navigating to intake form detail:",t.id),this.router.navigate(["/tax-consultant/intake-form-detail",t.id])}updateStatus(t,o){const n=t.responseStatus;t.responseStatus=o,t.updatedAt=(new Date).toISOString(),this.calculateStats(),this.filterForms(),c().fire({title:"Status Updated",text:`Form status changed from ${n} to ${o}`,icon:"success",timer:2e3,showConfirmButton:!1})}exportForms(){c().fire({title:"Export Started",text:"Preparing intake forms export...",icon:"info",timer:2e3,showConfirmButton:!1})}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(f.G),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-intake-forms"]],decls:119,vars:10,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],[1,"page-title-right"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"ri-download-line","me-1"],[1,"col-xl-3","col-md-6"],[1,"card","card-h-100"],[1,"card-body"],[1,"d-flex","align-items-center"],[1,"flex-grow-1"],[1,"text-muted","mb-3","lh-1","d-block","text-truncate"],[1,"mb-3"],[1,"flex-shrink-0"],["id","mini-chart1","data-colors",'["#5156be"]'],[1,"counter-value"],[1,"avatar-sm","rounded-circle","bg-warning-subtle"],[1,"avatar-title","rounded-circle","bg-warning-subtle","text-warning"],[1,"ri-time-line","font-size-24"],[1,"avatar-sm","rounded-circle","bg-success-subtle"],[1,"avatar-title","rounded-circle","bg-success-subtle","text-success"],[1,"ri-check-line","font-size-24"],[1,"avatar-sm","rounded-circle","bg-danger-subtle"],[1,"avatar-title","rounded-circle","bg-danger-subtle","text-danger"],[1,"ri-error-warning-line","font-size-24"],[1,"row","mt-4"],[1,"card"],[1,"row","mb-4"],[1,"col-md-3"],["for","statusFilter",1,"form-label"],["id","statusFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","all"],["value","pending"],["value","reviewed"],["value","approved"],["value","needs-revision"],["for","formTypeFilter",1,"form-label"],["id","formTypeFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","tax-intake"],["value","business-intake"],[1,"col-md-6"],["for","searchInput",1,"form-label"],["type","text","id","searchInput","placeholder","Search by client name, email, or project name...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-nowrap","table-hover"],[1,"table-light"],[4,"ngIf"],[3,"hidden",4,"ngFor","ngForOf"],["colspan","8",1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-2","text-muted"],[1,"text-muted"],[1,"ri-file-list-3-line","font-size-48","mb-3","d-block"],[3,"hidden"],[1,"mb-1"],[1,"text-muted","mb-0","font-size-12"],["class","text-muted",4,"ngIf"],[1,"badge","bg-primary-subtle","text-primary"],[1,"dropdown"],["data-bs-toggle","dropdown",1,"dropdown-toggle",2,"cursor","pointer"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"progress","flex-grow-1","me-2",2,"height","6px"],[1,"progress-bar"],[1,"text-muted","font-size-12"],[1,"d-flex","gap-2","flex-wrap"],["type","button","title","View Form Details",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"ri-eye-line","me-1"],["type","button","class","btn btn-sm btn-outline-success","title","Mark as Reviewed",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-success","title","Approve Form",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-warning","title","Request Revision",3,"click",4,"ngIf"],["type","button","title","Mark as Reviewed",1,"btn","btn-sm","btn-outline-success",3,"click"],[1,"ri-check-line","me-1"],["type","button","title","Approve Form",1,"btn","btn-sm","btn-outline-success",3,"click"],[1,"ri-check-double-line","me-1"],["type","button","title","Request Revision",1,"btn","btn-sm","btn-outline-warning",3,"click"],[1,"ri-edit-line","me-1"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e.EFF(5,"Client Intake Forms"),e.k0s(),e.j41(6,"div",5)(7,"button",6),e.bIt("click",function(){return n.exportForms()}),e.nrm(8,"i",7),e.EFF(9,"Export Forms "),e.k0s()()()()(),e.j41(10,"div",1)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"span",13),e.EFF(17,"Total Forms"),e.k0s(),e.j41(18,"h4",14),e.EFF(19),e.k0s()(),e.j41(20,"div",15),e.nrm(21,"div",16),e.k0s()()()()(),e.j41(22,"div",8)(23,"div",9)(24,"div",10)(25,"div",11)(26,"div",12)(27,"span",13),e.EFF(28,"Pending Review"),e.k0s(),e.j41(29,"h4",14)(30,"span",17),e.EFF(31),e.k0s()()(),e.j41(32,"div",15)(33,"div",18)(34,"span",19),e.nrm(35,"i",20),e.k0s()()()()()()(),e.j41(36,"div",8)(37,"div",9)(38,"div",10)(39,"div",11)(40,"div",12)(41,"span",13),e.EFF(42,"Approved"),e.k0s(),e.j41(43,"h4",14),e.EFF(44),e.k0s()(),e.j41(45,"div",15)(46,"div",21)(47,"span",22),e.nrm(48,"i",23),e.k0s()()()()()()(),e.j41(49,"div",8)(50,"div",9)(51,"div",10)(52,"div",11)(53,"div",12)(54,"span",13),e.EFF(55,"Needs Revision"),e.k0s(),e.j41(56,"h4",14),e.EFF(57),e.k0s()(),e.j41(58,"div",15)(59,"div",24)(60,"span",25),e.nrm(61,"i",26),e.k0s()()()()()()()(),e.j41(62,"div",27)(63,"div",2)(64,"div",28)(65,"div",10)(66,"div",29)(67,"div",30)(68,"label",31),e.EFF(69,"Filter by Status"),e.k0s(),e.j41(70,"select",32),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedStatus,l)||(n.selectedStatus=l),l}),e.bIt("change",function(){return n.onStatusChange()}),e.j41(71,"option",33),e.EFF(72,"All Statuses"),e.k0s(),e.j41(73,"option",34),e.EFF(74,"Pending"),e.k0s(),e.j41(75,"option",35),e.EFF(76,"Reviewed"),e.k0s(),e.j41(77,"option",36),e.EFF(78,"Approved"),e.k0s(),e.j41(79,"option",37),e.EFF(80,"Needs Revision"),e.k0s()()(),e.j41(81,"div",30)(82,"label",38),e.EFF(83,"Filter by Form Type"),e.k0s(),e.j41(84,"select",39),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedFormType,l)||(n.selectedFormType=l),l}),e.bIt("change",function(){return n.onFormTypeChange()}),e.j41(85,"option",33),e.EFF(86,"All Types"),e.k0s(),e.j41(87,"option",40),e.EFF(88,"Tax Intake"),e.k0s(),e.j41(89,"option",41),e.EFF(90,"Business Intake"),e.k0s()()(),e.j41(91,"div",42)(92,"label",43),e.EFF(93,"Search Forms"),e.k0s(),e.j41(94,"input",44),e.mxI("ngModelChange",function(l){return e.DH7(n.searchTerm,l)||(n.searchTerm=l),l}),e.bIt("input",function(){return n.onSearchChange()}),e.k0s()()(),e.j41(95,"div",45)(96,"table",46)(97,"thead",47)(98,"tr")(99,"th"),e.EFF(100,"Client"),e.k0s(),e.j41(101,"th"),e.EFF(102,"Project"),e.k0s(),e.j41(103,"th"),e.EFF(104,"Form Type"),e.k0s(),e.j41(105,"th"),e.EFF(106,"Submission Date"),e.k0s(),e.j41(107,"th"),e.EFF(108,"Status"),e.k0s(),e.j41(109,"th"),e.EFF(110,"Progress"),e.k0s(),e.j41(111,"th"),e.EFF(112,"Last Modified"),e.k0s(),e.j41(113,"th"),e.EFF(114,"Actions"),e.k0s()()(),e.j41(115,"tbody"),e.DNE(116,C,7,0,"tr",48)(117,x,8,0,"tr",48)(118,R,54,27,"tr",49),e.k0s()()()()()()()()),2&o&&(e.R7$(19),e.JRh(n.stats.total),e.R7$(12),e.JRh(n.stats.pending),e.R7$(13),e.JRh(n.stats.approved),e.R7$(13),e.JRh(n.stats.needsRevision),e.R7$(13),e.R50("ngModel",n.selectedStatus),e.R7$(14),e.R50("ngModel",n.selectedFormType),e.R7$(10),e.R50("ngModel",n.searchTerm),e.R7$(22),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&0===n.filteredForms.length),e.R7$(),e.Y8G("ngForOf",n.filteredForms))},dependencies:[m.Sq,m.bT,a.xH,a.y7,a.me,a.wz,a.BC,a.vS,m.PV,m.vh],styles:[".card-h-100[_ngcontent-%COMP%]{height:100%}.avatar-sm[_ngcontent-%COMP%]{height:2rem;width:2rem}.avatar-title[_ngcontent-%COMP%]{align-items:center;background-color:#556ee6;color:#fff;display:flex;font-weight:500;height:100%;justify-content:center;width:100%}.bg-primary-subtle[_ngcontent-%COMP%]{background-color:#556ee61a!important}.bg-success-subtle[_ngcontent-%COMP%]{background-color:#34c38f1a!important}.bg-warning-subtle[_ngcontent-%COMP%]{background-color:#fcb92c1a!important}.bg-danger-subtle[_ngcontent-%COMP%]{background-color:#f46a6a1a!important}.progress[_ngcontent-%COMP%]{height:6px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;border-top:none}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.badge[_ngcontent-%COMP%]{font-size:.75rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem;white-space:nowrap;transition:all .2s ease-in-out}.btn-sm[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}.btn-sm[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.d-flex.gap-2[_ngcontent-%COMP%]{min-width:200px}.d-flex.gap-2[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex-shrink:0}.btn-outline-primary[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #556ee633}.btn-outline-success[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #34c38f33}.btn-outline-warning[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #f1b44c33}@media (max-width: 768px){.d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem!important;min-width:auto}.d-flex.gap-2[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;justify-content:center}.table-responsive[_ngcontent-%COMP%]   .btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:transform .2s ease-in-out;box-shadow:0 1rem 2rem #12263f1a}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}"]})}}return i})();var _=p(1413);function D(i,s){1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"div",12)(3,"div",13)(4,"div",14)(5,"span",15),e.EFF(6,"Loading..."),e.k0s()(),e.j41(7,"p",16),e.EFF(8,"Loading intake form details..."),e.k0s()()()()())}function M(i,s){if(1&i&&(e.j41(0,"div"),e.nrm(1,"i",44),e.EFF(2),e.nI1(3,"date"),e.k0s()),2&i){const t=e.XpG(2);e.R7$(2),e.SpI(" Submitted: ",e.i5U(3,1,t.formResponse.submittedAt,"short")," ")}}function S(i,s){1&i&&(e.j41(0,"div"),e.nrm(1,"i",45),e.EFF(2," Draft - Not yet submitted "),e.k0s())}function O(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.updateFormStatus("REVIEWED"))}),e.nrm(1,"i",47),e.EFF(2,"Mark as Reviewed "),e.k0s()}}function N(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.updateFormStatus("APPROVED"))}),e.nrm(1,"i",49),e.EFF(2,"Approve "),e.k0s()}}function $(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.updateFormStatus("NEEDS_REVISION"))}),e.nrm(1,"i",51),e.EFF(2,"Request Revision "),e.k0s()}}function G(i,s){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.value||"Not provided")}}function L(i,s){if(1&i&&(e.j41(0,"span",22),e.nrm(1,"i",63),e.EFF(2),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",t.value||"Not provided"," ")}}function B(i,s){if(1&i&&(e.j41(0,"div",58)(1,"div",59)(2,"label",60),e.EFF(3),e.k0s(),e.j41(4,"div",61),e.DNE(5,G,2,1,"span",27)(6,L,3,1,"span",62),e.k0s()()()),2&i){const t=s.$implicit;e.AVh("col-12","dependent"===t.type),e.R7$(3),e.JRh(t.label),e.R7$(2),e.Y8G("ngIf",!t.sensitive),e.R7$(),e.Y8G("ngIf",t.sensitive)}}function A(i,s){if(1&i&&(e.j41(0,"div",52)(1,"div",53)(2,"h6",54),e.nrm(3,"i",55),e.EFF(4),e.k0s(),e.nrm(5,"hr",56),e.k0s(),e.j41(6,"div",1),e.DNE(7,B,7,5,"div",57),e.k0s()()),2&i){const t=s.$implicit;e.R7$(4),e.SpI(" ",t.title," "),e.R7$(3),e.Y8G("ngForOf",t.fields)}}function Y(i,s){if(1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"div",12)(3,"div",17)(4,"div",18)(5,"div",19)(6,"h5",20),e.EFF(7,"Tax Information Form"),e.k0s(),e.j41(8,"div",21)(9,"div")(10,"span",22),e.EFF(11,"Client ID:"),e.k0s(),e.j41(12,"strong",23),e.EFF(13),e.k0s()(),e.j41(14,"div")(15,"span",22),e.EFF(16,"Form ID:"),e.k0s(),e.j41(17,"strong",23),e.EFF(18),e.k0s()(),e.j41(19,"div")(20,"span",22),e.EFF(21,"Response ID:"),e.k0s(),e.j41(22,"strong",23),e.EFF(23),e.k0s()()()(),e.j41(24,"div",24)(25,"div",25)(26,"span"),e.EFF(27),e.nI1(28,"titlecase"),e.k0s()(),e.j41(29,"div",26),e.DNE(30,M,4,4,"div",27)(31,S,3,0,"div",27),e.k0s()()(),e.j41(32,"div",28)(33,"div",29),e.DNE(34,O,3,0,"button",30)(35,N,3,0,"button",31)(36,$,3,0,"button",32),e.k0s()()()()(),e.j41(37,"div",2)(38,"div",12)(39,"div",17)(40,"h5",33),e.nrm(41,"i",34),e.EFF(42," Form Responses "),e.k0s(),e.DNE(43,A,8,2,"div",35),e.j41(44,"div",36)(45,"div",37)(46,"h6",38),e.EFF(47,"Raw Form Data"),e.k0s(),e.j41(48,"button",39),e.nrm(49,"i",40),e.EFF(50,"View JSON "),e.k0s()(),e.j41(51,"div",41)(52,"div",42)(53,"pre",43),e.EFF(54),e.nI1(55,"json"),e.k0s()()()()()()()()),2&i){const t=e.XpG();e.R7$(13),e.JRh(t.formResponse.clientId),e.R7$(5),e.JRh(t.formResponse.formId),e.R7$(5),e.JRh(t.formResponse.id),e.R7$(3),e.HbH(t.getStatusClass(t.formResponse.status)),e.R7$(),e.SpI(" ",e.bMT(28,13,t.formResponse.status)," "),e.R7$(3),e.Y8G("ngIf",t.formResponse.submittedAt),e.R7$(),e.Y8G("ngIf",!t.formResponse.submittedAt),e.R7$(3),e.Y8G("ngIf","SUBMITTED"===t.formResponse.status),e.R7$(),e.Y8G("ngIf","REVIEWED"===t.formResponse.status),e.R7$(),e.Y8G("ngIf","REVIEWED"===t.formResponse.status||"SUBMITTED"===t.formResponse.status),e.R7$(7),e.Y8G("ngForOf",t.formSections),e.R7$(11),e.JRh(e.bMT(55,15,t.formResponse.answersJson))}}function V(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",12)(3,"div",13)(4,"div",22),e.nrm(5,"i",64),e.j41(6,"h5"),e.EFF(7,"No Form Data Found"),e.k0s(),e.j41(8,"p"),e.EFF(9,"The requested intake form could not be found or has no responses."),e.k0s(),e.j41(10,"button",65),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goBack())}),e.nrm(11,"i",6),e.EFF(12,"Back to Forms "),e.k0s()()()()()()}}let U=(()=>{class i{constructor(t,o,n){this.route=t,this.router=o,this.apiService=n,this.destroy$=new _.B,this.intakeForm=null,this.formResponse=null,this.isLoading=!1,this.formSections=[]}ngOnInit(){this.route.params.subscribe(t=>{this.formId=+t.id,this.formId&&this.loadIntakeFormDetails()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadIntakeFormDetails(){this.isLoading=!0,console.log("\u{1f4dd} Loading intake form details for ID:",this.formId),this.apiService.getIntakeFormDetails(this.formId).subscribe({next:t=>{this.isLoading=!1,t.success&&t.responses&&t.responses.length>0?(this.formResponse=t.responses[0],this.processFormData(),console.log("\u2705 Loaded intake form details:",this.formResponse)):(console.warn("\u26a0\ufe0f No form responses found:",t),this.showErrorMessage("No form data found"))},error:t=>{this.isLoading=!1,console.error("\u274c Error loading intake form details:",t),this.showErrorMessage("Failed to load intake form details")}})}processFormData(){if(!this.formResponse?.answersJson)return;const t=this.formResponse.answersJson;console.log("\u{1f50d} Processing form answers:",t),this.formSections=[{title:"Personal Information",fields:[{label:"First Name",value:t.firstName,key:"firstName"},{label:"Last Name",value:t.lastName,key:"lastName"},{label:"SSN",value:t.ssn,key:"ssn",sensitive:!0},{label:"Filing Status",value:this.formatFilingStatus(t.filingStatus),key:"filingStatus"}]},{title:"Income Information",fields:[{label:"W-2 Income",value:this.formatCurrency(t.w2Income),key:"w2Income"},{label:"Has Business Income",value:t.hasBusinessIncome?"Yes":"No",key:"hasBusinessIncome"},{label:"Estimated Tax Payments",value:this.formatCurrency(t.estimatedTaxPayments),key:"estimatedTaxPayments"}]}],t.dependents&&t.dependents.length>0&&this.formSections.push({title:"Dependents",fields:t.dependents.map((o,n)=>({label:`Dependent ${n+1}`,value:`${o.name} (${o.relationship}, age ${o.age})`,key:`dependent_${n}`,type:"dependent"}))})}formatFilingStatus(t){return{single:"Single",married_filing_jointly:"Married Filing Jointly",married_filing_separately:"Married Filing Separately",head_of_household:"Head of Household",qualifying_widow:"Qualifying Widow(er)"}[t]||t}formatCurrency(t){if(!t)return"Not provided";const o="string"==typeof t?parseFloat(t):t;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o)}getStatusClass(t){switch(t?.toUpperCase()){case"APPROVED":return"badge bg-success";case"REVIEWED":return"badge bg-info";case"SUBMITTED":return"badge bg-primary";case"DRAFT":return"badge bg-warning";case"NEEDS_REVISION":return"badge bg-danger";default:return"badge bg-secondary"}}updateFormStatus(t){this.formResponse&&c().fire({title:"Update Status",text:`Change status to ${t}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#556ee6",cancelButtonColor:"#74788d",confirmButtonText:"Yes, Update",cancelButtonText:"Cancel"}).then(o=>{o.isConfirmed&&(this.formResponse.status=t,c().fire({title:"Status Updated!",text:`Form status changed to ${t}`,icon:"success",timer:2e3,showConfirmButton:!1}))})}goBack(){this.router.navigate(["/tax-consultant/intake-forms"])}exportForm(){c().fire({title:"Export Started",text:"Preparing form export...",icon:"info",timer:2e3,showConfirmButton:!1})}showErrorMessage(t){c().fire({title:"Error",text:t,icon:"error",confirmButtonText:"OK"})}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(g.nX),e.rXU(g.Ix),e.rXU(f.G))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-intake-form-detail"]],decls:17,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],["type","button",1,"btn","btn-outline-secondary","btn-sm","me-3",3,"click"],[1,"ri-arrow-left-line","me-1"],[1,"mb-sm-0","font-size-18"],[1,"page-title-right"],["type","button",1,"btn","btn-success","btn-sm","me-2",3,"click"],[1,"ri-download-line","me-1"],["class","row",4,"ngIf"],[1,"card"],[1,"card-body","text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-3","text-muted"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"card-title","mb-2"],[1,"d-flex","flex-wrap","gap-3","mb-3"],[1,"text-muted"],[1,"ms-1"],[1,"col-md-4","text-md-end"],[1,"mb-2"],[1,"text-muted","small"],[4,"ngIf"],[1,"border-top","pt-3"],[1,"d-flex","flex-wrap","gap-2"],["type","button","class","btn btn-outline-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-success btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-warning btn-sm",3,"click",4,"ngIf"],[1,"card-title","mb-4"],[1,"ri-file-list-3-line","text-primary","me-2"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-muted","mb-0"],["type","button","data-bs-toggle","collapse","data-bs-target","#rawDataCollapse",1,"btn","btn-outline-secondary","btn-sm"],[1,"ri-code-line","me-1"],["id","rawDataCollapse",1,"collapse"],[1,"bg-light","p-3","rounded"],[1,"mb-0","small"],[1,"ri-time-line","me-1"],[1,"ri-draft-line","me-1"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"ri-check-line","me-1"],["type","button",1,"btn","btn-outline-success","btn-sm",3,"click"],[1,"ri-check-double-line","me-1"],["type","button",1,"btn","btn-outline-warning","btn-sm",3,"click"],[1,"ri-edit-line","me-1"],[1,"mb-4"],[1,"section-header","mb-3"],[1,"text-primary","mb-0"],[1,"ri-folder-line","me-2"],[1,"mt-2"],["class","col-md-6 mb-3",3,"col-12",4,"ngFor","ngForOf"],[1,"col-md-6","mb-3"],[1,"form-group"],[1,"form-label","text-muted","small"],[1,"form-control-plaintext","bg-light","p-2","rounded"],["class","text-muted",4,"ngIf"],[1,"ri-eye-off-line","me-1"],[1,"ri-file-list-3-line","font-size-48","mb-3","d-block"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),e.bIt("click",function(){return n.goBack()}),e.nrm(6,"i",6),e.EFF(7,"Back to Forms "),e.k0s(),e.j41(8,"h4",7),e.EFF(9,"Intake Form Details"),e.k0s()(),e.j41(10,"div",8)(11,"button",9),e.bIt("click",function(){return n.exportForm()}),e.nrm(12,"i",10),e.EFF(13,"Export "),e.k0s()()()()(),e.DNE(14,D,9,0,"div",11)(15,Y,56,17,"div",11)(16,V,13,0,"div",11),e.k0s()),2&o&&(e.R7$(14),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&n.formResponse),e.R7$(),e.Y8G("ngIf",!n.isLoading&&!n.formResponse))},dependencies:[m.Sq,m.bT,m.TG,m.PV,m.vh],styles:[".section-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#556ee6;font-weight:600}.section-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]   .ri-folder-line[_ngcontent-%COMP%]{font-size:1.1rem}.section-header[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border-color:#556ee633;margin-bottom:0}.form-control-plaintext[_ngcontent-%COMP%]{border:1px solid #e9ecef;font-size:.875rem;min-height:38px;display:flex;align-items:center}.form-control-plaintext.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important}.card-title[_ngcontent-%COMP%]   .ri-file-list-3-line[_ngcontent-%COMP%]{font-size:1.25rem}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .75rem}.badge.bg-success[_ngcontent-%COMP%]{background-color:#34c38f!important}.badge.bg-info[_ngcontent-%COMP%]{background-color:#50a5f1!important}.badge.bg-primary[_ngcontent-%COMP%]{background-color:#556ee6!important}.badge.bg-warning[_ngcontent-%COMP%]{background-color:#f1b44c!important}.badge.bg-danger[_ngcontent-%COMP%]{background-color:#f46a6a!important}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem}.btn-sm[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}pre[_ngcontent-%COMP%]{font-size:.75rem;color:#495057;max-height:300px;overflow-y:auto}pre[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}pre[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}pre[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}pre[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.page-title-box[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important}.page-title-box[_ngcontent-%COMP%]   .page-title-right[_ngcontent-%COMP%]{margin-top:1rem}.d-flex.flex-wrap.gap-3[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem!important}}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}.font-size-48[_ngcontent-%COMP%]{font-size:3rem!important;color:#adb5bd}"]})}}return i})();var u=p(6977);function X(i,s){if(1&i&&(e.j41(0,"option",51),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.Lme("",t.firstName," ",t.lastName,"")}}function z(i,s){if(1&i&&(e.j41(0,"option",51),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function J(i,s){if(1&i&&(e.j41(0,"option",51),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function H(i,s){if(1&i&&(e.j41(0,"span",64),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.projectName)}}function q(i,s){1&i&&(e.j41(0,"span",65),e.EFF(1,"No project"),e.k0s())}function Q(i,s){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",11),e.nrm(3,"i",53),e.j41(4,"div")(5,"h6",54),e.EFF(6),e.k0s(),e.j41(7,"p",55),e.EFF(8),e.k0s()()()(),e.j41(9,"td")(10,"div")(11,"h6",54)(12,"a",56),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewClientDetail(n))}),e.EFF(13),e.k0s()(),e.j41(14,"p",55),e.EFF(15),e.k0s()()(),e.j41(16,"td"),e.DNE(17,H,2,1,"span",57)(18,q,2,0,"span",58),e.k0s(),e.j41(19,"td")(20,"span"),e.EFF(21),e.k0s()(),e.j41(22,"td")(23,"span",59),e.EFF(24),e.k0s()(),e.j41(25,"td")(26,"span"),e.EFF(27),e.k0s()(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td")(31,"div",60)(32,"button",61),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewDocumentInNewTab(n))}),e.nrm(33,"i",62),e.EFF(34,"View "),e.k0s(),e.j41(35,"button",63),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.downloadDocument(n))}),e.nrm(36,"i",7),e.EFF(37,"Download "),e.k0s()()()()}if(2&i){const t=s.$implicit,o=e.XpG(2);e.R7$(6),e.JRh(t.filename),e.R7$(2),e.JRh(t.mimeType),e.R7$(5),e.SpI(" ",t.clientName," "),e.R7$(2),e.JRh(t.clientEmail),e.R7$(2),e.Y8G("ngIf",t.projectName),e.R7$(),e.Y8G("ngIf",!t.projectName),e.R7$(2),e.HbH(o.getTagClass(t.tag)),e.R7$(),e.JRh(t.tag),e.R7$(3),e.JRh(o.formatFileSize(t.sizeBytes)),e.R7$(2),e.HbH(o.getRequiredClass(t.required)),e.R7$(),e.SpI(" ",o.getRequiredText(t.required)," "),e.R7$(2),e.JRh(o.formatDate(t.uploadedAt)),e.R7$(3),e.Mz_("title","View ",t.filename," in new tab"),e.R7$(3),e.Mz_("title","Download ",t.filename,"")}}function K(i,s){1&i&&(e.j41(0,"tr")(1,"td",66),e.nrm(2,"i",67),e.j41(3,"h5"),e.EFF(4,"No Documents Found"),e.k0s(),e.j41(5,"p"),e.EFF(6,"No documents match your current filter criteria."),e.k0s()()())}function W(i,s){if(1&i&&(e.qex(0),e.DNE(1,Q,38,18,"tr",52)(2,K,7,0,"tr",50),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredDocuments),e.R7$(),e.Y8G("ngIf",0===t.filteredDocuments.length)}}function Z(i,s){1&i&&(e.j41(0,"tr")(1,"td",68)(2,"div",69)(3,"span",70),e.EFF(4,"Loading..."),e.k0s()(),e.j41(5,"p",71),e.EFF(6,"Loading documents..."),e.k0s()()())}let ee=(()=>{class i{constructor(t,o){this.apiService=t,this.router=o,this.destroy$=new _.B,this.documents=[],this.filteredDocuments=[],this.clients=[],this.projects=[],this.selectedClient="all",this.selectedProject="all",this.selectedTag="all",this.selectedRequired="all",this.searchTerm="",this.isLoading=!1,this.stats={total:0,required:0,optional:0,byTag:new Map},this.availableTags=[]}ngOnInit(){this.loadDocuments()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadDocuments(){this.isLoading=!0;const t=this.apiService.getAllDocuments(),o=this.apiService.getClients();t.pipe((0,u.Q)(this.destroy$)).subscribe({next:n=>{n.success?o.pipe((0,u.Q)(this.destroy$)).subscribe({next:r=>{r.success&&(this.clients=r.clients,this.documents=n.documents.map(l=>({...l,clientName:this.getClientName(l.clientId,this.clients),clientEmail:this.getClientEmail(l.clientId,this.clients),projectName:""})),this.extractProjectsFromDocuments(),this.filteredDocuments=[...this.documents],this.calculateStats(),this.extractTags()),this.isLoading=!1},error:r=>{console.error("Error loading clients:",r),this.isLoading=!1,this.documents=n.documents.map(l=>({...l,clientName:`Client ${l.clientId}`,clientEmail:"",projectName:""})),this.filteredDocuments=[...this.documents],this.calculateStats(),this.extractTags()}}):this.isLoading=!1},error:n=>{console.error("Error loading documents:",n),this.isLoading=!1,c().fire({title:"Error",text:"Failed to load documents. Please try again.",icon:"error"})}})}extractProjectsFromDocuments(){const t=new Set;this.documents.forEach(o=>{o.projectId&&t.add(o.projectId)}),this.projects=Array.from(t).map(o=>({id:o,name:`Project ${o}`,clientId:0,accountantId:0,projectType:"other",status:"active",createdAt:"",updatedAt:""}))}getClientName(t,o){const n=o.find(r=>r.id===t);return n?`${n.firstName} ${n.lastName}`:"Unknown Client"}getClientEmail(t,o){return o.find(r=>r.id===t)?.email||""}getProjectName(t,o){return o.find(r=>r.id===t)?.name||""}calculateStats(){this.stats.total=this.documents.length,this.stats.required=this.documents.filter(t=>t.required).length,this.stats.optional=this.documents.filter(t=>!t.required).length,this.stats.byTag.clear(),this.documents.forEach(t=>{if(t.tag&&t.tag.trim()){const o=this.stats.byTag.get(t.tag)||0;this.stats.byTag.set(t.tag,o+1)}})}extractTags(){const t=new Set;this.documents.forEach(o=>{o.tag&&o.tag.trim()&&t.add(o.tag)}),this.availableTags=Array.from(t).sort()}filterDocuments(){this.filteredDocuments=this.documents.filter(t=>{const o="all"===this.selectedClient||t.clientId.toString()===this.selectedClient,n="all"===this.selectedProject||t.projectId.toString()===this.selectedProject,r="all"===this.selectedTag||t.tag===this.selectedTag,l="all"===this.selectedRequired||"required"===this.selectedRequired&&t.required||"optional"===this.selectedRequired&&!t.required,d=(t.filename||"").toLowerCase().includes(this.searchTerm.toLowerCase())||(t.clientName||"").toLowerCase().includes(this.searchTerm.toLowerCase())||(t.tag||"").toLowerCase().includes(this.searchTerm.toLowerCase());return o&&n&&r&&l&&d})}onClientChange(){this.filterDocuments()}onProjectChange(){this.filterDocuments()}onTagChange(){this.filterDocuments()}onRequiredChange(){this.filterDocuments()}onSearchChange(){this.filterDocuments()}getRequiredClass(t){return t?"badge bg-warning":"badge bg-secondary"}getRequiredText(t){return t?"Required":"Optional"}getTagClass(t){if(!t)return"badge bg-secondary";switch(t.toLowerCase()){case"w2":return"badge bg-primary";case"1099":return"badge bg-info";case"receipt":return"badge bg-warning";case"bank_statement":return"badge bg-success";case"tax_return":return"badge bg-danger";default:return"badge bg-secondary"}}viewDocument(t){c().fire({title:"View Document",text:`Opening ${t.filename} for ${t.clientName}`,icon:"info",timer:2e3,showConfirmButton:!1})}viewDocumentInNewTab(t){console.log("Opening document in new tab:",t),c().fire({title:"Opening Document...",text:"Please wait while we prepare the document for viewing.",icon:"info",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{c().showLoading()}}),this.apiService.downloadDocument(t.id).pipe((0,u.Q)(this.destroy$)).subscribe({next:o=>{const n=window.URL.createObjectURL(o);window.open(n,"_blank")?(setTimeout(()=>{window.URL.revokeObjectURL(n)},1e4),c().close()):(window.URL.revokeObjectURL(n),c().fire({title:"Popup Blocked",text:"Your browser blocked the popup. The document will be downloaded instead.",icon:"warning",timer:3e3,showConfirmButton:!1}),this.downloadDocument(t))},error:o=>{console.error("Error viewing document:",o);let n="Failed to open document. Please try again.";404===o.status?n="Document not found. It may have been moved or deleted.":403===o.status?n="You do not have permission to view this document.":401===o.status&&(n="Your session has expired. Please log in again."),c().fire({title:"View Failed",text:n,icon:"error",confirmButtonText:"OK"})}})}downloadDocument(t){console.log("Downloading document:",t),c().fire({title:"Downloading...",text:"Please wait while we prepare your document.",icon:"info",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{c().showLoading()}}),this.apiService.downloadDocument(t.id).pipe((0,u.Q)(this.destroy$)).subscribe({next:o=>{const n=window.URL.createObjectURL(o),r=window.document.createElement("a");r.href=n,r.download=t.filename,window.document.body.appendChild(r),r.click(),window.document.body.removeChild(r),window.URL.revokeObjectURL(n),c().fire({title:"Download Complete!",text:`${t.filename} has been downloaded successfully.`,icon:"success",timer:3e3,showConfirmButton:!1})},error:o=>{console.error("Error downloading document:",o);let n="Failed to download document. Please try again.";404===o.status?n="Document not found. It may have been moved or deleted.":403===o.status?n="You do not have permission to download this document.":401===o.status&&(n="Your session has expired. Please log in again."),c().fire({title:"Download Failed",text:n,icon:"error",confirmButtonText:"OK"})}})}formatFileSize(t){if(0===t)return"0 Bytes";const r=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]}formatDate(t){return t?new Date(t).toLocaleDateString():"Not set"}exportDocuments(){c().fire({title:"Export Started",text:"Preparing documents export...",icon:"info",timer:2e3,showConfirmButton:!1})}viewClientDetail(t){const o=this.clients.find(n=>n.firstName+" "+n.lastName===t.clientName||n.email===t.clientEmail);o&&o.id&&this.router.navigate(["/clients/detail",o.id])}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(f.G),e.rXU(g.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-client-documents"]],decls:127,vars:14,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],[1,"page-title-right"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"ri-download-line","me-1"],[1,"col-xl-3","col-md-6"],[1,"card","card-h-100"],[1,"card-body"],[1,"d-flex","align-items-center"],[1,"flex-grow-1"],[1,"text-muted","mb-3","lh-1","d-block","text-truncate"],[1,"mb-3"],[1,"flex-shrink-0"],[1,"avatar-sm","rounded-circle","bg-primary-subtle"],[1,"avatar-title","rounded-circle","bg-primary-subtle","text-primary"],[1,"ri-file-text-line","font-size-24"],[1,"avatar-sm","rounded-circle","bg-warning-subtle"],[1,"avatar-title","rounded-circle","bg-warning-subtle","text-warning"],[1,"ri-alert-line","font-size-24"],[1,"avatar-sm","rounded-circle","bg-success-subtle"],[1,"avatar-title","rounded-circle","bg-success-subtle","text-success"],[1,"ri-check-line","font-size-24"],[1,"avatar-sm","rounded-circle","bg-info-subtle"],[1,"avatar-title","rounded-circle","bg-info-subtle","text-info"],[1,"ri-price-tag-3-line","font-size-24"],[1,"mb-4"],[1,"card"],[1,"row","mb-4"],[1,"col-md-2"],["for","clientFilter",1,"form-label"],["id","clientFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],["for","projectFilter",1,"form-label"],["id","projectFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["for","tagFilter",1,"form-label"],["id","tagFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["for","requiredFilter",1,"form-label"],["id","requiredFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","required"],["value","optional"],[1,"col-md-4"],["for","searchInput",1,"form-label"],["type","text","id","searchInput","placeholder","Search by filename, client name, or tag...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-nowrap","table-hover"],[1,"table-light"],[4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],[1,"ri-file-text-line","me-2","text-muted"],[1,"mb-1"],[1,"text-muted","mb-0","font-size-12"],["href","javascript:void(0)","title","View client details",1,"text-primary","fw-medium",3,"click"],["class","badge bg-light text-dark",4,"ngIf"],["class","text-muted font-size-12",4,"ngIf"],[1,"font-size-12"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","title"],[1,"ri-external-link-line","me-1"],["type","button",1,"btn","btn-sm","btn-outline-success",3,"click","title"],[1,"badge","bg-light","text-dark"],[1,"text-muted","font-size-12"],["colspan","8",1,"text-center","text-muted","py-4"],[1,"ri-file-search-line","font-size-48","d-block","mb-3"],["colspan","8",1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e.EFF(5,"Client Documents"),e.k0s(),e.j41(6,"div",5)(7,"button",6),e.bIt("click",function(){return n.exportDocuments()}),e.nrm(8,"i",7),e.EFF(9,"Export Documents "),e.k0s()()()()(),e.j41(10,"div",1)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"span",13),e.EFF(17,"Total Documents"),e.k0s(),e.j41(18,"h4",14),e.EFF(19),e.k0s()(),e.j41(20,"div",15)(21,"div",16)(22,"span",17),e.nrm(23,"i",18),e.k0s()()()()()()(),e.j41(24,"div",8)(25,"div",9)(26,"div",10)(27,"div",11)(28,"div",12)(29,"span",13),e.EFF(30,"Required Documents"),e.k0s(),e.j41(31,"h4",14),e.EFF(32),e.k0s()(),e.j41(33,"div",15)(34,"div",19)(35,"span",20),e.nrm(36,"i",21),e.k0s()()()()()()(),e.j41(37,"div",8)(38,"div",9)(39,"div",10)(40,"div",11)(41,"div",12)(42,"span",13),e.EFF(43,"Optional Documents"),e.k0s(),e.j41(44,"h4",14),e.EFF(45),e.k0s()(),e.j41(46,"div",15)(47,"div",22)(48,"span",23),e.nrm(49,"i",24),e.k0s()()()()()()(),e.j41(50,"div",8)(51,"div",9)(52,"div",10)(53,"div",11)(54,"div",12)(55,"span",13),e.EFF(56,"Unique Tags"),e.k0s(),e.j41(57,"h4",14),e.EFF(58),e.k0s()(),e.j41(59,"div",15)(60,"div",25)(61,"span",26),e.nrm(62,"i",27),e.k0s()()()()()()()(),e.nrm(63,"div",28),e.j41(64,"div",1)(65,"div",2)(66,"div",29)(67,"div",10)(68,"div",30)(69,"div",31)(70,"label",32),e.EFF(71,"Client"),e.k0s(),e.j41(72,"select",33),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedClient,l)||(n.selectedClient=l),l}),e.bIt("change",function(){return n.onClientChange()}),e.j41(73,"option",34),e.EFF(74,"All Clients"),e.k0s(),e.DNE(75,X,2,3,"option",35),e.k0s()(),e.j41(76,"div",31)(77,"label",36),e.EFF(78,"Project"),e.k0s(),e.j41(79,"select",37),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedProject,l)||(n.selectedProject=l),l}),e.bIt("change",function(){return n.onProjectChange()}),e.j41(80,"option",34),e.EFF(81,"All Projects"),e.k0s(),e.DNE(82,z,2,2,"option",35),e.k0s()(),e.j41(83,"div",31)(84,"label",38),e.EFF(85,"Tag"),e.k0s(),e.j41(86,"select",39),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedTag,l)||(n.selectedTag=l),l}),e.bIt("change",function(){return n.onTagChange()}),e.j41(87,"option",34),e.EFF(88,"All Tags"),e.k0s(),e.DNE(89,J,2,2,"option",35),e.k0s()(),e.j41(90,"div",31)(91,"label",40),e.EFF(92,"Priority"),e.k0s(),e.j41(93,"select",41),e.mxI("ngModelChange",function(l){return e.DH7(n.selectedRequired,l)||(n.selectedRequired=l),l}),e.bIt("change",function(){return n.onRequiredChange()}),e.j41(94,"option",34),e.EFF(95,"All Documents"),e.k0s(),e.j41(96,"option",42),e.EFF(97,"Required Only"),e.k0s(),e.j41(98,"option",43),e.EFF(99,"Optional Only"),e.k0s()()(),e.j41(100,"div",44)(101,"label",45),e.EFF(102,"Search Documents"),e.k0s(),e.j41(103,"input",46),e.mxI("ngModelChange",function(l){return e.DH7(n.searchTerm,l)||(n.searchTerm=l),l}),e.bIt("input",function(){return n.onSearchChange()}),e.k0s()()(),e.j41(104,"div",47)(105,"table",48)(106,"thead",49)(107,"tr")(108,"th"),e.EFF(109,"Document"),e.k0s(),e.j41(110,"th"),e.EFF(111,"Client"),e.k0s(),e.j41(112,"th"),e.EFF(113,"Project"),e.k0s(),e.j41(114,"th"),e.EFF(115,"Tag"),e.k0s(),e.j41(116,"th"),e.EFF(117,"Size"),e.k0s(),e.j41(118,"th"),e.EFF(119,"Required"),e.k0s(),e.j41(120,"th"),e.EFF(121,"Upload Date"),e.k0s(),e.j41(122,"th"),e.EFF(123,"Actions"),e.k0s()()(),e.j41(124,"tbody"),e.DNE(125,W,3,2,"ng-container",50)(126,Z,7,0,"tr",50),e.k0s()()()()()()()()),2&o&&(e.R7$(19),e.JRh(n.stats.total),e.R7$(13),e.JRh(n.stats.required),e.R7$(13),e.JRh(n.stats.optional),e.R7$(13),e.JRh(n.availableTags.length),e.R7$(14),e.R50("ngModel",n.selectedClient),e.R7$(3),e.Y8G("ngForOf",n.clients),e.R7$(4),e.R50("ngModel",n.selectedProject),e.R7$(3),e.Y8G("ngForOf",n.projects),e.R7$(4),e.R50("ngModel",n.selectedTag),e.R7$(3),e.Y8G("ngForOf",n.availableTags),e.R7$(4),e.R50("ngModel",n.selectedRequired),e.R7$(10),e.R50("ngModel",n.searchTerm),e.R7$(22),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isLoading))},dependencies:[m.Sq,m.bT,a.xH,a.y7,a.me,a.wz,a.BC,a.vS],styles:[".card-h-100[_ngcontent-%COMP%]{height:100%}.avatar-sm[_ngcontent-%COMP%]{height:2rem;width:2rem}.avatar-title[_ngcontent-%COMP%]{align-items:center;background-color:#556ee6;color:#fff;display:flex;font-weight:500;height:100%;justify-content:center;width:100%}.bg-primary-subtle[_ngcontent-%COMP%]{background-color:#556ee61a!important}.bg-success-subtle[_ngcontent-%COMP%]{background-color:#34c38f1a!important}.bg-warning-subtle[_ngcontent-%COMP%]{background-color:#fcb92c1a!important}.bg-danger-subtle[_ngcontent-%COMP%]{background-color:#f46a6a1a!important}.bg-info-subtle[_ngcontent-%COMP%]{background-color:#50a5f11a!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;border-top:none}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.badge[_ngcontent-%COMP%]{font-size:.75rem}.font-size-11[_ngcontent-%COMP%]{font-size:.6875rem}.font-size-12[_ngcontent-%COMP%]{font-size:.75rem}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:transform .2s ease-in-out;box-shadow:0 1rem 2rem #12263f1a}.card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}"]})}}return i})();function te(i,s){1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"div",12)(3,"div",13)(4,"div",14)(5,"span",15),e.EFF(6,"Loading..."),e.k0s()(),e.j41(7,"p",16),e.EFF(8,"Loading projects..."),e.k0s()()()()())}function ne(i,s){if(1&i&&(e.j41(0,"p",35),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.description)}}function oe(i,s){if(1&i){const t=e.RV6();e.j41(0,"li")(1,"a",36),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG().$implicit,l=e.XpG(3);return e.Njj(l.updateProjectStatus(r,n.value))}),e.EFF(2),e.k0s()()}if(2&i){const t=s.$implicit,o=e.XpG().$implicit;e.R7$(),e.AVh("active",o.status===t.value),e.R7$(),e.SpI(" ",t.label," ")}}function ie(i,s){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.taxYear)}}function re(i,s){1&i&&(e.j41(0,"span",37),e.EFF(1,"N/A"),e.k0s())}function se(i,s){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div")(3,"h5",24),e.EFF(4),e.k0s(),e.DNE(5,ne,2,1,"p",25),e.k0s()(),e.j41(6,"td")(7,"span",26),e.EFF(8),e.k0s()(),e.j41(9,"td")(10,"div",27)(11,"button",28),e.EFF(12),e.k0s(),e.j41(13,"ul",29),e.DNE(14,oe,3,3,"li",23),e.k0s()()(),e.j41(15,"td"),e.DNE(16,ie,2,1,"span",30)(17,re,2,0,"span",31),e.k0s(),e.j41(18,"td")(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td")(24,"div",32)(25,"button",33),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.viewProject(n))}),e.nrm(26,"i",34),e.k0s()()()()}if(2&i){const t=s.$implicit,o=e.XpG(3);e.R7$(4),e.JRh(t.name),e.R7$(),e.Y8G("ngIf",t.description),e.R7$(3),e.JRh(o.getTypeLabel(t.projectType)),e.R7$(3),e.ZvI("btn btn-sm ",o.getStatusClass(t.status)," dropdown-toggle"),e.R7$(),e.SpI(" ",o.getStatusLabel(t.status)," "),e.R7$(2),e.Y8G("ngForOf",o.projectStatuses),e.R7$(2),e.Y8G("ngIf",t.taxYear),e.R7$(),e.Y8G("ngIf",!t.taxYear),e.R7$(2),e.AVh("text-danger",o.isOverdue(t.dueDate)),e.R7$(),e.SpI(" ",o.formatDate(t.dueDate)," "),e.R7$(2),e.JRh(o.formatDate(t.createdAt))}}function ae(i,s){if(1&i&&(e.j41(0,"div",20)(1,"table",21)(2,"thead")(3,"tr")(4,"th",22),e.EFF(5,"Project Name"),e.k0s(),e.j41(6,"th",22),e.EFF(7,"Type"),e.k0s(),e.j41(8,"th",22),e.EFF(9,"Status"),e.k0s(),e.j41(10,"th",22),e.EFF(11,"Tax Year"),e.k0s(),e.j41(12,"th",22),e.EFF(13,"Due Date"),e.k0s(),e.j41(14,"th",22),e.EFF(15,"Created"),e.k0s(),e.j41(16,"th",22),e.EFF(17,"Actions"),e.k0s()()(),e.j41(18,"tbody"),e.DNE(19,se,27,14,"tr",23),e.k0s()()()),2&i){const t=e.XpG(2);e.R7$(19),e.Y8G("ngForOf",t.projects)}}function le(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",38)(1,"div",39),e.nrm(2,"i",40),e.k0s(),e.j41(3,"h5"),e.EFF(4,"No Projects Found"),e.k0s(),e.j41(5,"p",37),e.EFF(6,"This client doesn't have any projects yet. Create one to get started."),e.k0s(),e.j41(7,"button",7),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.openCreateModal())}),e.nrm(8,"i",8),e.EFF(9," Create First Project "),e.k0s()()}}function ce(i,s){if(1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"div",12)(3,"div",17),e.DNE(4,ae,20,1,"div",18)(5,le,10,0,"div",19),e.k0s()()()()),2&i){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.projects.length>0),e.R7$(),e.Y8G("ngIf",0===t.projects.length)}}function de(i,s){if(1&i&&(e.j41(0,"option",65),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function me(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",41)(1,"div",42)(2,"div",43)(3,"div",44)(4,"h5",45),e.EFF(5,"Create New Project"),e.k0s(),e.j41(6,"button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeCreateModal())}),e.k0s()(),e.j41(7,"div",47)(8,"form")(9,"div",1)(10,"div",48)(11,"div",49)(12,"label",50),e.EFF(13,"Project Name *"),e.k0s(),e.j41(14,"input",51),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.newProject.name,n)||(r.newProject.name=n),e.Njj(n)}),e.k0s()()(),e.j41(15,"div",52)(16,"div",49)(17,"label",53),e.EFF(18,"Project Type *"),e.k0s(),e.j41(19,"select",54),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.newProject.projectType,n)||(r.newProject.projectType=n),e.Njj(n)}),e.DNE(20,de,2,2,"option",55),e.k0s()()()(),e.j41(21,"div",1)(22,"div",56)(23,"div",49)(24,"label",57),e.EFF(25,"Tax Year"),e.k0s(),e.j41(26,"input",58),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.newProject.taxYear,n)||(r.newProject.taxYear=n),e.Njj(n)}),e.k0s()()(),e.j41(27,"div",56)(28,"div",49)(29,"label",59),e.EFF(30,"Due Date"),e.k0s(),e.j41(31,"input",60),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.newProject.dueDate,n)||(r.newProject.dueDate=n),e.Njj(n)}),e.k0s()()()(),e.j41(32,"div",49)(33,"label",61),e.EFF(34,"Description"),e.k0s(),e.j41(35,"textarea",62),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.newProject.description,n)||(r.newProject.description=n),e.Njj(n)}),e.k0s()()()(),e.j41(36,"div",63)(37,"button",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeCreateModal())}),e.EFF(38,"Cancel"),e.k0s(),e.j41(39,"button",7),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createProject())}),e.EFF(40,"Create Project"),e.k0s()()()()()}if(2&i){const t=e.XpG();e.xc7("display",t.showCreateModal?"block":"none"),e.AVh("show",t.showCreateModal),e.R7$(14),e.R50("ngModel",t.newProject.name),e.R7$(5),e.R50("ngModel",t.newProject.projectType),e.R7$(),e.Y8G("ngForOf",t.projectTypes),e.R7$(6),e.R50("ngModel",t.newProject.taxYear),e.Y8G("min",2020)("max",2030),e.R7$(5),e.R50("ngModel",t.newProject.dueDate),e.R7$(4),e.R50("ngModel",t.newProject.description)}}function pe(i,s){1&i&&e.nrm(0,"div",66)}let ue=(()=>{class i{constructor(t,o,n){this.route=t,this.router=o,this.apiService=n,this.destroy$=new _.B,this.clientName="",this.projects=[],this.isLoading=!1,this.showCreateModal=!1,this.newProject={name:"",projectType:"Tax Return",taxYear:(new Date).getFullYear(),dueDate:"",description:""},this.projectTypes=[{value:"Tax Return",label:"Tax Return"},{value:"Quarterly Filing",label:"Quarterly Filing"},{value:"Business Setup",label:"Business Setup"},{value:"Audit",label:"Audit"},{value:"Consultation",label:"Consultation"},{value:"Other",label:"Other"}],this.projectTypeMap={"Tax Return":"tax_return","Quarterly Filing":"quarterly_filing","Business Setup":"business_setup",Audit:"audit",Consultation:"consultation",Other:"other"},this.projectStatuses=[{value:"active",label:"Active",class:"badge bg-success"},{value:"in_progress",label:"In Progress",class:"badge bg-primary"},{value:"completed",label:"Completed",class:"badge bg-info"},{value:"on_hold",label:"On Hold",class:"badge bg-warning"},{value:"cancelled",label:"Cancelled",class:"badge bg-danger"}]}ngOnInit(){this.route.params.subscribe(t=>{this.clientId=+t.clientId,this.clientId&&(this.loadClientProjects(),this.loadClientInfo())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadClientProjects(){this.isLoading=!0,this.apiService.getClientProjects(this.clientId).pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{t.success&&t.projects&&(this.projects=t.projects),this.isLoading=!1},error:t=>{console.error("Error loading client projects:",t),this.isLoading=!1,c().fire({title:"Error",text:"Failed to load client projects.",icon:"error"})}})}loadClientInfo(){this.apiService.getClients().pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{if(t.success&&t.clients){const o=t.clients.find(n=>n.id===this.clientId);o&&(this.clientName=`${o.firstName} ${o.lastName}`)}},error:t=>{console.error("Error loading client info:",t)}})}openCreateModal(){this.newProject={name:"",projectType:"tax_return",taxYear:(new Date).getFullYear(),dueDate:"",description:""},this.showCreateModal=!0}closeCreateModal(){this.showCreateModal=!1}createProject(){if(!this.newProject.name.trim())return void c().fire({title:"Validation Error",text:"Project name is required.",icon:"warning"});if(!this.newProject.projectType)return void c().fire({title:"Validation Error",text:"Project type is required.",icon:"warning"});const t=this.projectTypeMap[this.newProject.projectType]||this.newProject.projectType,o={name:this.newProject.name.trim(),projectType:t};this.newProject.taxYear&&this.newProject.taxYear>0&&(o.taxYear=this.newProject.taxYear),this.newProject.dueDate&&this.newProject.dueDate.trim()&&(o.dueDate=this.newProject.dueDate.trim()),this.newProject.description&&this.newProject.description.trim()&&(o.description=this.newProject.description.trim()),console.log("=== PROJECT CREATION DEBUG v112 - FIXED MAPPING ==="),console.log("Raw form data:",this.newProject),console.log("Original projectType:",this.newProject.projectType),console.log("Mapped projectType:",t),console.log("Cleaned project data being sent:",o),console.log("Client ID:",this.clientId),console.log("Project data JSON:",JSON.stringify(o,null,2)),console.log("Current timestamp:",(new Date).toISOString()),console.log("==============================="),alert("Project creation starting v112 - FIXED DROPDOWN MAPPING - should now send projectType correctly"),this.apiService.createProject(this.clientId,o).pipe((0,u.Q)(this.destroy$)).subscribe({next:n=>{console.log("Project creation response:",n),n.success?(c().fire({title:"Success!",text:"Project created successfully.",icon:"success",timer:2e3,showConfirmButton:!1}),this.closeCreateModal(),this.loadClientProjects()):(console.error("Project creation failed:",n.message),c().fire({title:"Error",text:n.message||"Failed to create project.",icon:"error"}))},error:n=>{console.error("Error creating project:",n),console.error("Full error object:",JSON.stringify(n,null,2));let r="Failed to create project.";n.error&&n.error.message?r=n.error.message:n.error&&"string"==typeof n.error?r=n.error:n.message?r=n.message:n.status&&(r=`Server error (${n.status}): ${n.statusText||"Unknown error"}`),c().fire({title:"Error",text:r,icon:"error"})}})}getStatusClass(t){const o=this.projectStatuses.find(n=>n.value===t);return o?o.class:"badge bg-secondary"}getStatusLabel(t){const o=this.projectStatuses.find(n=>n.value===t);return o?o.label:t}getTypeLabel(t){const o=this.projectTypes.find(n=>n.value===t);return o?o.label:t}updateProjectStatus(t,o){this.apiService.updateProject(t.id,{name:t.name,projectType:t.projectType}).pipe((0,u.Q)(this.destroy$)).subscribe({next:n=>{n.success&&(t.status=o,c().fire({title:"Updated!",text:"Project status updated successfully.",icon:"success",timer:1500,showConfirmButton:!1}))},error:n=>{console.error("Error updating project status:",n),c().fire({title:"Error",text:"Failed to update project status.",icon:"error"})}})}viewProject(t){this.router.navigate(["/tax-consultant/project-detail",t.id])}isOverdue(t){return!!t&&new Date(t)<new Date}formatDate(t){return t?new Date(t).toLocaleDateString():"Not set"}goBack(){this.router.navigate(["/clients/list"])}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(g.nX),e.rXU(g.Ix),e.rXU(f.G))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-client-projects"]],decls:15,vars:5,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],["title","Go Back to Clients List",1,"bx","bx-arrow-back","me-2","cursor-pointer",3,"click"],[1,"page-title-right"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bx","bx-plus","me-1"],["class","row",4,"ngIf"],["class","modal fade","tabindex","-1",3,"show","display",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[1,"card"],[1,"card-body","text-center"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-2"],[1,"card-body"],["class","table-responsive",4,"ngIf"],["class","text-center py-5",4,"ngIf"],[1,"table-responsive"],[1,"table","table-nowrap","align-middle","mb-0"],["scope","col"],[4,"ngFor","ngForOf"],[1,"font-size-14","mb-1"],["class","text-muted mb-0",4,"ngIf"],[1,"badge","bg-light","text-dark"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown"],[1,"dropdown-menu"],[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"d-flex","gap-2"],["type","button","title","View Project Details",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bx","bx-show"],[1,"text-muted","mb-0"],[1,"dropdown-item",3,"click"],[1,"text-muted"],[1,"text-center","py-5"],[1,"mb-4"],[1,"bx","bx-folder-open","display-4","text-muted"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-8"],[1,"mb-3"],["for","projectName",1,"form-label"],["type","text","id","projectName","name","projectName","placeholder","Enter project name",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4"],["for","projectType",1,"form-label"],["id","projectType","name","projectType",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6"],["for","taxYear",1,"form-label"],["type","number","id","taxYear","name","taxYear",1,"form-control",3,"ngModelChange","ngModel","min","max"],["for","dueDate",1,"form-label"],["type","date","id","dueDate","name","dueDate",1,"form-control",3,"ngModelChange","ngModel"],["for","description",1,"form-label"],["id","description","rows","3","name","description","placeholder","Enter project description (optional)",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"modal-backdrop","fade","show"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4)(5,"i",5),e.bIt("click",function(){return n.goBack()}),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"div",6)(8,"button",7),e.bIt("click",function(){return n.openCreateModal()}),e.nrm(9,"i",8),e.EFF(10," New Project "),e.k0s()()()()(),e.DNE(11,te,9,0,"div",9)(12,ce,6,2,"div",9),e.k0s(),e.DNE(13,me,41,12,"div",10)(14,pe,1,0,"div",11)),2&o&&(e.R7$(6),e.SpI(" ",n.clientName," - Projects "),e.R7$(5),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.showCreateModal),e.R7$(),e.Y8G("ngIf",n.showCreateModal))},dependencies:[m.Sq,m.bT,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.VZ,a.zX,a.vS,a.cV],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;font-weight:600;color:#495057;background-color:#f8f9fa}.badge[_ngcontent-%COMP%]{font-size:.75rem}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}.modal[_ngcontent-%COMP%]{background-color:#00000080}.modal-content[_ngcontent-%COMP%]{border-radius:.5rem;box-shadow:0 .5rem 1rem #00000026}.modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:1rem 1.5rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding:1rem 1.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.dropdown-toggle[_ngcontent-%COMP%]:after{margin-left:.5rem}.empty-state[_ngcontent-%COMP%]{padding:3rem 0}.display-4[_ngcontent-%COMP%]{font-size:3.5rem}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}"]})}}return i})();var h=p(779);const ge=["statusUpdateModal"];function fe(i,s){1&i&&(e.j41(0,"div",42)(1,"div",43)(2,"span",44),e.EFF(3,"Loading..."),e.k0s()()())}function be(i,s){if(1&i&&(e.j41(0,"div",27)(1,"label",53),e.EFF(2,"Description"),e.k0s(),e.j41(3,"p",54),e.EFF(4),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.JRh(t.project.description)}}function _e(i,s){if(1&i&&(e.j41(0,"tr")(1,"td",72),e.EFF(2),e.nI1(3,"titlecase"),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s()()),2&i){const t=s.$implicit;e.R7$(2),e.JRh(e.bMT(3,2,t.key)),e.R7$(3),e.JRh(t.value)}}function he(i,s){if(1&i&&(e.j41(0,"div",46)(1,"div",47)(2,"h5",58),e.EFF(3,"Intake Form Information"),e.k0s(),e.j41(4,"div",69)(5,"table",70)(6,"tbody"),e.DNE(7,_e,6,4,"tr",71),e.nI1(8,"keyvalue"),e.k0s()()()()()),2&i){const t=e.XpG(2);e.R7$(7),e.Y8G("ngForOf",e.bMT(8,1,t.intakeFormData))}}function je(i,s){1&i&&e.nrm(0,"span",73)}function Fe(i,s){1&i&&e.nrm(0,"i",74)}function ve(i,s){1&i&&(e.j41(0,"div",75),e.nrm(1,"i",76),e.EFF(2," No documents uploaded yet "),e.k0s())}function ke(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",77)(1,"div",78)(2,"div",79)(3,"h6",80),e.EFF(4),e.k0s(),e.j41(5,"small",26),e.EFF(6),e.k0s()(),e.j41(7,"button",81),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.downloadDocument(n))}),e.nrm(8,"i",82),e.k0s()()()}if(2&i){const t=s.$implicit,o=e.XpG(2);e.R7$(4),e.JRh(t.originalName),e.R7$(2),e.Lme(" ",o.formatFileSize(t.fileSize)," \u2022 ",o.formatDate(t.uploadedAt)," ")}}function Ce(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",2)(1,"div",45)(2,"div",46)(3,"div",47)(4,"div",48)(5,"div",24)(6,"h5",49),e.EFF(7),e.k0s(),e.j41(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"button",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.openStatusUpdateModal())}),e.nrm(11,"i",51),e.EFF(12,"Update Status "),e.k0s()(),e.j41(13,"div",2)(14,"div",52)(15,"div",27)(16,"label",53),e.EFF(17,"Project Type"),e.k0s(),e.j41(18,"p",54),e.EFF(19),e.nI1(20,"titlecase"),e.k0s()()(),e.j41(21,"div",52)(22,"div",27)(23,"label",53),e.EFF(24,"Tax Year"),e.k0s(),e.j41(25,"p",54),e.EFF(26),e.k0s()()(),e.j41(27,"div",52)(28,"div",27)(29,"label",53),e.EFF(30,"Due Date"),e.k0s(),e.j41(31,"p",54),e.EFF(32),e.k0s()()(),e.j41(33,"div",52)(34,"div",27)(35,"label",53),e.EFF(36,"Created"),e.k0s(),e.j41(37,"p",54),e.EFF(38),e.k0s()()()(),e.DNE(39,be,5,1,"div",55),e.k0s()(),e.DNE(40,he,9,3,"div",56),e.k0s(),e.j41(41,"div",57)(42,"div",46)(43,"div",47)(44,"h5",58),e.EFF(45,"Upload Prepared Document"),e.k0s(),e.j41(46,"div",27)(47,"label",59),e.EFF(48,"Select File"),e.k0s(),e.j41(49,"input",60),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onFileSelected(n))}),e.k0s(),e.j41(50,"div",61),e.EFF(51,"Accepted formats: PDF, DOC, DOCX (Max 10MB)"),e.k0s()(),e.j41(52,"div",27)(53,"label",62),e.EFF(54,"Description (Optional)"),e.k0s(),e.j41(55,"textarea",63),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.uploadDescription,n)||(r.uploadDescription=n),e.Njj(n)}),e.k0s()(),e.j41(56,"button",64),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.uploadDocument())}),e.DNE(57,je,1,0,"span",65)(58,Fe,1,0,"i",66),e.EFF(59),e.k0s()()(),e.j41(60,"div",46)(61,"div",47)(62,"h5",58),e.EFF(63,"Prepared Documents"),e.k0s(),e.DNE(64,ve,3,0,"div",67)(65,ke,9,3,"div",68),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(7),e.JRh(t.project.name),e.R7$(),e.HbH(t.getStatusClass(t.project.status)),e.R7$(),e.JRh(t.getStatusLabel(t.project.status)),e.R7$(10),e.JRh(e.bMT(20,17,t.project.projectType)),e.R7$(7),e.JRh(t.project.taxYear||"Not specified"),e.R7$(6),e.JRh(t.formatDate(t.project.dueDate||"")),e.R7$(6),e.JRh(t.formatDate(t.project.createdAt)),e.R7$(),e.Y8G("ngIf",t.project.description),e.R7$(),e.Y8G("ngIf",t.intakeFormData),e.R7$(15),e.R50("ngModel",t.uploadDescription),e.R7$(),e.Y8G("disabled",!t.selectedFile||t.isUploading),e.R7$(),e.Y8G("ngIf",t.isUploading),e.R7$(),e.Y8G("ngIf",!t.isUploading),e.R7$(),e.SpI(" ",t.isUploading?"Uploading...":"Upload Document"," "),e.R7$(5),e.Y8G("ngIf",!t.project.preparedDocuments||0===t.project.preparedDocuments.length),e.R7$(),e.Y8G("ngForOf",t.project.preparedDocuments)}}function xe(i,s){1&i&&(e.j41(0,"div",42)(1,"div",26),e.nrm(2,"i",83),e.EFF(3," Project not found or failed to load "),e.k0s()())}function Pe(i,s){1&i&&(e.nrm(0,"span",84),e.EFF(1," Updating... "))}function ye(i,s){1&i&&(e.nrm(0,"i",85),e.EFF(1,"Update Status "))}let F=(()=>{class i{constructor(t,o,n,r){this.route=t,this.formBuilder=o,this.router=n,this.apiService=r,this.destroy$=new _.B,this.project=null,this.intakeFormData=null,this.isLoading=!1,this.isUploading=!1,this.selectedFile=null,this.uploadDescription="",this.statusUpdateLoading=!1,this.statusUpdateForm=this.formBuilder.group({status:["",[a.k0.required]],notes:[""]})}ngOnInit(){this.route.params.subscribe(t=>{this.projectId=+t.projectId,this.projectId&&this.loadProjectDetail()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadProjectDetail(){this.isLoading=!0,this.apiService.getProjectDetail(this.projectId).pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{t.success&&(this.project=t.project||null,this.intakeFormData=this.project?.intakeFormData||null),this.isLoading=!1},error:t=>{console.error("Error loading project detail:",t),this.isLoading=!1,c().fire({title:"Error",text:"Failed to load project details.",icon:"error"})}})}onFileSelected(t){const o=t.target.files[0];if(o){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(o.type))return void c().fire({title:"Invalid File Type",text:"Please select a PDF, DOC, or DOCX file.",icon:"warning"});if(o.size>10485760)return void c().fire({title:"File Too Large",text:"Please select a file smaller than 10MB.",icon:"warning"});this.selectedFile=o}}uploadDocument(){this.selectedFile?(this.isUploading=!0,this.apiService.uploadProjectDocument(this.projectId,this.selectedFile,this.uploadDescription).pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{if(t.success){c().fire({title:"Success!",text:"Document uploaded successfully.",icon:"success",timer:2e3,showConfirmButton:!1}),this.selectedFile=null,this.uploadDescription="";const o=document.getElementById("documentFile");o&&(o.value=""),this.loadProjectDetail()}this.isUploading=!1},error:t=>{console.error("Error uploading document:",t),this.isUploading=!1,c().fire({title:"Upload Failed",text:"Failed to upload document. Please try again.",icon:"error"})}})):c().fire({title:"No File Selected",text:"Please select a file to upload.",icon:"warning"})}downloadDocument(t){this.apiService.downloadProjectDocument(t.id).pipe((0,u.Q)(this.destroy$)).subscribe({next:o=>{const n=window.URL.createObjectURL(o),r=window.document.createElement("a");r.href=n,r.download=t.originalName,r.click(),window.URL.revokeObjectURL(n)},error:o=>{console.error("Error downloading document:",o),c().fire({title:"Download Failed",text:"Failed to download document.",icon:"error"})}})}getStatusClass(t){return{active:"badge bg-success",in_progress:"badge bg-primary",completed:"badge bg-info",on_hold:"badge bg-warning",cancelled:"badge bg-danger"}[t]||"badge bg-secondary"}getStatusLabel(t){return{active:"Active",in_progress:"In Progress",completed:"Completed",on_hold:"On Hold",cancelled:"Cancelled"}[t]||t}formatFileSize(t){if(0===t)return"0 Bytes";const r=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]}openStatusUpdateModal(){this.statusUpdateForm.patchValue({status:"",notes:""}),this.statusUpdateModal?.show()}updateProjectStatus(){if(!this.statusUpdateForm.valid||!this.project?.id)return;this.statusUpdateLoading=!0;const t=this.statusUpdateForm.value,o={status:t.status};t.notes?.trim()&&(o.notes=t.notes.trim()),this.apiService.updateProject(this.project.id,o).subscribe({next:n=>{n.success&&(this.project&&(this.project.status=t.status),c().fire({title:"Success!",text:"Project status updated successfully",icon:"success",confirmButtonText:"OK"}),this.statusUpdateModal?.hide(),this.statusUpdateForm.reset()),this.statusUpdateLoading=!1},error:n=>{console.error("Error updating project status:",n),c().fire({title:"Error!",text:"Failed to update project status. Please try again.",icon:"error",confirmButtonText:"OK"}),this.statusUpdateLoading=!1}})}formatDate(t){return t?new Date(t).toLocaleDateString():"Not set"}goBack(){this.router.navigate(this.project?["/tax-consultant/client-projects",this.project.clientId]:["/clients/list"])}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(g.nX),e.rXU(a.ok),e.rXU(g.Ix),e.rXU(f.G))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-project-detail"]],viewQuery:function(o,n){if(1&o&&e.GBs(ge,5),2&o){let r;e.mGM(r=e.lsd())&&(n.statusUpdateModal=r.first)}},standalone:!0,features:[e.aNF],decls:69,vars:10,consts:[["statusUpdateModal","bs-modal"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-flex","align-items-center","justify-content-between"],[1,"mb-0","font-size-18"],[1,"page-title-right"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"ri-arrow-left-line","me-1"],["class","text-center py-5",4,"ngIf"],["class","row",4,"ngIf"],["bsModal","","id","statusUpdateModal","tabindex","-1","aria-labelledby","statusUpdateModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","statusUpdateModalLabel",1,"modal-title"],[1,"bx","bx-edit","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["autocomplete","off","novalidate","",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"row","mb-4"],[1,"card","bg-light"],[1,"card-body","p-3"],[1,"card-title","mb-2"],[1,"d-flex","align-items-center"],[1,"me-2"],[1,"text-muted"],[1,"mb-3"],["for","newStatus",1,"form-label"],[1,"text-danger"],["id","newStatus","formControlName","status","required","",1,"form-select"],["value",""],["value","active"],["value","in_progress"],["value","completed"],["value","on_hold"],["value","cancelled"],["for","statusNotes",1,"form-label"],["id","statusNotes","rows","3","formControlName","notes","placeholder","Add any notes about this status change...",1,"form-control"],[1,"text-end"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"col-xl-8","col-12"],[1,"card"],[1,"card-body"],[1,"d-flex","align-items-center","justify-content-between","mb-4"],[1,"card-title","mb-0","me-3"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bx","bx-edit","me-1"],[1,"col-md-6"],[1,"form-label","text-muted"],[1,"mb-0"],["class","mb-3",4,"ngIf"],["class","card",4,"ngIf"],[1,"col-xl-4","col-12"],[1,"card-title"],["for","documentFile",1,"form-label"],["type","file","id","documentFile","accept",".pdf,.doc,.docx",1,"form-control",3,"change"],[1,"form-text"],["for","uploadDescription",1,"form-label"],["id","uploadDescription","rows","3","placeholder","Brief description of the document...",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","w-100",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],["class","ri-upload-2-line me-1",4,"ngIf"],["class","text-center text-muted py-4",4,"ngIf"],["class","border rounded p-3 mb-3",4,"ngFor","ngForOf"],[1,"table-responsive"],[1,"table","table-borderless"],[4,"ngFor","ngForOf"],[1,"text-muted",2,"width","30%"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"ri-upload-2-line","me-1"],[1,"text-center","text-muted","py-4"],[1,"ri-file-text-line","font-size-24","mb-2","d-block"],[1,"border","rounded","p-3","mb-3"],[1,"d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1"],[1,"mb-1"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"ri-download-line"],[1,"ri-error-warning-line","font-size-24","mb-2","d-block"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"bx","bx-check","me-1"]],template:function(o,n){if(1&o){const r=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),e.EFF(5,"Project Details"),e.k0s(),e.j41(6,"div",6)(7,"button",7),e.bIt("click",function(){return e.eBV(r),e.Njj(n.goBack())}),e.nrm(8,"i",8),e.EFF(9," Back "),e.k0s()()()()(),e.DNE(10,fe,4,0,"div",9)(11,Ce,66,19,"div",10)(12,xe,4,0,"div",9),e.k0s(),e.j41(13,"div",11,0)(15,"div",12)(16,"div",13)(17,"div",14)(18,"h5",15),e.nrm(19,"i",16),e.EFF(20,"Update Project Status "),e.k0s(),e.j41(21,"button",17),e.bIt("click",function(){e.eBV(r);const d=e.sdS(14);return e.Njj(d.hide())}),e.k0s()(),e.j41(22,"div",18)(23,"form",19),e.bIt("ngSubmit",function(){return e.eBV(r),e.Njj(n.updateProjectStatus())}),e.j41(24,"div",20)(25,"div",3)(26,"div",21)(27,"div",22)(28,"h6",23),e.EFF(29,"Current Project Status"),e.k0s(),e.j41(30,"div",24)(31,"span",25),e.EFF(32),e.k0s(),e.j41(33,"small",26),e.EFF(34,"\u2192 Change to:"),e.k0s()()()()()(),e.j41(35,"div",2)(36,"div",3)(37,"div",27)(38,"label",28),e.EFF(39,"New Status "),e.j41(40,"span",29),e.EFF(41,"*"),e.k0s()(),e.j41(42,"select",30)(43,"option",31),e.EFF(44,"Select Status"),e.k0s(),e.j41(45,"option",32),e.EFF(46,"Active"),e.k0s(),e.j41(47,"option",33),e.EFF(48,"In Progress"),e.k0s(),e.j41(49,"option",34),e.EFF(50,"Completed"),e.k0s(),e.j41(51,"option",35),e.EFF(52,"On Hold"),e.k0s(),e.j41(53,"option",36),e.EFF(54,"Cancelled"),e.k0s()()()()(),e.j41(55,"div",2)(56,"div",3)(57,"div",27)(58,"label",37),e.EFF(59,"Notes (Optional)"),e.k0s(),e.nrm(60,"textarea",38),e.k0s()()(),e.j41(61,"div",2)(62,"div",3)(63,"div",39)(64,"button",40),e.bIt("click",function(){e.eBV(r);const d=e.sdS(14);return e.Njj(d.hide())}),e.EFF(65,"Cancel"),e.k0s(),e.j41(66,"button",41),e.DNE(67,Pe,2,0)(68,ye,2,0),e.k0s()()()()()()()()()}2&o&&(e.R7$(10),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&n.project),e.R7$(),e.Y8G("ngIf",!n.isLoading&&!n.project),e.R7$(11),e.Y8G("formGroup",n.statusUpdateForm),e.R7$(8),e.HbH(n.getStatusClass(null==n.project?null:n.project.status)),e.R7$(),e.JRh(n.getStatusLabel(null==n.project?null:n.project.status)),e.R7$(32),e.Y8G("disabled",n.statusUpdateLoading),e.R7$(2),e.Y8G("disabled",n.statusUpdateLoading||!n.statusUpdateForm.valid),e.R7$(),e.vxM(67,n.statusUpdateLoading?67:68))},dependencies:[m.MD,m.Sq,m.bT,m.PV,m.lG,a.YN,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,a.YS,a.vS,a.X1,a.j4,a.JD,h.Q_,h.hZ],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid rgba(0,0,0,.125)}.card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#6c757d}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.375rem .75rem}.bg-success[_ngcontent-%COMP%]{background-color:#28a745!important}.bg-primary[_ngcontent-%COMP%]{background-color:#007bff!important}.bg-info[_ngcontent-%COMP%]{background-color:#17a2b8!important}.bg-warning[_ngcontent-%COMP%]{background-color:#ffc107!important;color:#212529!important}.bg-danger[_ngcontent-%COMP%]{background-color:#dc3545!important}.bg-secondary[_ngcontent-%COMP%]{background-color:#6c757d!important}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.document-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.document-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.file-upload-area[_ngcontent-%COMP%]{border:2px dashed #dee2e6;border-radius:.375rem;padding:2rem;text-align:center;transition:border-color .15s ease-in-out}.file-upload-area[_ngcontent-%COMP%]:hover{border-color:#007bff}.file-upload-area.dragover[_ngcontent-%COMP%]{border-color:#007bff;background-color:#f8f9fa}.table-borderless[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:.5rem 0}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (max-width: 768px){.card[_ngcontent-%COMP%]{margin-bottom:1rem}.btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}}"]})}}return i})();const we=["editClientModal"];function Ee(i,s){if(1&i&&(e.j41(0,"option",81),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function Ie(i,s){if(1&i&&(e.j41(0,"option",81),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function Re(i,s){if(1&i&&(e.j41(0,"p",95),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.description," ")}}function Te(i,s){1&i&&e.nrm(0,"i",96)}function De(i,s){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",85)(3,"div")(4,"h6",86)(5,"a",87),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewProject(n))}),e.EFF(6),e.k0s()(),e.DNE(7,Re,2,1,"p",88),e.k0s()()(),e.j41(8,"td")(9,"a",89),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewClientDetail(n))}),e.EFF(10),e.k0s()(),e.j41(11,"td")(12,"span",90),e.EFF(13),e.k0s()(),e.j41(14,"td")(15,"span"),e.EFF(16),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.k0s(),e.j41(19,"td")(20,"span"),e.EFF(21),e.DNE(22,Te,1,0,"i",91),e.k0s()(),e.j41(23,"td"),e.EFF(24),e.k0s(),e.j41(25,"td")(26,"div",92)(27,"button",93),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewProject(n))}),e.nrm(28,"i",94),e.k0s()()()()}if(2&i){const t=s.$implicit,o=e.XpG(2);e.R7$(6),e.SpI(" ",t.name," "),e.R7$(),e.Y8G("ngIf",t.description),e.R7$(3),e.SpI(" ",t.clientName||"#"+t.clientId," "),e.R7$(3),e.JRh(o.getTypeLabel(t.projectType)),e.R7$(2),e.HbH(o.getStatusClass(t.status)),e.R7$(),e.JRh(o.getStatusLabel(t.status)),e.R7$(2),e.JRh(t.taxYear||"N/A"),e.R7$(2),e.HbH(o.isOverdue(t.dueDate||"")?"text-danger fw-bold":""),e.R7$(),e.SpI(" ",o.formatDate(t.dueDate||"")," "),e.R7$(),e.Y8G("ngIf",o.isOverdue(t.dueDate||"")),e.R7$(2),e.JRh(o.formatDate(t.createdAt))}}function Me(i,s){if(1&i&&(e.j41(0,"table",82)(1,"thead",83)(2,"tr")(3,"th"),e.EFF(4,"Project Name"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Client"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Type"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Status"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Tax Year"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Due Date"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Created"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Actions"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,De,29,13,"tr",84),e.k0s()()),2&i){const t=e.XpG();e.R7$(20),e.Y8G("ngForOf",t.filteredProjects)}}function Se(i,s){1&i&&(e.j41(0,"div",97)(1,"div",98)(2,"span",99),e.EFF(3,"Loading..."),e.k0s()(),e.j41(4,"p",100),e.EFF(5,"Loading projects..."),e.k0s()())}function Oe(i,s){1&i&&(e.j41(0,"p",104),e.EFF(1," Try adjusting your filters to see more results. "),e.k0s())}function Ne(i,s){1&i&&(e.j41(0,"p",104),e.EFF(1," No projects have been created yet. "),e.k0s())}function $e(i,s){if(1&i&&(e.j41(0,"div",97)(1,"div",101),e.nrm(2,"i",102),e.k0s(),e.j41(3,"h5"),e.EFF(4,"No Projects Found"),e.k0s(),e.DNE(5,Oe,2,0,"p",103)(6,Ne,2,0,"p",103),e.k0s()),2&i){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",t.searchTerm||t.selectedStatus||t.selectedProjectType),e.R7$(),e.Y8G("ngIf",!t.searchTerm&&!t.selectedStatus&&!t.selectedProjectType)}}function Ge(i,s){1&i&&(e.j41(0,"div"),e.EFF(1,"First name is required"),e.k0s())}function Le(i,s){if(1&i&&(e.j41(0,"div",105),e.DNE(1,Ge,2,0,"div",106),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.ef.firstName.errors?null:t.ef.firstName.errors.required)}}function Be(i,s){1&i&&(e.j41(0,"div"),e.EFF(1,"Last name is required"),e.k0s())}function Ae(i,s){if(1&i&&(e.j41(0,"div",105),e.DNE(1,Be,2,0,"div",106),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.ef.lastName.errors?null:t.ef.lastName.errors.required)}}function Ye(i,s){1&i&&(e.j41(0,"div"),e.EFF(1,"Please enter a valid email address"),e.k0s())}function Ve(i,s){if(1&i&&(e.j41(0,"div",105),e.DNE(1,Ye,2,0,"div",106),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.ef.email.errors?null:t.ef.email.errors.email)}}function Ue(i,s){1&i&&e.nrm(0,"span",107)}let v=(()=>{class i{constructor(t,o,n){this.router=t,this.apiService=o,this.formBuilder=n,this.destroy$=new _.B,this.projects=[],this.filteredProjects=[],this.isLoading=!1,this.searchTerm="",this.selectedStatus="",this.selectedProjectType="",this.editSubmitted=!1,this.editLoading=!1,this.selectedClient=null,this.projectTypes=[{value:"tax_return",label:"Tax Return"},{value:"quarterly_filing",label:"Quarterly Filing"},{value:"business_setup",label:"Business Setup"},{value:"audit",label:"Audit"},{value:"consultation",label:"Consultation"},{value:"other",label:"Other"}],this.projectStatuses=[{value:"active",label:"Active",class:"badge bg-success"},{value:"in_progress",label:"In Progress",class:"badge bg-primary"},{value:"completed",label:"Completed",class:"badge bg-info"},{value:"on_hold",label:"On Hold",class:"badge bg-warning"},{value:"cancelled",label:"Cancelled",class:"badge bg-danger"}]}ngOnInit(){this.initializeEditForm(),this.loadAllProjects()}initializeEditForm(){this.editClientForm=this.formBuilder.group({firstName:["",[a.k0.required]],lastName:["",[a.k0.required]],email:["",[a.k0.email]],phoneNumber:[""],entityType:[""],status:[""]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAllProjects(){this.isLoading=!0,this.apiService.getAccountantProjects().pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{t.success&&t.projects&&(this.projects=t.projects,this.filteredProjects=[...this.projects]),this.isLoading=!1},error:t=>{console.error("Error loading projects:",t),this.isLoading=!1,c().fire({title:"Error",text:"Failed to load projects.",icon:"error"})}})}applyFilters(){this.filteredProjects=this.projects.filter(t=>(!this.searchTerm||t.name.toLowerCase().includes(this.searchTerm.toLowerCase())||t.description?.toLowerCase().includes(this.searchTerm.toLowerCase()))&&(!this.selectedStatus||t.status===this.selectedStatus)&&(!this.selectedProjectType||t.projectType===this.selectedProjectType))}onSearchChange(){this.applyFilters()}onStatusChange(){this.applyFilters()}onTypeChange(){this.applyFilters()}clearFilters(){this.searchTerm="",this.selectedStatus="",this.selectedProjectType="",this.filteredProjects=[...this.projects]}viewProject(t){this.router.navigate(["/tax-consultant/project-detail",t.id])}viewClientDetail(t){t.clientId&&this.router.navigate(["/clients/detail",t.clientId])}viewClient(t){this.router.navigate(["/clients/detail",t.clientId])}openEditClientModal(t){t.clientId&&this.apiService.getClients().pipe((0,u.Q)(this.destroy$)).subscribe({next:o=>{if(o.success&&o.clients){const n=o.clients.find(r=>r.id===t.clientId);n?(this.selectedClient=n,this.populateEditForm(n),this.editClientModal?.show()):c().fire({title:"Error",text:"Client not found.",icon:"error"})}},error:o=>{console.error("Error fetching client:",o),c().fire({title:"Error",text:"Failed to load client details.",icon:"error"})}})}populateEditForm(t){this.editClientForm.patchValue({firstName:t.firstName||"",lastName:t.lastName||"",email:t.email||"",phoneNumber:this.formatPhoneForDisplay(t.phone||""),entityType:t.entityType||"",status:t.status||""}),this.editSubmitted=!1}updateClient(){if(this.editSubmitted=!0,this.editClientForm.invalid||!this.selectedClient)return;this.editLoading=!0;const t=this.editClientForm.value,o=t.phoneNumber?t.phoneNumber.replace(/\D/g,""):"",n={firstName:t.firstName.trim(),lastName:t.lastName.trim(),email:t.email?t.email.trim():null,phone:o||null,entityType:t.entityType||null,status:t.status||null};this.apiService.updateClient(this.selectedClient.id,n).pipe((0,u.Q)(this.destroy$)).subscribe({next:r=>{this.editLoading=!1,r.success?(c().fire({title:"Success!",text:"Client updated successfully.",icon:"success",confirmButtonText:"OK"}),this.editClientModal?.hide(),this.loadAllProjects(),this.editClientForm.reset(),this.selectedClient=null):c().fire({title:"Error",text:r.message||"Failed to update client.",icon:"error"})},error:r=>{this.editLoading=!1,console.error("Error updating client:",r),c().fire({title:"Error",text:"Failed to update client. Please try again.",icon:"error"})}})}formatPhoneForDisplay(t){if(!t)return"";const o=t.replace(/\D/g,"");return 10===o.length?`(${o.slice(0,3)}) ${o.slice(3,6)}-${o.slice(6)}`:t}get ef(){return this.editClientForm.controls}getTypeLabel(t){const o=this.projectTypes.find(n=>n.value===t);return o?o.label:t}getStatusClass(t){const o=this.projectStatuses.find(n=>n.value===t);return o?o.class:"badge bg-secondary"}getStatusLabel(t){const o=this.projectStatuses.find(n=>n.value===t);return o?o.label:t}formatDate(t){return t?new Date(t).toLocaleDateString():"Not set"}isOverdue(t){if(!t)return!1;const o=new Date(t),n=new Date;return n.setHours(0,0,0,0),o<n}getProjectCount(){return this.filteredProjects.length}getActiveProjectsCount(){return this.filteredProjects.filter(t=>"active"===t.status||"in_progress"===t.status).length}getOverdueProjectsCount(){return this.filteredProjects.filter(t=>this.isOverdue(t.dueDate||"")).length}getCompletedProjectsCount(){return this.filteredProjects.filter(t=>"completed"===t.status).length}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(g.Ix),e.rXU(f.G),e.rXU(a.ze))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-all-projects"]],viewQuery:function(o,n){if(1&o&&e.GBs(we,5),2&o){let r;e.mGM(r=e.lsd())&&(n.editClientModal=r.first)}},standalone:!0,features:[e.aNF],decls:170,vars:25,consts:[["editClientModal","bs-modal"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],[1,"page-title-right"],[1,"breadcrumb","m-0"],[1,"breadcrumb-item"],["href","javascript: void(0);"],[1,"breadcrumb-item","active"],[1,"col-xl-3","col-md-6"],[1,"card"],[1,"card-body"],[1,"d-flex"],[1,"flex-grow-1"],[1,"text-truncate","font-size-14","mb-2"],[1,"mb-2"],[1,"avatar-sm"],[1,"avatar-title","bg-light","text-primary","rounded-3"],[1,"bx","bx-folder","font-size-16"],[1,"avatar-title","bg-light","text-success","rounded-3"],[1,"bx","bx-play","font-size-16"],[1,"mb-2","text-danger"],[1,"avatar-title","bg-light","text-danger","rounded-3"],[1,"bx","bx-time","font-size-16"],[1,"avatar-title","bg-light","text-info","rounded-3"],[1,"bx","bx-check-circle","font-size-16"],[1,"row","g-3"],[1,"col-md-4"],["for","searchInput",1,"form-label"],["type","text","id","searchInput","placeholder","Search by name or description...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"col-md-2"],["for","statusFilter",1,"form-label"],["id","statusFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3"],["for","typeFilter",1,"form-label"],["id","typeFilter",1,"form-select",3,"ngModelChange","change","ngModel"],[1,"col-md-3","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bx","bx-refresh","me-1"],[1,"table-responsive"],["class","table table-nowrap table-hover mb-0",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["bsModal","","tabindex","-1","aria-labelledby","editClientModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","editClientModalLabel",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"col-lg-6"],[1,"mb-3"],["for","editFirstName",1,"form-label"],[1,"text-danger"],["type","text","id","editFirstName","formControlName","firstName",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","editLastName",1,"form-label"],["type","text","id","editLastName","formControlName","lastName",1,"form-control"],["for","editEmail",1,"form-label"],["type","email","id","editEmail","formControlName","email",1,"form-control"],["for","editPhoneNumber",1,"form-label"],["type","tel","id","editPhoneNumber","formControlName","phoneNumber","placeholder","(555) 123-4567",1,"form-control"],["for","editEntityType",1,"form-label"],["id","editEntityType","formControlName","entityType",1,"form-select"],["value","INDIVIDUAL"],["value","BUSINESS"],["for","editStatus",1,"form-label"],["id","editStatus","formControlName","status",1,"form-select"],["value","lead"],["value","invited"],["value","active"],["value","complete"],[1,"col-lg-12"],[1,"text-end"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[3,"value"],[1,"table","table-nowrap","table-hover","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center"],[1,"mb-1","font-size-14"],["href","javascript:void(0)","title","View project details",1,"text-dark","fw-medium",3,"click"],["class","text-muted mb-0 font-size-12",4,"ngIf"],["href","javascript:void(0)","title","View client details",1,"text-primary","fw-medium",3,"click"],[1,"badge","bg-light","text-dark"],["class","bx bx-time text-danger ms-1",4,"ngIf"],[1,"d-flex","gap-2"],["type","button","title","View Project Details",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bx","bx-show"],[1,"text-muted","mb-0","font-size-12"],[1,"bx","bx-time","text-danger","ms-1"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"mb-4"],[1,"bx","bx-folder-open","display-4","text-muted"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"invalid-feedback"],[4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(o,n){if(1&o){const r=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5),e.EFF(5,"All Projects"),e.k0s(),e.j41(6,"div",6)(7,"ol",7)(8,"li",8)(9,"a",9),e.EFF(10,"Tax Consultant"),e.k0s()(),e.j41(11,"li",10),e.EFF(12,"All Projects"),e.k0s()()()()()(),e.j41(13,"div",2)(14,"div",11)(15,"div",12)(16,"div",13)(17,"div",14)(18,"div",15)(19,"p",16),e.EFF(20,"Total Projects"),e.k0s(),e.j41(21,"h4",17),e.EFF(22),e.k0s()(),e.j41(23,"div",18)(24,"span",19),e.nrm(25,"i",20),e.k0s()()()()()(),e.j41(26,"div",11)(27,"div",12)(28,"div",13)(29,"div",14)(30,"div",15)(31,"p",16),e.EFF(32,"Active Projects"),e.k0s(),e.j41(33,"h4",17),e.EFF(34),e.k0s()(),e.j41(35,"div",18)(36,"span",21),e.nrm(37,"i",22),e.k0s()()()()()(),e.j41(38,"div",11)(39,"div",12)(40,"div",13)(41,"div",14)(42,"div",15)(43,"p",16),e.EFF(44,"Overdue Projects"),e.k0s(),e.j41(45,"h4",23),e.EFF(46),e.k0s()(),e.j41(47,"div",18)(48,"span",24),e.nrm(49,"i",25),e.k0s()()()()()(),e.j41(50,"div",11)(51,"div",12)(52,"div",13)(53,"div",14)(54,"div",15)(55,"p",16),e.EFF(56,"Completed Projects"),e.k0s(),e.j41(57,"h4",17),e.EFF(58),e.k0s()(),e.j41(59,"div",18)(60,"span",26),e.nrm(61,"i",27),e.k0s()()()()()()(),e.j41(62,"div",2)(63,"div",3)(64,"div",12)(65,"div",13)(66,"div",28)(67,"div",29)(68,"label",30),e.EFF(69,"Search Projects"),e.k0s(),e.j41(70,"input",31),e.mxI("ngModelChange",function(d){return e.eBV(r),e.DH7(n.searchTerm,d)||(n.searchTerm=d),e.Njj(d)}),e.bIt("input",function(){return e.eBV(r),e.Njj(n.onSearchChange())}),e.k0s()(),e.j41(71,"div",32)(72,"label",33),e.EFF(73,"Status"),e.k0s(),e.j41(74,"select",34),e.mxI("ngModelChange",function(d){return e.eBV(r),e.DH7(n.selectedStatus,d)||(n.selectedStatus=d),e.Njj(d)}),e.bIt("change",function(){return e.eBV(r),e.Njj(n.onStatusChange())}),e.j41(75,"option",35),e.EFF(76,"All Statuses"),e.k0s(),e.DNE(77,Ee,2,2,"option",36),e.k0s()(),e.j41(78,"div",37)(79,"label",38),e.EFF(80,"Project Type"),e.k0s(),e.j41(81,"select",39),e.mxI("ngModelChange",function(d){return e.eBV(r),e.DH7(n.selectedProjectType,d)||(n.selectedProjectType=d),e.Njj(d)}),e.bIt("change",function(){return e.eBV(r),e.Njj(n.onTypeChange())}),e.j41(82,"option",35),e.EFF(83,"All Types"),e.k0s(),e.DNE(84,Ie,2,2,"option",36),e.k0s()(),e.j41(85,"div",40)(86,"button",41),e.bIt("click",function(){return e.eBV(r),e.Njj(n.clearFilters())}),e.nrm(87,"i",42),e.EFF(88," Clear Filters "),e.k0s()()()()()()(),e.j41(89,"div",2)(90,"div",3)(91,"div",12)(92,"div",13)(93,"div",43),e.DNE(94,Me,21,1,"table",44)(95,Se,6,0,"div",45)(96,$e,7,2,"div",45),e.k0s()()()()()(),e.j41(97,"div",46,0)(99,"div",47)(100,"div",48)(101,"div",49)(102,"h5",50),e.EFF(103,"Edit Client"),e.k0s(),e.j41(104,"button",51),e.bIt("click",function(){e.eBV(r);const d=e.sdS(98);return e.Njj(null==d?null:d.hide())}),e.k0s()(),e.j41(105,"div",52)(106,"form",53),e.bIt("ngSubmit",function(){return e.eBV(r),e.Njj(n.updateClient())}),e.j41(107,"div",2)(108,"div",54)(109,"div",55)(110,"label",56),e.EFF(111,"First Name "),e.j41(112,"span",57),e.EFF(113,"*"),e.k0s()(),e.nrm(114,"input",58),e.DNE(115,Le,2,1,"div",59),e.k0s()(),e.j41(116,"div",54)(117,"div",55)(118,"label",60),e.EFF(119,"Last Name "),e.j41(120,"span",57),e.EFF(121,"*"),e.k0s()(),e.nrm(122,"input",61),e.DNE(123,Ae,2,1,"div",59),e.k0s()()(),e.j41(124,"div",2)(125,"div",54)(126,"div",55)(127,"label",62),e.EFF(128,"Email"),e.k0s(),e.nrm(129,"input",63),e.DNE(130,Ve,2,1,"div",59),e.k0s()(),e.j41(131,"div",54)(132,"div",55)(133,"label",64),e.EFF(134,"Phone Number"),e.k0s(),e.nrm(135,"input",65),e.k0s()()(),e.j41(136,"div",2)(137,"div",54)(138,"div",55)(139,"label",66),e.EFF(140,"Entity Type"),e.k0s(),e.j41(141,"select",67)(142,"option",35),e.EFF(143,"Select Entity Type"),e.k0s(),e.j41(144,"option",68),e.EFF(145,"Individual"),e.k0s(),e.j41(146,"option",69),e.EFF(147,"Business"),e.k0s()()()(),e.j41(148,"div",54)(149,"div",55)(150,"label",70),e.EFF(151,"Status"),e.k0s(),e.j41(152,"select",71)(153,"option",35),e.EFF(154,"Select Status"),e.k0s(),e.j41(155,"option",72),e.EFF(156,"Lead"),e.k0s(),e.j41(157,"option",73),e.EFF(158,"Invited"),e.k0s(),e.j41(159,"option",74),e.EFF(160,"Active"),e.k0s(),e.j41(161,"option",75),e.EFF(162,"Complete"),e.k0s()()()()(),e.j41(163,"div",76)(164,"div",77)(165,"button",78),e.bIt("click",function(){e.eBV(r);const d=e.sdS(98);return e.Njj(null==d?null:d.hide())}),e.EFF(166,"Cancel"),e.k0s(),e.j41(167,"button",79),e.DNE(168,Ue,1,0,"span",80),e.EFF(169," Update Client "),e.k0s()()()()()()()()}2&o&&(e.R7$(22),e.JRh(n.getProjectCount()),e.R7$(12),e.JRh(n.getActiveProjectsCount()),e.R7$(12),e.JRh(n.getOverdueProjectsCount()),e.R7$(12),e.JRh(n.getCompletedProjectsCount()),e.R7$(12),e.R50("ngModel",n.searchTerm),e.R7$(4),e.R50("ngModel",n.selectedStatus),e.R7$(3),e.Y8G("ngForOf",n.projectStatuses),e.R7$(4),e.R50("ngModel",n.selectedProjectType),e.R7$(3),e.Y8G("ngForOf",n.projectTypes),e.R7$(10),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&0===n.filteredProjects.length),e.R7$(10),e.Y8G("formGroup",n.editClientForm),e.R7$(8),e.AVh("is-invalid",n.editSubmitted&&n.ef.firstName.errors),e.R7$(),e.Y8G("ngIf",n.editSubmitted&&n.ef.firstName.errors),e.R7$(7),e.AVh("is-invalid",n.editSubmitted&&n.ef.lastName.errors),e.R7$(),e.Y8G("ngIf",n.editSubmitted&&n.ef.lastName.errors),e.R7$(6),e.AVh("is-invalid",n.editSubmitted&&n.ef.email.errors),e.R7$(),e.Y8G("ngIf",n.editSubmitted&&n.ef.email.errors),e.R7$(35),e.Y8G("disabled",n.editLoading),e.R7$(2),e.Y8G("disabled",n.editLoading),e.R7$(),e.Y8G("ngIf",n.editLoading))},dependencies:[m.MD,m.Sq,m.bT,a.YN,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,a.vS,a.X1,a.j4,a.JD,h.Q_,h.hZ],styles:['.card[_ngcontent-%COMP%]{box-shadow:0 .75rem 1.5rem #12263f08;border:1px solid #eff2f7;border-radius:.375rem;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 1rem 2rem #12263f1a}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.8125rem;color:#495057;border-bottom:2px solid #eff2f7}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.8125rem;vertical-align:middle;border-bottom:1px solid #eff2f7}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.btn-link[_ngcontent-%COMP%]{text-decoration:none;font-weight:500}.btn-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500}.avatar-title[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.font-size-12[_ngcontent-%COMP%]{font-size:.75rem!important}.font-size-14[_ngcontent-%COMP%]{font-size:.875rem!important}.font-size-16[_ngcontent-%COMP%]{font-size:1rem!important}.font-size-18[_ngcontent-%COMP%]{font-size:1.125rem!important}.display-4[_ngcontent-%COMP%]{font-size:3.5rem;font-weight:300;line-height:1.2}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.page-title-box[_ngcontent-%COMP%]{padding-bottom:1.5rem}.breadcrumb[_ngcontent-%COMP%]{background-color:transparent;padding:0;margin:0}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]:before{content:">";color:#74788d}.breadcrumb-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#556ee6;text-decoration:none}.breadcrumb-item.active[_ngcontent-%COMP%]{color:#495057}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.75rem}.d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column;gap:.25rem!important}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}}']})}}return i})();var b=p(400);const Xe=[{path:"projects",component:v,canActivate:[b.K],data:{role:"ACCOUNTANT"}},{path:"intake-forms",component:T,canActivate:[b.K],data:{role:"ACCOUNTANT"}},{path:"intake-form-detail/:id",component:U,canActivate:[b.K],data:{role:"ACCOUNTANT"}},{path:"client-documents",component:ee,canActivate:[b.K],data:{role:"ACCOUNTANT"}},{path:"client-projects/:clientId",component:ue,canActivate:[b.K],data:{role:"ACCOUNTANT"}},{path:"project-detail/:projectId",component:F,canActivate:[b.K],data:{role:"ACCOUNTANT"}}];let ze=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[g.iI.forChild(Xe),g.iI]})}}return i})();var Je=p(6551),He=p(1745),qe=p(8580),Qe=p(3816);let Ke=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[m.MD,a.YN,a.X1,ze,Je.T,He.V,F,v,qe.zE,h.Q_,Qe.jr]})}}return i})()}}]);
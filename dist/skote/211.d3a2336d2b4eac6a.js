"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[211],{8211:(Se,f,l)=>{l.r(f),l.d(f,{ClientPortalModule:()=>Ee});var d=l(177),i=l(9417),g=l(803),e=l(4438);function h(o,a){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",25),e.nrm(3,"i",26),e.EFF(4),e.k0s()(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td")(13,"span"),e.EFF(14),e.nI1(15,"titlecase"),e.k0s()(),e.j41(16,"td")(17,"button",27),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.downloadDocument(r))}),e.nrm(18,"i",28),e.k0s()()()}if(2&o){const t=a.$implicit,n=e.XpG();e.R7$(4),e.SpI(" ",t.name," "),e.R7$(2),e.JRh(t.type),e.R7$(2),e.JRh(t.size),e.R7$(2),e.JRh(e.i5U(11,7,t.uploadDate,"shortDate")),e.R7$(3),e.HbH(n.getStatusClass(t.status)),e.R7$(),e.SpI(" ",e.bMT(15,10,t.status)," ")}}function b(o,a){1&o&&(e.j41(0,"tr")(1,"td",29),e.EFF(2," No documents found matching your criteria. "),e.k0s()())}let _=(()=>{class o{constructor(){this.documents=[],this.filteredDocuments=[],this.selectedCategory="all",this.searchTerm=""}ngOnInit(){this.loadDocuments()}loadDocuments(){this.documents=[{id:1,name:"W2_2024.pdf",type:"PDF",size:"245 KB",uploadDate:"2024-01-15",status:"approved",category:"tax-documents"},{id:2,name:"Bank_Statement_Jan2024.pdf",type:"PDF",size:"1.2 MB",uploadDate:"2024-02-01",status:"reviewed",category:"financial-statements"},{id:3,name:"Receipt_Office_Supplies.jpg",type:"Image",size:"890 KB",uploadDate:"2024-02-10",status:"pending",category:"receipts"}],this.filteredDocuments=[...this.documents]}filterDocuments(){this.filteredDocuments=this.documents.filter(t=>{const n="all"===this.selectedCategory||t.category===this.selectedCategory,r=t.name.toLowerCase().includes(this.searchTerm.toLowerCase());return n&&r})}onCategoryChange(){this.filterDocuments()}onSearchChange(){this.filterDocuments()}getStatusClass(t){switch(t){case"approved":return"badge bg-success";case"reviewed":return"badge bg-info";case"pending":return"badge bg-warning";default:return"badge bg-secondary"}}downloadDocument(t){console.log("Downloading document:",t.name)}uploadDocument(){console.log("Upload document functionality")}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-documents"]],decls:58,vars:4,consts:[[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"card-title","mb-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ri-upload-cloud-line","me-1"],[1,"row","mb-4"],[1,"col-md-6"],["for","categoryFilter",1,"form-label"],["id","categoryFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","all"],["value","tax-documents"],["value","financial-statements"],["value","receipts"],["value","other"],["for","searchInput",1,"form-label"],["type","text","id","searchInput","placeholder","Search by document name...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-nowrap","table-hover"],[1,"table-light"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"alert","alert-info","mt-4"],[1,"alert-heading"],[1,"mb-0"],[1,"d-flex","align-items-center"],[1,"ri-file-text-line","me-2","text-muted"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"ri-download-line"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4,"Documents"),e.k0s(),e.j41(5,"button",4),e.bIt("click",function(){return r.uploadDocument()}),e.nrm(6,"i",5),e.EFF(7,"Upload Document "),e.k0s()(),e.j41(8,"div",6)(9,"div",7)(10,"label",8),e.EFF(11,"Filter by Category"),e.k0s(),e.j41(12,"select",9),e.mxI("ngModelChange",function(c){return e.DH7(r.selectedCategory,c)||(r.selectedCategory=c),c}),e.bIt("change",function(){return r.onCategoryChange()}),e.j41(13,"option",10),e.EFF(14,"All Categories"),e.k0s(),e.j41(15,"option",11),e.EFF(16,"Tax Documents"),e.k0s(),e.j41(17,"option",12),e.EFF(18,"Financial Statements"),e.k0s(),e.j41(19,"option",13),e.EFF(20,"Receipts"),e.k0s(),e.j41(21,"option",14),e.EFF(22,"Other"),e.k0s()()(),e.j41(23,"div",7)(24,"label",15),e.EFF(25,"Search Documents"),e.k0s(),e.j41(26,"input",16),e.mxI("ngModelChange",function(c){return e.DH7(r.searchTerm,c)||(r.searchTerm=c),c}),e.bIt("input",function(){return r.onSearchChange()}),e.k0s()()(),e.j41(27,"div",17)(28,"table",18)(29,"thead",19)(30,"tr")(31,"th"),e.EFF(32,"Document Name"),e.k0s(),e.j41(33,"th"),e.EFF(34,"Type"),e.k0s(),e.j41(35,"th"),e.EFF(36,"Size"),e.k0s(),e.j41(37,"th"),e.EFF(38,"Upload Date"),e.k0s(),e.j41(39,"th"),e.EFF(40,"Status"),e.k0s(),e.j41(41,"th"),e.EFF(42,"Actions"),e.k0s()()(),e.j41(43,"tbody"),e.DNE(44,h,19,12,"tr",20)(45,b,3,0,"tr",21),e.k0s()()(),e.j41(46,"div",22)(47,"h6",23),e.EFF(48,"Upload Guidelines:"),e.k0s(),e.j41(49,"ul",24)(50,"li"),e.EFF(51,"Accepted formats: PDF, JPG, PNG, DOC, DOCX"),e.k0s(),e.j41(52,"li"),e.EFF(53,"Maximum file size: 10MB"),e.k0s(),e.j41(54,"li"),e.EFF(55,"Please organize documents by category for easier processing"),e.k0s(),e.j41(56,"li"),e.EFF(57,"Uploaded documents will be reviewed within 1-2 business days"),e.k0s()()()()()),2&n&&(e.R7$(12),e.R50("ngModel",r.selectedCategory),e.R7$(14),e.R50("ngModel",r.searchTerm),e.R7$(18),e.Y8G("ngForOf",r.filteredDocuments),e.R7$(),e.Y8G("ngIf",0===r.filteredDocuments.length))},dependencies:[d.Sq,d.bT,i.xH,i.y7,i.me,i.wz,i.BC,i.vS,d.PV,d.vh],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;border-top:none}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem}.alert-info[_ngcontent-%COMP%]{border-left:4px solid #17a2b8}.card-title[_ngcontent-%COMP%]{font-weight:600}"]})}}return o})();function v(o,a){1&o&&(e.j41(0,"span"),e.nrm(1,"i",20),e.EFF(2,"Completed "),e.k0s())}function k(o,a){1&o&&(e.j41(0,"span"),e.nrm(1,"i",21),e.EFF(2,"Continue "),e.k0s())}function F(o,a){1&o&&(e.j41(0,"span"),e.nrm(1,"i",22),e.EFF(2,"Start Form "),e.k0s())}function C(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",1)(3,"div",10),e.nrm(4,"i",11),e.j41(5,"span"),e.EFF(6),e.nI1(7,"titlecase"),e.nI1(8,"replace"),e.k0s()(),e.j41(9,"h5",12),e.EFF(10),e.k0s(),e.j41(11,"p",13),e.EFF(12),e.k0s(),e.j41(13,"div",14)(14,"small",15),e.nrm(15,"i",16),e.EFF(16),e.nI1(17,"date"),e.k0s(),e.nrm(18,"br"),e.j41(19,"small",15),e.nrm(20,"i",17),e.EFF(21),e.k0s()(),e.j41(22,"button",18),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.openForm(r))}),e.DNE(23,v,3,0,"span",19)(24,k,3,0,"span",19)(25,F,3,0,"span",19),e.k0s()()()()}if(2&o){const t=a.$implicit,n=e.XpG();e.R7$(),e.AVh("border-success","completed"===t.status)("border-warning","in-progress"===t.status),e.R7$(3),e.HbH(n.getStatusIcon(t.status)),e.R7$(),e.HbH(n.getStatusClass(t.status)),e.R7$(),e.JRh(e.brH(8,19,e.bMT(7,17,t.status),"-"," ")),e.R7$(4),e.JRh(t.title),e.R7$(2),e.JRh(t.description),e.R7$(4),e.SpI(" Due: ",e.i5U(17,23,t.dueDate,"shortDate")," "),e.R7$(5),e.SpI(" ",t.category," "),e.R7$(),e.Y8G("disabled","completed"===t.status),e.R7$(),e.Y8G("ngIf","completed"===t.status),e.R7$(),e.Y8G("ngIf","in-progress"===t.status),e.R7$(),e.Y8G("ngIf","not-started"===t.status)}}function y(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",23)(1,"div",24)(2,"div",25)(3,"div",26)(4,"h5",27),e.EFF(5),e.k0s(),e.j41(6,"button",28),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeForm())}),e.k0s()(),e.j41(7,"div",29)(8,"form",30)(9,"div",4)(10,"div",31)(11,"label",32),e.EFF(12,"Business Name *"),e.k0s(),e.nrm(13,"input",33),e.k0s(),e.j41(14,"div",31)(15,"label",34),e.EFF(16,"Business Type *"),e.k0s(),e.j41(17,"select",35)(18,"option",36),e.EFF(19,"Select Business Type"),e.k0s(),e.j41(20,"option",37),e.EFF(21,"LLC"),e.k0s(),e.j41(22,"option",38),e.EFF(23,"Corporation"),e.k0s(),e.j41(24,"option",39),e.EFF(25,"Partnership"),e.k0s(),e.j41(26,"option",40),e.EFF(27,"Sole Proprietorship"),e.k0s()()()(),e.j41(28,"div",4)(29,"div",31)(30,"label",41),e.EFF(31,"Tax ID (EIN) *"),e.k0s(),e.nrm(32,"input",42),e.k0s(),e.j41(33,"div",31)(34,"label",43),e.EFF(35,"Phone Number *"),e.k0s(),e.nrm(36,"input",44),e.k0s()(),e.j41(37,"div",14)(38,"label",45),e.EFF(39,"Business Address *"),e.k0s(),e.nrm(40,"textarea",46),e.k0s(),e.j41(41,"div",4)(42,"div",31)(43,"label",47),e.EFF(44,"Email Address *"),e.k0s(),e.nrm(45,"input",48),e.k0s(),e.j41(46,"div",31)(47,"label",49),e.EFF(48,"Annual Revenue"),e.k0s(),e.nrm(49,"input",50),e.k0s()(),e.j41(50,"div",4)(51,"div",31)(52,"label",51),e.EFF(53,"Number of Employees"),e.k0s(),e.nrm(54,"input",52),e.k0s()(),e.j41(55,"div",14)(56,"label",53),e.EFF(57,"Business Description"),e.k0s(),e.nrm(58,"textarea",54),e.k0s()()(),e.j41(59,"div",55)(60,"button",56),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closeForm())}),e.EFF(61,"Cancel"),e.k0s(),e.j41(62,"button",57),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.saveForm())}),e.EFF(63,"Save Draft"),e.k0s(),e.j41(64,"button",58),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.submitForm())}),e.EFF(65,"Submit Form"),e.k0s()()()()()}if(2&o){const t=e.XpG();e.xc7("display",t.showFormModal?"block":"none"),e.AVh("show",t.showFormModal),e.R7$(5),e.JRh(null==t.selectedForm?null:t.selectedForm.title),e.R7$(3),e.Y8G("formGroup",t.currentForm),e.R7$(54),e.Y8G("disabled",!t.currentForm.valid),e.R7$(2),e.Y8G("disabled",!t.currentForm.valid)}}function x(o,a){if(1&o&&e.nrm(0,"div",59),2&o){const t=e.XpG();e.AVh("show",t.showFormModal)}}let I=(()=>{class o{constructor(t){this.fb=t,this.intakeForms=[],this.selectedForm=null,this.showFormModal=!1,this.currentForm=this.fb.group({businessName:["",i.k0.required],businessType:["",i.k0.required],taxId:["",i.k0.required],address:["",i.k0.required],phone:["",i.k0.required],email:["",[i.k0.required,i.k0.email]],annualRevenue:[""],numberOfEmployees:[""],businessDescription:[""]})}ngOnInit(){this.loadIntakeForms()}loadIntakeForms(){this.intakeForms=[{id:1,title:"Business Information Form",description:"Basic business details and contact information",status:"completed",dueDate:"2024-01-15",category:"Business Setup"},{id:2,title:"Tax Preparation Questionnaire",description:"Annual tax preparation information and documentation requirements",status:"in-progress",dueDate:"2024-03-15",category:"Tax Preparation"},{id:3,title:"Bookkeeping Services Setup",description:"Monthly bookkeeping service preferences and requirements",status:"not-started",dueDate:"2024-02-28",category:"Bookkeeping"}]}getStatusClass(t){switch(t){case"completed":return"badge bg-success";case"in-progress":return"badge bg-warning";default:return"badge bg-secondary"}}getStatusIcon(t){switch(t){case"completed":return"ri-check-line";case"in-progress":return"ri-time-line";default:return"ri-file-list-line"}}openForm(t){this.selectedForm=t,this.showFormModal=!0,1===t.id&&this.currentForm.patchValue({businessName:"Sample Business LLC",businessType:"LLC",taxId:"12-3456789",address:"123 Main St, City, State 12345",phone:"(555) 123-4567",email:"business@example.com",annualRevenue:"500000",numberOfEmployees:"5",businessDescription:"Professional services company"})}closeForm(){this.showFormModal=!1,this.selectedForm=null}saveForm(){this.currentForm.valid&&this.selectedForm&&(console.log("Saving form data:",this.currentForm.value),this.selectedForm.status="in-progress",this.closeForm())}submitForm(){this.currentForm.valid&&this.selectedForm&&(console.log("Submitting form data:",this.currentForm.value),this.selectedForm.status="completed",this.closeForm())}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(i.ok))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-intake"]],decls:10,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"card-title","mb-4"],[1,"text-muted","mb-4"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","modal fade","tabindex","-1",3,"show","display",4,"ngIf"],["class","modal-backdrop fade",3,"show",4,"ngIf"],[1,"col-lg-4","col-md-6","mb-4"],[1,"card","border","h-100"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"font-size-24","text-primary"],[1,"card-title"],[1,"card-text","text-muted"],[1,"mb-3"],[1,"text-muted"],[1,"ri-calendar-line","me-1"],[1,"ri-folder-line","me-1"],["type","button",1,"btn","btn-primary","btn-sm",3,"click","disabled"],[4,"ngIf"],[1,"ri-check-line","me-1"],[1,"ri-edit-line","me-1"],[1,"ri-play-line","me-1"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"col-md-6","mb-3"],["for","businessName",1,"form-label"],["type","text","id","businessName","formControlName","businessName",1,"form-control"],["for","businessType",1,"form-label"],["id","businessType","formControlName","businessType",1,"form-select"],["value",""],["value","LLC"],["value","Corporation"],["value","Partnership"],["value","Sole Proprietorship"],["for","taxId",1,"form-label"],["type","text","id","taxId","formControlName","taxId",1,"form-control"],["for","phone",1,"form-label"],["type","tel","id","phone","formControlName","phone",1,"form-control"],["for","address",1,"form-label"],["id","address","rows","2","formControlName","address",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","annualRevenue",1,"form-label"],["type","number","id","annualRevenue","formControlName","annualRevenue",1,"form-control"],["for","numberOfEmployees",1,"form-label"],["type","number","id","numberOfEmployees","formControlName","numberOfEmployees",1,"form-control"],["for","businessDescription",1,"form-label"],["id","businessDescription","rows","3","formControlName","businessDescription",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"modal-backdrop","fade"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"h4",2),e.EFF(3,"Intake Forms"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Complete the required forms below to help us serve you better. Click on any form to get started."),e.k0s(),e.j41(6,"div",4),e.DNE(7,C,26,26,"div",5),e.k0s()()(),e.DNE(8,y,66,8,"div",6)(9,x,1,2,"div",7)),2&n&&(e.R7$(7),e.Y8G("ngForOf",r.intakeForms),e.R7$(),e.Y8G("ngIf",r.showFormModal),e.R7$(),e.Y8G("ngIf",r.showFormModal))},dependencies:[d.Sq,d.bT,i.qT,i.xH,i.y7,i.me,i.Q0,i.wz,i.BC,i.cb,i.j4,i.JD,d.PV,d.vh],styles:[".card.border-success[_ngcontent-%COMP%]{border-color:#28a745!important}.card.border-warning[_ngcontent-%COMP%]{border-color:#ffc107!important}.card-title[_ngcontent-%COMP%]{font-weight:600}.modal.show[_ngcontent-%COMP%]{background-color:#00000080}.modal-backdrop.show[_ngcontent-%COMP%]{opacity:.5}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem}.form-label[_ngcontent-%COMP%]{font-weight:500}"]})}}return o})();var j=l(1413),u=l(6977),M=l(152),E=l(3294),S=l(8032),p=l.n(S),T=l(5312),N=l(1626);let P=(()=>{class o{constructor(t){this.http=t,this.apiUrl=T.c.apiUrl}getClientIntakeForm(t){return this.http.get(`${this.apiUrl}/clients/${t}/intake`)}submitIntakeForm(t,n){return this.http.post(`${this.apiUrl}/clients/${t}/intake/submit`,n)}autoSaveForm(t,n){return this.http.post(`${this.apiUrl}/clients/${t}/intake/submit`,{...n,status:"draft"})}maskSSN(t){return!t||t.length<4?"***-**-****":`***-**-${t.slice(-4)}`}formatSSN(t){const n=t.replace(/\D/g,"");return n.length>=9?`${n.slice(0,3)}-${n.slice(3,5)}-${n.slice(5,9)}`:n.length>=5?`${n.slice(0,3)}-${n.slice(3,5)}-${n.slice(5)}`:n.length>=3?`${n.slice(0,3)}-${n.slice(3)}`:n}calculateProgress(t){let n=0;return t.personalInformation?.fullName&&t.personalInformation?.ssn&&t.personalInformation?.address?.street&&n++,void 0!==t.dependents&&n++,t.incomeSource&&t.incomeSource.length>0&&n++,t.deductionsAdjustments&&n++,void 0!==t.healthCoverage?.hadInsuranceAllYear&&n++,t.credits&&n++,void 0!==t.priorYearInfo?.filedLastYear&&n++,Math.round(n/7*100)}generateId(){return Math.random().toString(36).substr(2,9)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(N.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function D(o,a){1&o&&(e.j41(0,"span",16),e.EFF(1,"Saving..."),e.k0s())}function O(o,a){1&o&&e.nrm(0,"i",20)}function w(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",17),e.bIt("click",function(){const r=e.eBV(t).index,s=e.XpG();return e.Njj(s.goToSection(r))}),e.nrm(1,"i",18),e.EFF(2),e.DNE(3,O,1,0,"i",19),e.k0s()}if(2&o){const t=a.$implicit,n=a.index,r=e.XpG();e.AVh("btn-success",t.completed)("btn-primary",n===r.currentSection&&!t.completed)("btn-outline-secondary",n!==r.currentSection&&!t.completed),e.R7$(),e.HbH(t.icon),e.R7$(),e.SpI(" ",t.title," "),e.R7$(),e.Y8G("ngIf",t.completed)}}function R(o,a){1&o&&e.nrm(0,"i",61)}function G(o,a){1&o&&e.nrm(0,"i",62)}function $(o,a){1&o&&e.nrm(0,"i",61)}function A(o,a){1&o&&e.nrm(0,"i",62)}function Y(o,a){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"div",1)(2,"div",32)(3,"label",33),e.EFF(4,"Spouse's Name"),e.k0s(),e.nrm(5,"input",63),e.k0s(),e.j41(6,"div",32)(7,"label",33),e.EFF(8,"Spouse's SSN"),e.k0s(),e.j41(9,"div",36)(10,"input",37),e.bIt("input",function(r){e.eBV(t);const s=e.XpG(3);return e.Njj(s.formatSSNInput(r,"personalInformation.spouseSsn"))}),e.k0s(),e.j41(11,"button",38),e.bIt("click",function(){e.eBV(t);const r=e.XpG(3);return e.Njj(r.toggleSSNMask("spouse-ssn"))}),e.DNE(12,$,1,0,"i",39)(13,A,1,0,"i",40),e.k0s()()()()()}if(2&o){let t;const n=e.XpG(3);e.R7$(10),e.Y8G("value",n.getDisplaySSN(null==(t=n.intakeForm.get("personalInformation.spouseSsn"))?null:t.value,"spouse-ssn")),e.R7$(2),e.Y8G("ngIf",n.isSSNMasked("spouse-ssn")),e.R7$(),e.Y8G("ngIf",!n.isSSNMasked("spouse-ssn"))}}function B(o,a){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"h5",30),e.EFF(2,"\u{1f510} Section A. Personal Information"),e.k0s(),e.j41(3,"div",31)(4,"div",1)(5,"div",32)(6,"label",33),e.EFF(7,"Full Name *"),e.k0s(),e.nrm(8,"input",34),e.k0s(),e.j41(9,"div",32)(10,"label",33),e.EFF(11,"Date of Birth *"),e.k0s(),e.nrm(12,"input",35),e.k0s()(),e.j41(13,"div",1)(14,"div",32)(15,"label",33),e.EFF(16,"SSN/ITIN *"),e.k0s(),e.j41(17,"div",36)(18,"input",37),e.bIt("input",function(r){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formatSSNInput(r,"personalInformation.ssn"))}),e.k0s(),e.j41(19,"button",38),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.toggleSSNMask("personal-ssn"))}),e.DNE(20,R,1,0,"i",39)(21,G,1,0,"i",40),e.k0s()()(),e.j41(22,"div",32)(23,"label",33),e.EFF(24,"Marital Status *"),e.k0s(),e.j41(25,"select",41)(26,"option",42),e.EFF(27,"Select Status"),e.k0s(),e.j41(28,"option",43),e.EFF(29,"Single"),e.k0s(),e.j41(30,"option",44),e.EFF(31,"Married Filing Jointly"),e.k0s(),e.j41(32,"option",45),e.EFF(33,"Married Filing Separately"),e.k0s(),e.j41(34,"option",46),e.EFF(35,"Head of Household"),e.k0s(),e.j41(36,"option",47),e.EFF(37,"Qualifying Widower"),e.k0s()()()(),e.DNE(38,Y,14,3,"div",22),e.j41(39,"div",48)(40,"div",1)(41,"div",49)(42,"label",33),e.EFF(43,"Street Address *"),e.k0s(),e.nrm(44,"input",50),e.k0s()(),e.j41(45,"div",1)(46,"div",51)(47,"label",33),e.EFF(48,"City *"),e.k0s(),e.nrm(49,"input",52),e.k0s(),e.j41(50,"div",51)(51,"label",33),e.EFF(52,"State *"),e.k0s(),e.nrm(53,"input",53),e.k0s(),e.j41(54,"div",51)(55,"label",33),e.EFF(56,"ZIP Code *"),e.k0s(),e.nrm(57,"input",54),e.k0s()()(),e.j41(58,"div",1)(59,"div",32)(60,"label",33),e.EFF(61,"Phone *"),e.k0s(),e.nrm(62,"input",55),e.k0s(),e.j41(63,"div",32)(64,"label",33),e.EFF(65,"Email *"),e.k0s(),e.nrm(66,"input",56),e.k0s()(),e.j41(67,"div",57)(68,"h6",58),e.EFF(69,"Driver's License / State ID"),e.k0s(),e.j41(70,"div",1)(71,"div",51)(72,"label",33),e.EFF(73,"License Number"),e.k0s(),e.nrm(74,"input",59),e.k0s(),e.j41(75,"div",51)(76,"label",33),e.EFF(77,"State"),e.k0s(),e.nrm(78,"input",53),e.k0s(),e.j41(79,"div",51)(80,"label",33),e.EFF(81,"Expiration Date"),e.k0s(),e.nrm(82,"input",60),e.k0s()()()()()}if(2&o){let t,n;const r=e.XpG(2);e.R7$(18),e.Y8G("value",r.getDisplaySSN(null==(t=r.intakeForm.get("personalInformation.ssn"))?null:t.value,"personal-ssn")),e.R7$(2),e.Y8G("ngIf",r.isSSNMasked("personal-ssn")),e.R7$(),e.Y8G("ngIf",!r.isSSNMasked("personal-ssn")),e.R7$(17),e.Y8G("ngIf","married-jointly"===(null==(n=r.intakeForm.get("personalInformation.maritalStatus"))?null:n.value)||"married-separately"===(null==(n=r.intakeForm.get("personalInformation.maritalStatus"))?null:n.value))}}function L(o,a){1&o&&(e.j41(0,"div",70),e.nrm(1,"i",71),e.j41(2,"p"),e.EFF(3,'No dependents added yet. Click "Add Dependent" to get started.'),e.k0s()())}function V(o,a){1&o&&e.nrm(0,"i",61)}function X(o,a){1&o&&e.nrm(0,"i",62)}function U(o,a){1&o&&(e.j41(0,"div",1)(1,"div",32)(2,"label",33),e.EFF(3,"Child Care Amount"),e.k0s(),e.nrm(4,"input",89),e.k0s()())}function z(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",72)(1,"div",73)(2,"h6",65),e.EFF(3),e.k0s(),e.j41(4,"button",74),e.bIt("click",function(){const r=e.eBV(t).index,s=e.XpG(3);return e.Njj(s.removeDependent(r))}),e.nrm(5,"i",75),e.k0s()(),e.j41(6,"div",76)(7,"div",1)(8,"div",32)(9,"label",33),e.EFF(10,"Name *"),e.k0s(),e.nrm(11,"input",77),e.k0s(),e.j41(12,"div",32)(13,"label",33),e.EFF(14,"SSN/ITIN *"),e.k0s(),e.j41(15,"div",36)(16,"input",37),e.bIt("input",function(r){const s=e.eBV(t).index,c=e.XpG(3);return e.Njj(c.formatSSNInput(r,"dependents."+s+".ssn"))}),e.k0s(),e.j41(17,"button",38),e.bIt("click",function(){const r=e.eBV(t).index,s=e.XpG(3);return e.Njj(s.toggleSSNMask("dependent-ssn-"+r))}),e.DNE(18,V,1,0,"i",39)(19,X,1,0,"i",40),e.k0s()()()(),e.j41(20,"div",1)(21,"div",51)(22,"label",33),e.EFF(23,"Date of Birth *"),e.k0s(),e.nrm(24,"input",35),e.k0s(),e.j41(25,"div",51)(26,"label",33),e.EFF(27,"Relationship *"),e.k0s(),e.j41(28,"select",78)(29,"option",42),e.EFF(30,"Select Relationship"),e.k0s(),e.j41(31,"option",79),e.EFF(32,"Son"),e.k0s(),e.j41(33,"option",80),e.EFF(34,"Daughter"),e.k0s(),e.j41(35,"option",81),e.EFF(36,"Stepchild"),e.k0s(),e.j41(37,"option",82),e.EFF(38,"Grandchild"),e.k0s(),e.j41(39,"option",83),e.EFF(40,"Other"),e.k0s()()(),e.j41(41,"div",51)(42,"label",33),e.EFF(43,"Months Lived With You"),e.k0s(),e.nrm(44,"input",84),e.k0s()(),e.j41(45,"div",1)(46,"div",32)(47,"div",85),e.nrm(48,"input",86),e.j41(49,"label",87),e.EFF(50,"Lived with you full year"),e.k0s()()(),e.j41(51,"div",32)(52,"div",85),e.nrm(53,"input",88),e.j41(54,"label",87),e.EFF(55,"Child care expenses paid"),e.k0s()()()(),e.DNE(56,U,5,0,"div",15),e.k0s()()}if(2&o){let t,n;const r=a.$implicit,s=a.index,c=e.XpG(3);e.R7$(3),e.SpI("Dependent ",s+1,""),e.R7$(3),e.Y8G("formGroup",r),e.R7$(10),e.Y8G("value",c.getDisplaySSN(null==(t=r.get("ssn"))?null:t.value,"dependent-ssn-"+s)),e.R7$(2),e.Y8G("ngIf",c.isSSNMasked("dependent-ssn-"+s)),e.R7$(),e.Y8G("ngIf",!c.isSSNMasked("dependent-ssn-"+s)),e.R7$(29),e.Mz_("id","fullYear_",s,""),e.R7$(),e.Mz_("for","fullYear_",s,""),e.R7$(4),e.Mz_("id","childCare_",s,""),e.R7$(),e.Mz_("for","childCare_",s,""),e.R7$(2),e.Y8G("ngIf",null==(n=r.get("childCareExpenses"))?null:n.value)}}function q(o,a){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"div",64)(2,"h5",65),e.EFF(3,"\u{1f468}\u200d\u{1f469}\u200d\u{1f467} Section B. Dependents"),e.k0s(),e.j41(4,"button",66),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.addDependent())}),e.nrm(5,"i",67),e.EFF(6,"Add Dependent "),e.k0s()(),e.DNE(7,L,4,0,"div",68)(8,z,57,14,"div",69),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",0===t.dependentsArray.length),e.R7$(),e.Y8G("ngForOf",t.dependentsArray.controls)}}function H(o,a){1&o&&(e.j41(0,"div",70),e.nrm(1,"i",91),e.j41(2,"p"),e.EFF(3,'No income sources added yet. Click "Add Income Source" to get started.'),e.k0s()())}function J(o,a){1&o&&(e.j41(0,"div",1)(1,"div",32)(2,"label",33),e.EFF(3,"Employer Name"),e.k0s(),e.nrm(4,"input",105),e.k0s()())}function Q(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",72)(1,"div",73)(2,"h6",65),e.EFF(3),e.k0s(),e.j41(4,"button",74),e.bIt("click",function(){const r=e.eBV(t).index,s=e.XpG(3);return e.Njj(s.removeIncomeSource(r))}),e.nrm(5,"i",75),e.k0s()(),e.j41(6,"div",76)(7,"div",1)(8,"div",51)(9,"label",33),e.EFF(10,"Income Type *"),e.k0s(),e.j41(11,"select",92)(12,"option",42),e.EFF(13,"Select Type"),e.k0s(),e.j41(14,"option",93),e.EFF(15,"W-2 Employment Income"),e.k0s(),e.j41(16,"option",94),e.EFF(17,"1099-NEC (Freelance/Contractor)"),e.k0s(),e.j41(18,"option",95),e.EFF(19,"1099-MISC"),e.k0s(),e.j41(20,"option",96),e.EFF(21,"1099-INT (Interest)"),e.k0s(),e.j41(22,"option",97),e.EFF(23,"1099-DIV (Dividends)"),e.k0s(),e.j41(24,"option",98),e.EFF(25,"1099-B (Stock Sales)"),e.k0s(),e.j41(26,"option",99),e.EFF(27,"1099-R (Retirement)"),e.k0s(),e.j41(28,"option",100),e.EFF(29,"SSA-1099 (Social Security)"),e.k0s(),e.j41(30,"option",101),e.EFF(31,"Rental Income"),e.k0s(),e.j41(32,"option",102),e.EFF(33,"Business/Self-Employment"),e.k0s(),e.j41(34,"option",83),e.EFF(35,"Other Income"),e.k0s()()(),e.j41(36,"div",51)(37,"label",33),e.EFF(38,"Description *"),e.k0s(),e.nrm(39,"input",103),e.k0s(),e.j41(40,"div",51)(41,"label",33),e.EFF(42,"Amount *"),e.k0s(),e.nrm(43,"input",104),e.k0s()(),e.DNE(44,J,5,0,"div",15),e.k0s()()}if(2&o){let t;const n=a.$implicit,r=a.index;e.R7$(3),e.SpI("Income Source ",r+1,""),e.R7$(3),e.Y8G("formGroup",n),e.R7$(38),e.Y8G("ngIf","w2"===(null==(t=n.get("type"))?null:t.value))}}function K(o,a){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"div",64)(2,"h5",65),e.EFF(3,"\u{1f4bc} Section C. Income"),e.k0s(),e.j41(4,"button",90),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.addIncomeSource())}),e.nrm(5,"i",67),e.EFF(6,"Add Income Source "),e.k0s()(),e.DNE(7,H,4,0,"div",68)(8,Q,45,3,"div",69),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",0===t.incomeArray.length),e.R7$(),e.Y8G("ngForOf",t.incomeArray.controls)}}function W(o,a){1&o&&(e.j41(0,"div",124),e.nrm(1,"input",125),e.k0s())}function Z(o,a){1&o&&(e.j41(0,"div",124),e.nrm(1,"input",126),e.k0s())}function ee(o,a){1&o&&(e.j41(0,"div",124),e.nrm(1,"input",127),e.k0s())}function te(o,a){if(1&o&&(e.j41(0,"div")(1,"h5",30),e.EFF(2,"\u{1f4b8} Section D. Deductions & Adjustments"),e.k0s(),e.j41(3,"div",106)(4,"div",1)(5,"div",32)(6,"div",85),e.nrm(7,"input",107),e.j41(8,"label",108),e.EFF(9,"Mortgage Interest Paid"),e.k0s()(),e.DNE(10,W,2,0,"div",109),e.k0s(),e.j41(11,"div",32)(12,"div",85),e.nrm(13,"input",110),e.j41(14,"label",111),e.EFF(15,"Property Taxes Paid"),e.k0s()(),e.DNE(16,Z,2,0,"div",109),e.k0s()(),e.j41(17,"div",1)(18,"div",32)(19,"label",33),e.EFF(20,"Charitable Contributions (Cash)"),e.k0s(),e.nrm(21,"input",112),e.k0s(),e.j41(22,"div",32)(23,"label",33),e.EFF(24,"Charitable Contributions (Non-Cash)"),e.k0s(),e.nrm(25,"input",113),e.k0s()(),e.j41(26,"div",1)(27,"div",32)(28,"div",85),e.nrm(29,"input",114),e.j41(30,"label",115),e.EFF(31,"Student Loan Interest Paid"),e.k0s()(),e.DNE(32,ee,2,0,"div",109),e.k0s(),e.j41(33,"div",32)(34,"label",33),e.EFF(35,"IRA/401(k) Contributions"),e.k0s(),e.nrm(36,"input",116),e.k0s()(),e.j41(37,"div",1)(38,"div",32)(39,"label",33),e.EFF(40,"IRA Type"),e.k0s(),e.j41(41,"select",117)(42,"option",42),e.EFF(43,"Select Type"),e.k0s(),e.j41(44,"option",118),e.EFF(45,"Traditional IRA"),e.k0s(),e.j41(46,"option",119),e.EFF(47,"Roth IRA"),e.k0s(),e.j41(48,"option",120),e.EFF(49,"401(k)"),e.k0s(),e.j41(50,"option",121),e.EFF(51,"403(b)"),e.k0s()()(),e.j41(52,"div",32)(53,"label",33),e.EFF(54,"Medical Expenses (Out-of-Pocket)"),e.k0s(),e.nrm(55,"input",122),e.k0s()(),e.j41(56,"div",58)(57,"label",33),e.EFF(58,"Other Adjustments"),e.k0s(),e.nrm(59,"textarea",123),e.k0s()()()),2&o){let t,n,r;const s=e.XpG(2);e.R7$(10),e.Y8G("ngIf",null==(t=s.intakeForm.get("deductionsAdjustments.mortgageInterest"))?null:t.value),e.R7$(6),e.Y8G("ngIf",null==(n=s.intakeForm.get("deductionsAdjustments.propertyTaxes"))?null:n.value),e.R7$(16),e.Y8G("ngIf",null==(r=s.intakeForm.get("deductionsAdjustments.studentLoanInterest"))?null:r.value)}}function ne(o,a){1&o&&(e.j41(0,"div")(1,"h5",30),e.EFF(2,"\u{1f3e5} Section E. Health Coverage"),e.k0s(),e.j41(3,"div",128)(4,"div",30)(5,"label",33),e.EFF(6,"Did you have health insurance all year? *"),e.k0s(),e.j41(7,"div",85),e.nrm(8,"input",129),e.j41(9,"label",130),e.EFF(10,"Yes"),e.k0s()(),e.j41(11,"div",85),e.nrm(12,"input",131),e.j41(13,"label",132),e.EFF(14,"No"),e.k0s()()(),e.j41(15,"div",1)(16,"div",51)(17,"div",85),e.nrm(18,"input",133),e.j41(19,"label",134),e.EFF(20,"Marketplace Coverage"),e.k0s()()(),e.j41(21,"div",51)(22,"div",85),e.nrm(23,"input",135),e.j41(24,"label",136),e.EFF(25,"Employer Coverage"),e.k0s()()()(),e.j41(26,"div",1)(27,"div",51)(28,"div",85),e.nrm(29,"input",137),e.j41(30,"label",138),e.EFF(31,"Form 1095-A (Marketplace)"),e.k0s()()(),e.j41(32,"div",51)(33,"div",85),e.nrm(34,"input",139),e.j41(35,"label",140),e.EFF(36,"Form 1095-B"),e.k0s()()(),e.j41(37,"div",51)(38,"div",85),e.nrm(39,"input",141),e.j41(40,"label",142),e.EFF(41,"Form 1095-C"),e.k0s()()()()()()),2&o&&(e.R7$(8),e.Y8G("value",!0),e.R7$(4),e.Y8G("value",!1))}function oe(o,a){1&o&&(e.j41(0,"div",1)(1,"div",32)(2,"label",33),e.EFF(3,"Care Provider Name"),e.k0s(),e.nrm(4,"input",151),e.k0s(),e.j41(5,"div",32)(6,"label",33),e.EFF(7,"Care Provider EIN/SSN"),e.k0s(),e.nrm(8,"input",152),e.k0s()())}function re(o,a){if(1&o&&(e.j41(0,"div")(1,"h5",30),e.EFF(2,"\u{1f393} Section F. Credits"),e.k0s(),e.j41(3,"div",143)(4,"div",1)(5,"div",32)(6,"label",33),e.EFF(7,"Education Expenses"),e.k0s(),e.nrm(8,"input",144),e.k0s(),e.j41(9,"div",32)(10,"div",145),e.nrm(11,"input",146),e.j41(12,"label",147),e.EFF(13,"Have Form 1098-T (Tuition Statement)"),e.k0s()()()(),e.j41(14,"div",1)(15,"div",32)(16,"label",33),e.EFF(17,"Child & Dependent Care Expenses"),e.k0s(),e.nrm(18,"input",148),e.k0s()(),e.DNE(19,oe,9,0,"div",15),e.j41(20,"div",1)(21,"div",32)(22,"label",33),e.EFF(23,"Adoption Expenses"),e.k0s(),e.nrm(24,"input",149),e.k0s(),e.j41(25,"div",32)(26,"label",33),e.EFF(27,"Energy-Efficient Home Upgrades"),e.k0s(),e.nrm(28,"input",150),e.k0s()()()()),2&o){let t;const n=e.XpG(2);e.R7$(19),e.Y8G("ngIf",(null==(t=n.intakeForm.get("credits.childCareExpenses"))?null:t.value)>0)}}function ie(o,a){1&o&&(e.j41(0,"div")(1,"h5",30),e.EFF(2,"\u{1f4c2} Section G. Prior Year & IRS Notices"),e.k0s(),e.j41(3,"div",153)(4,"div",30)(5,"label",33),e.EFF(6,"Did you file taxes last year?"),e.k0s(),e.j41(7,"div",85),e.nrm(8,"input",154),e.j41(9,"label",155),e.EFF(10,"Yes"),e.k0s()(),e.j41(11,"div",85),e.nrm(12,"input",156),e.j41(13,"label",157),e.EFF(14,"No"),e.k0s()()(),e.j41(15,"div",30)(16,"div",85),e.nrm(17,"input",158),e.j41(18,"label",159),e.EFF(19,"Received IRS or State Notices"),e.k0s()()(),e.j41(20,"div",58)(21,"label",33),e.EFF(22,"Other Notes or Questions"),e.k0s(),e.nrm(23,"textarea",160),e.k0s()()()),2&o&&(e.R7$(8),e.Y8G("value",!0),e.R7$(4),e.Y8G("value",!1))}function se(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",161),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.submitForm())}),e.nrm(1,"i",162),e.EFF(2,"Submit Form "),e.k0s()}if(2&o){const t=e.XpG(2);e.Y8G("disabled",!t.intakeForm.valid||t.isLoading)}}function ae(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",163),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.nextSection())}),e.EFF(1," Next"),e.nrm(2,"i",164),e.k0s()}}function ce(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"form",21),e.DNE(5,B,83,4,"div",22)(6,q,9,2,"div",22)(7,K,9,2,"div",22)(8,te,60,3,"div",22)(9,ne,42,2,"div",22)(10,re,29,1,"div",22)(11,ie,24,2,"div",22),e.j41(12,"div",23)(13,"button",24),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.previousSection())}),e.nrm(14,"i",25),e.EFF(15,"Previous "),e.k0s(),e.j41(16,"div")(17,"button",26),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.autoSave())}),e.nrm(18,"i",27),e.EFF(19,"Save Draft "),e.k0s(),e.DNE(20,se,3,1,"button",28)(21,ae,3,0,"button",29),e.k0s()()()()()()()}if(2&o){const t=e.XpG();e.R7$(4),e.Y8G("formGroup",t.intakeForm),e.R7$(),e.Y8G("ngIf",0===t.currentSection),e.R7$(),e.Y8G("ngIf",1===t.currentSection),e.R7$(),e.Y8G("ngIf",2===t.currentSection),e.R7$(),e.Y8G("ngIf",3===t.currentSection),e.R7$(),e.Y8G("ngIf",4===t.currentSection),e.R7$(),e.Y8G("ngIf",5===t.currentSection),e.R7$(),e.Y8G("ngIf",6===t.currentSection),e.R7$(2),e.Y8G("disabled",0===t.currentSection),e.R7$(4),e.Y8G("disabled",t.isSaving),e.R7$(3),e.Y8G("ngIf",t.currentSection===t.sections.length-1),e.R7$(),e.Y8G("ngIf",t.currentSection<t.sections.length-1)}}function le(o,a){1&o&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",165)(4,"div",166)(5,"span",12),e.EFF(6,"Loading..."),e.k0s()(),e.j41(7,"p",167),e.EFF(8,"Loading your intake form..."),e.k0s()()()()())}let de=(()=>{class o{constructor(t,n){this.fb=t,this.intakeService=n,this.destroy$=new j.B,this.currentSection=0,this.progress=0,this.isLoading=!1,this.isSaving=!1,this.clientId=1,this.ssnMasked={},this.sections=[{id:0,title:"Personal Information",description:"Basic personal and contact information",icon:"ri-user-line",completed:!1,required:!0},{id:1,title:"Dependents",description:"Information about dependents and children",icon:"ri-group-line",completed:!1,required:!1},{id:2,title:"Income",description:"All sources of income for the tax year",icon:"ri-money-dollar-circle-line",completed:!1,required:!0},{id:3,title:"Deductions & Adjustments",description:"Itemized deductions and income adjustments",icon:"ri-calculator-line",completed:!1,required:!1},{id:4,title:"Health Coverage",description:"Health insurance coverage information",icon:"ri-heart-pulse-line",completed:!1,required:!0},{id:5,title:"Credits",description:"Tax credits and education expenses",icon:"ri-award-line",completed:!1,required:!1},{id:6,title:"Prior Year & IRS Notices",description:"Previous year information and IRS correspondence",icon:"ri-file-text-line",completed:!1,required:!1}],this.initializeForm()}ngOnInit(){this.loadExistingData(),this.setupAutoSave()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.intakeForm=this.fb.group({personalInformation:this.fb.group({fullName:["",i.k0.required],dateOfBirth:["",i.k0.required],ssn:["",[i.k0.required,i.k0.pattern(/^\d{3}-\d{2}-\d{4}$/)]],maritalStatus:["",i.k0.required],spouseName:[""],spouseSsn:[""],address:this.fb.group({street:["",i.k0.required],city:["",i.k0.required],state:["",i.k0.required],zipCode:["",[i.k0.required,i.k0.pattern(/^\d{5}(-\d{4})?$/)]]}),phone:["",[i.k0.required,i.k0.pattern(/^\(\d{3}\) \d{3}-\d{4}$/)]],email:["",[i.k0.required,i.k0.email]],driverLicense:this.fb.group({number:[""],state:[""],expiration:[""]})}),dependents:this.fb.array([]),incomeSource:this.fb.array([]),deductionsAdjustments:this.fb.group({mortgageInterest:[!1],mortgageAmount:[0],propertyTaxes:[!1],propertyTaxAmount:[0],charitableCash:[0],charitableNonCash:[0],studentLoanInterest:[!1],studentLoanAmount:[0],iraContributions:[0],iraType:[""],medicalExpenses:[0],otherAdjustments:[""]}),healthCoverage:this.fb.group({hadInsuranceAllYear:[null,i.k0.required],marketplaceCoverage:[!1],employerCoverage:[!1],form1095A:[!1],form1095B:[!1],form1095C:[!1]}),credits:this.fb.group({educationExpenses:[0],tuition1098T:[!1],childCareExpenses:[0],childCareProviderName:[""],childCareProviderEin:[""],adoptionExpenses:[0],energyEfficiencyUpgrades:[0]}),priorYearInfo:this.fb.group({filedLastYear:[null],estimatedTaxPayments:this.fb.array([]),irsNotices:[!1],otherNotes:[""]})})}loadExistingData(){this.isLoading=!0,this.intakeService.getClientIntakeForm(this.clientId).pipe((0,u.Q)(this.destroy$)).subscribe({next:t=>{t&&(this.populateForm(t),this.currentSection=t.currentSection||0,this.updateProgress()),this.isLoading=!1},error:t=>{console.error("Error loading intake form:",t),this.isLoading=!1}})}populateForm(t){if(t.personalInformation&&this.intakeForm.get("personalInformation")?.patchValue(t.personalInformation),t.dependents&&t.dependents.length>0){const n=this.intakeForm.get("dependents");t.dependents.forEach(r=>{n.push(this.createDependentGroup(r))})}if(t.incomeSource&&t.incomeSource.length>0){const n=this.intakeForm.get("incomeSource");t.incomeSource.forEach(r=>{n.push(this.createIncomeGroup(r))})}t.deductionsAdjustments&&this.intakeForm.get("deductionsAdjustments")?.patchValue(t.deductionsAdjustments),t.healthCoverage&&this.intakeForm.get("healthCoverage")?.patchValue(t.healthCoverage),t.credits&&this.intakeForm.get("credits")?.patchValue(t.credits),t.priorYearInfo&&this.intakeForm.get("priorYearInfo")?.patchValue(t.priorYearInfo)}setupAutoSave(){this.intakeForm.valueChanges.pipe((0,M.B)(2e3),(0,E.F)(),(0,u.Q)(this.destroy$)).subscribe(()=>{this.autoSave()})}autoSave(){if(this.intakeForm.valid&&!this.isSaving){this.isSaving=!0;const t=this.prepareFormData();this.intakeService.autoSaveForm(this.clientId,t).pipe((0,u.Q)(this.destroy$)).subscribe({next:()=>{this.isSaving=!1,this.updateProgress()},error:n=>{console.error("Auto-save failed:",n),this.isSaving=!1}})}}prepareFormData(){const t=this.intakeForm.value;return{clientId:this.clientId,personalInformation:t.personalInformation,dependents:t.dependents,incomeSource:t.incomeSource,deductionsAdjustments:t.deductionsAdjustments,healthCoverage:t.healthCoverage,credits:t.credits,priorYearInfo:t.priorYearInfo,currentSection:this.currentSection,progress:this.progress,lastSaved:(new Date).toISOString(),status:"draft"}}updateProgress(){const t=this.prepareFormData();this.progress=this.intakeService.calculateProgress(t),this.sections.forEach((n,r)=>{n.completed=this.isSectionCompleted(r)})}isSectionCompleted(t){const n=this.intakeForm.value;switch(t){case 0:const r=n.personalInformation;return!!(r?.fullName&&r?.ssn&&r?.address?.street);case 1:case 3:case 5:return!0;case 2:return n.incomeSource&&n.incomeSource.length>0;case 4:return null!==n.healthCoverage?.hadInsuranceAllYear;case 6:return null!==n.priorYearInfo?.filedLastYear;default:return!1}}goToSection(t){this.currentSection=t}nextSection(){this.currentSection<this.sections.length-1&&this.currentSection++}previousSection(){this.currentSection>0&&this.currentSection--}get dependentsArray(){return this.intakeForm.get("dependents")}get incomeArray(){return this.intakeForm.get("incomeSource")}createDependentGroup(t){return this.fb.group({id:[t?.id||this.intakeService.generateId()],name:[t?.name||"",i.k0.required],ssn:[t?.ssn||"",[i.k0.required,i.k0.pattern(/^\d{3}-\d{2}-\d{4}$/)]],dateOfBirth:[t?.dateOfBirth||"",i.k0.required],relationship:[t?.relationship||"",i.k0.required],monthsLivedWithYou:[t?.monthsLivedWithYou||12,[i.k0.min(1),i.k0.max(12)]],fullYear:[void 0===t?.fullYear||t.fullYear],childCareExpenses:[t?.childCareExpenses||!1],childCareAmount:[t?.childCareAmount||0]})}createIncomeGroup(t){return this.fb.group({id:[t?.id||this.intakeService.generateId()],type:[t?.type||"",i.k0.required],description:[t?.description||"",i.k0.required],amount:[t?.amount||0,[i.k0.required,i.k0.min(0)]],employerName:[t?.employerName||""],details:[t?.details||{}]})}addDependent(){this.dependentsArray.push(this.createDependentGroup())}removeDependent(t){this.dependentsArray.removeAt(t)}addIncomeSource(){this.incomeArray.push(this.createIncomeGroup())}removeIncomeSource(t){this.incomeArray.removeAt(t)}toggleSSNMask(t){this.ssnMasked[t]=!this.ssnMasked[t]}isSSNMasked(t){return!1!==this.ssnMasked[t]}getDisplaySSN(t,n){return this.isSSNMasked(n)?this.intakeService.maskSSN(t):t}formatSSNInput(t,n){const s=this.intakeService.formatSSN(t.target.value);this.intakeForm.get(n)?.setValue(s)}submitForm(){this.intakeForm.valid?p().fire({title:"Submit Intake Form",text:"Are you sure you want to submit your tax intake form? You won't be able to make changes after submission.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Submit"}).then(t=>{t.isConfirmed&&this.performSubmit()}):p().fire({title:"Form Incomplete",text:"Please complete all required sections before submitting.",icon:"warning"})}performSubmit(){this.isLoading=!0;const t=this.prepareFormData();t.status="submitted",t.submittedAt=(new Date).toISOString(),this.intakeService.submitIntakeForm(this.clientId,t).pipe((0,u.Q)(this.destroy$)).subscribe({next:()=>{this.isLoading=!1,p().fire({title:"Success!",text:"Your tax intake form has been submitted successfully.",icon:"success"})},error:n=>{this.isLoading=!1,p().fire({title:"Error",text:"There was an error submitting your form. Please try again.",icon:"error"}),console.error("Submit error:",n)}})}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(i.ok),e.rXU(P))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-tax-intake"]],decls:20,vars:10,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],["class","badge bg-info me-2",4,"ngIf"],[1,"text-muted"],[1,"progress","mb-3",2,"height","12px"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-info"],[1,"visually-hidden"],[1,"d-flex","flex-wrap","gap-2"],["type","button","class","btn btn-sm",3,"btn-success","btn-primary","btn-outline-secondary","click",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"badge","bg-info","me-2"],["type","button",1,"btn","btn-sm",3,"click"],[1,"me-1"],["class","ri-check-line ms-1",4,"ngIf"],[1,"ri-check-line","ms-1"],[3,"formGroup"],[4,"ngIf"],[1,"d-flex","justify-content-between","mt-4"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"ri-arrow-left-line","me-1"],["type","button",1,"btn","btn-info","me-2",3,"click","disabled"],[1,"ri-save-line","me-1"],["type","button","class","btn btn-success",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-info",3,"click",4,"ngIf"],[1,"mb-4"],["formGroupName","personalInformation"],[1,"col-md-6","mb-3"],[1,"form-label"],["type","text","formControlName","fullName",1,"form-control"],["type","date","formControlName","dateOfBirth",1,"form-control"],[1,"input-group"],["type","text","placeholder","***-**-****",1,"form-control",3,"input","value"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["class","ri-eye-line",4,"ngIf"],["class","ri-eye-off-line",4,"ngIf"],["formControlName","maritalStatus",1,"form-select"],["value",""],["value","single"],["value","married-jointly"],["value","married-separately"],["value","head-of-household"],["value","qualifying-widower"],["formGroupName","address"],[1,"col-12","mb-3"],["type","text","formControlName","street",1,"form-control"],[1,"col-md-4","mb-3"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","state",1,"form-control"],["type","text","formControlName","zipCode",1,"form-control"],["type","tel","formControlName","phone","placeholder","(555) 123-4567",1,"form-control"],["type","email","formControlName","email",1,"form-control"],["formGroupName","driverLicense"],[1,"mb-3"],["type","text","formControlName","number",1,"form-control"],["type","date","formControlName","expiration",1,"form-control"],[1,"ri-eye-line"],[1,"ri-eye-off-line"],["type","text","formControlName","spouseName",1,"form-control"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-0"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"ri-add-line","me-1"],["class","text-center text-muted py-4",4,"ngIf"],["class","card mb-3",4,"ngFor","ngForOf"],[1,"text-center","text-muted","py-4"],[1,"ri-group-line","font-size-48","mb-3","d-block"],[1,"card","mb-3"],[1,"card-header","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"ri-delete-bin-line"],[1,"card-body",3,"formGroup"],["type","text","formControlName","name",1,"form-control"],["formControlName","relationship",1,"form-select"],["value","son"],["value","daughter"],["value","stepchild"],["value","grandchild"],["value","other"],["type","number","formControlName","monthsLivedWithYou","min","1","max","12",1,"form-control"],[1,"form-check"],["type","checkbox","formControlName","fullYear",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],["type","checkbox","formControlName","childCareExpenses",1,"form-check-input",3,"id"],["type","number","formControlName","childCareAmount","min","0",1,"form-control"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"ri-money-dollar-circle-line","font-size-48","mb-3","d-block"],["formControlName","type",1,"form-select"],["value","w2"],["value","1099-nec"],["value","1099-misc"],["value","1099-int"],["value","1099-div"],["value","1099-b"],["value","1099-r"],["value","ssa-1099"],["value","rental"],["value","business"],["type","text","formControlName","description","placeholder","e.g., ABC Company, Rental Property",1,"form-control"],["type","number","formControlName","amount","min","0","step","0.01",1,"form-control"],["type","text","formControlName","employerName",1,"form-control"],["formGroupName","deductionsAdjustments"],["type","checkbox","formControlName","mortgageInterest","id","mortgageInterest",1,"form-check-input"],["for","mortgageInterest",1,"form-check-label"],["class","mt-2",4,"ngIf"],["type","checkbox","formControlName","propertyTaxes","id","propertyTaxes",1,"form-check-input"],["for","propertyTaxes",1,"form-check-label"],["type","number","formControlName","charitableCash","min","0",1,"form-control"],["type","number","formControlName","charitableNonCash","min","0",1,"form-control"],["type","checkbox","formControlName","studentLoanInterest","id","studentLoanInterest",1,"form-check-input"],["for","studentLoanInterest",1,"form-check-label"],["type","number","formControlName","iraContributions","min","0",1,"form-control"],["formControlName","iraType",1,"form-select"],["value","traditional"],["value","roth"],["value","401k"],["value","403b"],["type","number","formControlName","medicalExpenses","min","0",1,"form-control"],["formControlName","otherAdjustments","rows","3","placeholder","Describe any other deductions or adjustments",1,"form-control"],[1,"mt-2"],["type","number","formControlName","mortgageAmount","placeholder","Amount","min","0",1,"form-control"],["type","number","formControlName","propertyTaxAmount","placeholder","Amount","min","0",1,"form-control"],["type","number","formControlName","studentLoanAmount","placeholder","Amount","min","0",1,"form-control"],["formGroupName","healthCoverage"],["type","radio","formControlName","hadInsuranceAllYear","id","insurance_yes",1,"form-check-input",3,"value"],["for","insurance_yes",1,"form-check-label"],["type","radio","formControlName","hadInsuranceAllYear","id","insurance_no",1,"form-check-input",3,"value"],["for","insurance_no",1,"form-check-label"],["type","checkbox","formControlName","marketplaceCoverage","id","marketplace",1,"form-check-input"],["for","marketplace",1,"form-check-label"],["type","checkbox","formControlName","employerCoverage","id","employer",1,"form-check-input"],["for","employer",1,"form-check-label"],["type","checkbox","formControlName","form1095A","id","form1095A",1,"form-check-input"],["for","form1095A",1,"form-check-label"],["type","checkbox","formControlName","form1095B","id","form1095B",1,"form-check-input"],["for","form1095B",1,"form-check-label"],["type","checkbox","formControlName","form1095C","id","form1095C",1,"form-check-input"],["for","form1095C",1,"form-check-label"],["formGroupName","credits"],["type","number","formControlName","educationExpenses","min","0",1,"form-control"],[1,"form-check","mt-4"],["type","checkbox","formControlName","tuition1098T","id","tuition1098T",1,"form-check-input"],["for","tuition1098T",1,"form-check-label"],["type","number","formControlName","childCareExpenses","min","0",1,"form-control"],["type","number","formControlName","adoptionExpenses","min","0",1,"form-control"],["type","number","formControlName","energyEfficiencyUpgrades","min","0",1,"form-control"],["type","text","formControlName","childCareProviderName",1,"form-control"],["type","text","formControlName","childCareProviderEin",1,"form-control"],["formGroupName","priorYearInfo"],["type","radio","formControlName","filedLastYear","id","filed_yes",1,"form-check-input",3,"value"],["for","filed_yes",1,"form-check-label"],["type","radio","formControlName","filedLastYear","id","filed_no",1,"form-check-input",3,"value"],["for","filed_no",1,"form-check-label"],["type","checkbox","formControlName","irsNotices","id","irsNotices",1,"form-check-input"],["for","irsNotices",1,"form-check-label"],["formControlName","otherNotes","rows","4","placeholder","Any additional information, questions, or special circumstances you'd like your accountant to know about",1,"form-control"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"ri-send-plane-line","me-1"],["type","button",1,"btn","btn-info",3,"click"],[1,"ri-arrow-right-line","ms-1"],[1,"card-body","text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"mt-3","text-muted"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),e.EFF(7,"\u{1f4c4} Client Tax Intake Form"),e.k0s(),e.j41(8,"div",7),e.DNE(9,D,2,0,"span",8),e.j41(10,"span",9),e.EFF(11),e.k0s()()(),e.j41(12,"div",10)(13,"div",11)(14,"span",12),e.EFF(15),e.k0s()()(),e.j41(16,"div",13),e.DNE(17,w,4,10,"button",14),e.k0s()()()()(),e.DNE(18,ce,22,12,"div",15)(19,le,9,0,"div",15),e.k0s()),2&n&&(e.R7$(9),e.Y8G("ngIf",r.isSaving),e.R7$(2),e.Lme("Step ",r.currentSection+1," of ",r.sections.length,""),e.R7$(2),e.xc7("width",r.progress,"%"),e.BMQ("aria-valuenow",r.progress),e.R7$(2),e.SpI("",r.progress,"% Complete"),e.R7$(2),e.Y8G("ngForOf",r.sections),e.R7$(),e.Y8G("ngIf",!r.isLoading),e.R7$(),e.Y8G("ngIf",r.isLoading))},dependencies:[d.Sq,d.bT,i.qT,i.xH,i.y7,i.me,i.Q0,i.Zm,i.wz,i.Fm,i.BC,i.cb,i.VZ,i.zX,i.j4,i.JD,i.$R],styles:['.progress[_ngcontent-%COMP%]{background-color:#e9ecef;border-radius:8px;height:12px!important}.progress-bar[_ngcontent-%COMP%]{background-color:#17a2b8!important;border-radius:8px;transition:width .6s ease}.progress-bar.bg-info[_ngcontent-%COMP%]{background-color:#17a2b8!important}.btn-sm[_ngcontent-%COMP%]{font-size:.875rem;padding:.375rem .75rem;border-radius:6px}.btn-sm.btn-success[_ngcontent-%COMP%]{background-color:#28a745;border-color:#28a745}.btn-sm.btn-success[_ngcontent-%COMP%]:hover{background-color:#218838;border-color:#1e7e34}.btn-sm.btn-primary[_ngcontent-%COMP%]{background-color:#405189;border-color:#405189}.btn-sm.btn-primary[_ngcontent-%COMP%]:hover{background-color:#364574;border-color:#2f3d66}.card[_ngcontent-%COMP%]{border:1px solid #e9ecef;border-radius:8px;box-shadow:0 .125rem .25rem #00000013}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:1rem 1.25rem}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#495057;font-weight:600}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:6px;padding:.5rem .75rem;font-size:.875rem}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#405189;box-shadow:0 0 0 .2rem #40518940}.form-control.is-invalid[_ngcontent-%COMP%], .form-select.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.form-control.is-invalid[_ngcontent-%COMP%]:focus, .form-select.is-invalid[_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{border-color:#ced4da;color:#6c757d}.input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#adb5bd;color:#495057}.input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #6c757d40}.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:checked{background-color:#405189;border-color:#405189}.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:focus{border-color:#405189;box-shadow:0 0 0 .2rem #40518940}.form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.font-size-48[_ngcontent-%COMP%]{font-size:3rem!important}.badge.bg-info[_ngcontent-%COMP%]{background-color:#17a2b8!important}.btn-outline-danger[_ngcontent-%COMP%]{color:#dc3545;border-color:#dc3545}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545;color:#fff}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}h5[_ngcontent-%COMP%]{color:#405189;font-weight:600;margin-bottom:1.5rem}h6[_ngcontent-%COMP%]{color:#495057;font-weight:600}@media (max-width: 768px){.d-flex.flex-wrap.gap-2[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:.75rem}.d-flex.flex-wrap.gap-2[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}.card-body[_ngcontent-%COMP%]{padding:1rem}.container-fluid[_ngcontent-%COMP%]{padding-left:.75rem;padding-right:.75rem}}.card-body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.form-label[_ngcontent-%COMP%]:after{content:""}.form-label[_ngcontent-%COMP%]:has( + input[required])[_ngcontent-%COMP%]:after, .form-label[_ngcontent-%COMP%]:has( + select[required])[_ngcontent-%COMP%]:after, .form-label[_ngcontent-%COMP%]:has( + textarea[required])[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.input-group[_ngcontent-%COMP%]   .form-control[placeholder*="***"][_ngcontent-%COMP%]{font-family:monospace;letter-spacing:1px}.progress[_ngcontent-%COMP%]{position:relative}.progress[_ngcontent-%COMP%]:after{content:attr(data-progress) "%";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:.75rem;font-weight:600;color:#495057}']})}}return o})();var me=l(5538);const ue=["messagesContainer"];function pe(o,a){if(1&o&&(e.j41(0,"div",17)(1,"span",18),e.EFF(2),e.k0s()()),2&o){const t=e.XpG().$implicit,n=e.XpG();e.R7$(2),e.JRh(n.formatDate(t.timestamp))}}function fe(o,a){1&o&&e.nrm(0,"i",53)}function ge(o,a){1&o&&e.nrm(0,"i",54)}function he(o,a){if(1&o&&(e.j41(0,"div",49)(1,"div",50),e.DNE(2,fe,1,0,"i",51)(3,ge,1,0,"i",52),e.k0s()()),2&o){const t=e.XpG().$implicit,n=e.XpG();e.R7$(),e.AVh("bg-primary","ACCOUNTANT"===t.senderType)("bg-gradient-ai",n.isAIMessage(t)),e.R7$(),e.Y8G("ngIf","ACCOUNTANT"===t.senderType),e.R7$(),e.Y8G("ngIf",n.isAIMessage(t))}}function be(o,a){if(1&o&&(e.j41(0,"div",55),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.senderName)}}function _e(o,a){1&o&&(e.j41(0,"div",56)(1,"button",57),e.nrm(2,"i",58),e.k0s()())}function ve(o,a){if(1&o&&(e.j41(0,"div",40),e.DNE(1,pe,3,1,"div",41),e.j41(2,"div",42),e.DNE(3,he,4,6,"div",43),e.j41(4,"div",44),e.DNE(5,be,2,1,"div",45),e.j41(6,"div",46),e.EFF(7),e.k0s(),e.j41(8,"div",47),e.EFF(9),e.k0s()(),e.DNE(10,_e,3,0,"div",48),e.k0s()()),2&o){const t=a.$implicit,n=a.index,r=e.XpG();e.R7$(),e.Y8G("ngIf",r.shouldShowDateSeparator(n)),e.R7$(),e.AVh("message-sent",r.isMyMessage(t))("message-received",!r.isMyMessage(t)),e.R7$(),e.Y8G("ngIf",!r.isMyMessage(t)),e.R7$(),e.AVh("bubble-sent",r.isMyMessage(t))("bubble-received","ACCOUNTANT"===t.senderType)("bubble-ai",r.isAIMessage(t)),e.R7$(),e.Y8G("ngIf",!r.isMyMessage(t)),e.R7$(2),e.JRh(t.content),e.R7$(2),e.JRh(r.formatTime(t.timestamp)),e.R7$(),e.Y8G("ngIf",!r.isMyMessage(t))}}function ke(o,a){1&o&&(e.j41(0,"div",59)(1,"div",60)(2,"span",61),e.EFF(3,"Loading..."),e.k0s()(),e.j41(4,"small",62),e.EFF(5,"Loading messages..."),e.k0s()())}const Fe=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>l.e(796).then(l.bind(l,8796)).then(o=>o.ClientDashboardComponent)},{path:"documents",component:_},{path:"intake",component:I},{path:"tax-intake",component:de},{path:"chat",component:(()=>{class o{constructor(t){this.chatService=t,this.messages=[],this.newMessage="",this.currentThread=null,this.isLoading=!1,this.subscriptions=[],this.currentUser=this.chatService.getCurrentUser()}ngOnInit(){this.loadMessages()}ngAfterViewChecked(){this.scrollToBottom()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadMessages(){this.isLoading=!0;const t=this.currentUser?.id||1,n=this.loadMessagesFromStorage(t);if(n.length>0)return this.messages=n,void(this.isLoading=!1);const r=this.chatService.getThread(t).subscribe({next:s=>{this.currentThread=s.thread,this.messages=s.messages,this.saveMessagesToStorage(t,this.messages),this.isLoading=!1},error:s=>{console.error("Error loading messages:",s),this.isLoading=!1,this.loadMockMessages(),this.saveMessagesToStorage(t,this.messages)}});this.subscriptions.push(r)}loadMockMessages(){this.messages=[{content:"Hello! Welcome to our chat system. How can I help you today?",senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date("2024-02-10T09:00:00"),threadId:1},{content:"Hi Sarah! I have a question about my quarterly tax payments.",senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date("2024-02-10T09:15:00"),threadId:1},{content:"Of course! I'd be happy to help with your quarterly payments. What specific question do you have?",senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date("2024-02-10T09:16:00"),threadId:1}]}loadMessagesFromStorage(t){try{const n=`chat_messages_client_${t}`,r=localStorage.getItem(n);if(r)return JSON.parse(r).map(c=>({...c,timestamp:new Date(c.timestamp)}))}catch(n){console.error("Error loading messages from storage:",n)}return[]}saveMessagesToStorage(t,n){try{const r=`chat_messages_client_${t}`;localStorage.setItem(r,JSON.stringify(n))}catch(r){console.error("Error saving messages to storage:",r)}}sendMessage(){if(this.newMessage.trim()&&this.currentThread){const t={content:this.newMessage.trim(),senderType:"CLIENT"},n=this.currentUser?.id||1,r=this.chatService.sendMessage(n,t).subscribe({next:s=>{const c={content:this.newMessage,senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(c),this.saveMessagesToStorage(n,this.messages),this.newMessage="",c.content.toLowerCase().includes("@ai")&&this.handleAIResponse(c.content)},error:s=>{console.error("Error sending message:",s);const c={content:this.newMessage,senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(c),this.saveMessagesToStorage(n,this.messages),this.newMessage="",c.content.toLowerCase().includes("@ai")&&this.handleAIResponse(c.content)}});this.subscriptions.push(r)}}addLocalMessage(){const t={content:this.newMessage.trim(),senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(t),this.newMessage="",setTimeout(()=>{this.simulateAccountantResponse()},2e3)}simulateAccountantResponse(){const t=["Thank you for your message. I'll review this and get back to you shortly.","I understand your concern. Let me look into this for you.","That's a great question. I'll need to check a few things and respond within the hour.","I've received your message and will provide a detailed response soon."],r={content:t[Math.floor(Math.random()*t.length)],senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(r),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages)}handleAIResponse(t){setTimeout(()=>{const n=["I understand you're asking about tax matters. Based on current tax regulations, here's what I can tell you: For quarterly payments, you should calculate 25% of your expected annual tax liability and submit by the quarterly deadlines.","That's a great tax question! Here's some guidance: Business expenses must be ordinary and necessary for your trade or business. Keep detailed records and receipts for all deductions.","I can help with that tax inquiry. Here's what you should know: The standard deduction for 2024 is $14,600 for single filers and $29,200 for married filing jointly.","Thank you for your tax question. Here's some helpful information: Self-employment tax is 15.3% of your net self-employment earnings, covering Social Security and Medicare taxes."],s={content:n[Math.floor(Math.random()*n.length)],senderId:0,senderName:"Tax AI Agent",senderType:"AI_AGENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(s),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages),this.scrollToBottom()},1500)}triggerAIResponse(t){const n=this.chatService.getAIResponse(t).subscribe({next:r=>{this.messages.push({content:r.message,senderId:0,senderName:"Tax AI Agent",senderType:"AI_AGENT",timestamp:new Date,threadId:this.currentThread?.id||1}),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages),this.scrollToBottom()},error:r=>{console.error("Error getting AI response:",r),this.handleAIResponse(t)}});this.subscriptions.push(n)}onKeyPress(t){"Enter"===t.key&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())}scrollToBottom(){try{this.messagesContainer&&(this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight)}catch(t){console.error("Error scrolling to bottom:",t)}}formatTime(t){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(t)}formatDate(t){const n=new Date,r=new Date(t);if(r.toDateString()===n.toDateString())return"Today";const s=new Date(n);return s.setDate(s.getDate()-1),r.toDateString()===s.toDateString()?"Yesterday":r.toLocaleDateString()}shouldShowDateSeparator(t){if(0===t)return!0;const r=this.messages[t-1];return this.messages[t].timestamp.toDateString()!==r.timestamp.toDateString()}isMyMessage(t){return"CLIENT"===t.senderType&&t.senderId===this.currentUser?.id}isAIMessage(t){return"AI_AGENT"===t.senderType}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(me.m))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-chat"]],viewQuery:function(n,r){if(1&n&&e.GBs(ue,5),2&n){let s;e.mGM(s=e.lsd())&&(r.messagesContainer=s.first)}},standalone:!0,features:[e.aNF],decls:55,vars:5,consts:[["messagesContainer",""],[1,"chat-container"],[1,"chat-header"],[1,"d-flex","align-items-center"],[1,"avatar-container","me-3"],[1,"avatar-circle","bg-primary"],[1,"ri-user-line","text-white"],[1,"status-indicator"],[1,"mb-0","chat-title"],[1,"text-muted"],[1,"chat-actions"],[1,"btn","btn-light","btn-sm","me-2"],[1,"ri-search-line"],[1,"ri-settings-3-line"],[1,"btn","btn-light","btn-sm"],[1,"ri-more-2-line"],[1,"chat-messages"],[1,"date-separator"],[1,"date-label"],["class","message-container",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[1,"chat-input"],[1,"input-container"],[1,"btn","btn-light","attachment-btn"],[1,"ri-emotion-line"],[1,"ri-attachment-2"],[1,"ri-file-line"],[1,"input-wrapper"],["placeholder","Enter Message...","rows","1",1,"message-input",3,"ngModelChange","keypress","ngModel","disabled"],["type","button",1,"btn","send-btn",3,"click","disabled"],[1,"ri-send-plane-fill"],[1,"card","mt-3"],[1,"card-body"],[1,"card-title"],[1,"list-unstyled","mb-0"],[1,"mb-2"],[1,"ri-time-line","text-primary","me-2"],[1,"ri-calendar-line","text-primary","me-2"],[1,"ri-file-line","text-primary","me-2"],[1,"ri-phone-line","text-primary","me-2"],[1,"message-container"],["class","date-separator",4,"ngIf"],[1,"message-row"],["class","message-avatar",4,"ngIf"],[1,"message-bubble"],["class","message-sender",4,"ngIf"],[1,"message-text"],[1,"message-time"],["class","message-options",4,"ngIf"],[1,"message-avatar"],[1,"avatar-circle"],["class","ri-user-3-line text-white",4,"ngIf"],["class","ri-robot-2-line text-white",4,"ngIf"],[1,"ri-user-3-line","text-white"],[1,"ri-robot-2-line","text-white"],[1,"message-sender"],[1,"message-options"],[1,"btn","btn-sm","btn-light"],[1,"ri-more-2-fill"],[1,"loading-container"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"],[1,"visually-hidden"],[1,"text-muted","ms-2"]],template:function(n,r){if(1&n){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),e.nrm(5,"i",6),e.k0s(),e.nrm(6,"div",7),e.k0s(),e.j41(7,"div")(8,"h5",8),e.EFF(9,"Sarah Johnson, CPA"),e.k0s(),e.j41(10,"small",9),e.EFF(11,"Active now"),e.k0s()()(),e.j41(12,"div",10)(13,"button",11),e.nrm(14,"i",12),e.k0s(),e.j41(15,"button",11),e.nrm(16,"i",13),e.k0s(),e.j41(17,"button",14),e.nrm(18,"i",15),e.k0s()()(),e.j41(19,"div",16,0)(21,"div",17)(22,"span",18),e.EFF(23,"Today"),e.k0s()(),e.DNE(24,ve,11,16,"div",19)(25,ke,6,0,"div",20),e.k0s(),e.j41(26,"div",21)(27,"div",22)(28,"button",23),e.nrm(29,"i",24),e.k0s(),e.j41(30,"button",23),e.nrm(31,"i",25),e.k0s(),e.j41(32,"button",23),e.nrm(33,"i",26),e.k0s(),e.j41(34,"div",27)(35,"textarea",28),e.mxI("ngModelChange",function(m){return e.eBV(s),e.DH7(r.newMessage,m)||(r.newMessage=m),e.Njj(m)}),e.bIt("keypress",function(m){return e.eBV(s),e.Njj(r.onKeyPress(m))}),e.k0s()(),e.j41(36,"button",29),e.bIt("click",function(){return e.eBV(s),e.Njj(r.sendMessage())}),e.nrm(37,"i",30),e.k0s()()()(),e.j41(38,"div",31)(39,"div",32)(40,"h6",33),e.EFF(41,"Chat Guidelines"),e.k0s(),e.j41(42,"ul",34)(43,"li",35),e.nrm(44,"i",36),e.EFF(45,"Response time: Usually within 2-4 hours during business hours"),e.k0s(),e.j41(46,"li",35),e.nrm(47,"i",37),e.EFF(48,"Business hours: Monday-Friday, 9 AM - 6 PM EST"),e.k0s(),e.j41(49,"li",35),e.nrm(50,"i",38),e.EFF(51,"For document sharing, please use the Documents section"),e.k0s(),e.j41(52,"li"),e.nrm(53,"i",39),e.EFF(54,"For urgent matters, please call: (555) 123-4567"),e.k0s()()()()}2&n&&(e.R7$(24),e.Y8G("ngForOf",r.messages),e.R7$(),e.Y8G("ngIf",r.isLoading),e.R7$(10),e.R50("ngModel",r.newMessage),e.Y8G("disabled",r.isLoading),e.R7$(),e.Y8G("disabled",!r.newMessage.trim()||r.isLoading))},dependencies:[d.MD,d.Sq,d.bT,i.YN,i.me,i.BC,i.vS],styles:['.chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;max-height:800px;background:#fff;border-radius:12px;box-shadow:0 4px 20px #0000001a;overflow:hidden}.chat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:#fff;border-bottom:1px solid #f0f0f0;position:sticky;top:0;z-index:10}.avatar-container[_ngcontent-%COMP%]{position:relative}.avatar-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px}.bg-gradient-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.status-indicator[_ngcontent-%COMP%]{position:absolute;bottom:2px;right:2px;width:12px;height:12px;background:#10b981;border:2px solid #ffffff;border-radius:50%}.chat-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:16px}.chat-actions[_ngcontent-%COMP%]{display:flex;gap:4px}.chat-messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px;background:#f9fafb;scroll-behavior:smooth}.date-separator[_ngcontent-%COMP%]{text-align:center;margin:20px 0;position:relative}.date-separator[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:0;right:0;height:1px;background:#e5e7eb;z-index:1}.date-label[_ngcontent-%COMP%]{background:#f9fafb;color:#6b7280;padding:4px 12px;font-size:12px;font-weight:500;position:relative;z-index:2}.message-container[_ngcontent-%COMP%]{margin-bottom:8px}.message-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px;margin-bottom:12px}.message-sent[_ngcontent-%COMP%]{justify-content:flex-end}.message-received[_ngcontent-%COMP%]{justify-content:flex-start}.message-avatar[_ngcontent-%COMP%]{width:32px;height:32px;flex-shrink:0}.message-avatar[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:32px;height:32px;font-size:14px;box-shadow:0 2px 8px #00000026}.message-avatar[_ngcontent-%COMP%]   .bg-primary[_ngcontent-%COMP%]{background:#6366f1!important}.message-avatar[_ngcontent-%COMP%]   .bg-gradient-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)!important}.message-bubble[_ngcontent-%COMP%]{max-width:320px;padding:12px 16px;border-radius:18px;position:relative;word-wrap:break-word}.bubble-sent[_ngcontent-%COMP%]{background:#6366f1;color:#fff;border-bottom-right-radius:6px;margin-left:auto}.bubble-received[_ngcontent-%COMP%]{background:#fff;color:#1f2937;border:1px solid #e5e7eb;border-bottom-left-radius:6px}.bubble-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-bottom-left-radius:6px}.message-sender[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6366f1;margin-bottom:4px}.bubble-sent[_ngcontent-%COMP%]   .message-sender[_ngcontent-%COMP%]{color:#fffc}.bubble-ai[_ngcontent-%COMP%]   .message-sender[_ngcontent-%COMP%]{color:#ffffffe6}.message-text[_ngcontent-%COMP%]{line-height:1.4;font-size:14px}.message-time[_ngcontent-%COMP%]{font-size:11px;opacity:.7;margin-top:4px;text-align:right}.bubble-received[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#6b7280}.message-options[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s}.message-row[_ngcontent-%COMP%]:hover   .message-options[_ngcontent-%COMP%]{opacity:1}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.chat-input[_ngcontent-%COMP%]{padding:16px 20px;background:#fff;border-top:1px solid #f0f0f0}.input-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:24px;padding:8px 12px;transition:border-color .2s}.input-container[_ngcontent-%COMP%]:focus-within{border-color:#6366f1;box-shadow:0 0 0 3px #6366f11a}.attachment-btn[_ngcontent-%COMP%]{border:none;background:transparent;color:#6b7280;padding:8px;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;transition:all .2s}.attachment-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.input-wrapper[_ngcontent-%COMP%]{flex:1}.message-input[_ngcontent-%COMP%]{width:100%;border:none;background:transparent;resize:none;outline:none;font-size:14px;line-height:1.4;padding:8px 0;color:#1f2937;max-height:120px}.message-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.send-btn[_ngcontent-%COMP%]{background:#6366f1;border:none;color:#fff;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s;cursor:pointer}.send-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#5856eb;transform:scale(1.05)}.send-btn[_ngcontent-%COMP%]:disabled{background:#d1d5db;cursor:not-allowed;transform:none}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.chat-container[_ngcontent-%COMP%]{height:100vh;border-radius:0}.message-bubble[_ngcontent-%COMP%]{max-width:280px}.chat-header[_ngcontent-%COMP%]{padding:12px 16px}.chat-messages[_ngcontent-%COMP%]{padding:16px}.chat-input[_ngcontent-%COMP%]{padding:12px 16px}}']})}}return o})()}];let Ce=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[g.iI.forChild(Fe),g.iI]})}}return o})();var ye=l(6551),xe=l(1745),Ie=l(8580),je=l(779),Me=l(3816);let Ee=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[d.MD,i.YN,i.X1,Ce,ye.T,xe.V,Ie.zE,je.Q_,Me.jr]})}}return o})()}}]);
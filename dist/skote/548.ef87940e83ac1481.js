"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[548],{6548:(M,l,r)=>{r.r(l),r.d(l,{ProjectDetailComponent:()=>x});var u=r(1413),d=r(6977),g=r(8032),m=r.n(g),s=r(177),t=r(4438),p=r(803),_=r(6344);const b=()=>["/client-portal/tax-intake"],f=o=>({projectId:o}),j=()=>["/client-portal/chat"];function v(o,a){1&o&&(t.j41(0,"div",10)(1,"div",11)(2,"span",12),t.EFF(3,"Loading..."),t.k0s()()())}function F(o,a){if(1&o&&(t.j41(0,"div",19)(1,"label",20),t.EFF(2,"Description"),t.k0s(),t.j41(3,"p",21),t.EFF(4),t.k0s()()),2&o){const e=t.XpG(2);t.R7$(4),t.JRh(e.project.description)}}function h(o,a){if(1&o&&(t.j41(0,"tr")(1,"td",38),t.EFF(2),t.nI1(3,"titlecase"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s()()),2&o){const e=a.$implicit;t.R7$(2),t.JRh(t.bMT(3,2,e.key)),t.R7$(3),t.JRh(e.value)}}function k(o,a){if(1&o&&(t.j41(0,"div",14)(1,"div",15)(2,"h5",25),t.EFF(3,"Your Submitted Information"),t.k0s(),t.j41(4,"p",27),t.EFF(5,"Below is the information you provided in your tax intake form."),t.k0s(),t.j41(6,"div",35)(7,"table",36)(8,"tbody"),t.DNE(9,h,6,4,"tr",37),t.nI1(10,"keyvalue"),t.k0s()()()()()),2&o){const e=t.XpG(2);t.R7$(9),t.Y8G("ngForOf",t.bMT(10,1,e.intakeFormData))}}function P(o,a){1&o&&(t.j41(0,"div",39),t.nrm(1,"i",40),t.j41(2,"p",21),t.EFF(3,"No documents available yet"),t.k0s(),t.j41(4,"small"),t.EFF(5,"Your accountant will upload completed documents here"),t.k0s()())}function D(o,a){if(1&o){const e=t.RV6();t.j41(0,"div",41)(1,"div",42)(2,"div",43)(3,"h6",44),t.EFF(4),t.k0s(),t.j41(5,"small",45),t.EFF(6),t.k0s()(),t.j41(7,"button",46),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.downloadDocument(i))}),t.nrm(8,"i",47),t.k0s()()()}if(2&o){const e=a.$implicit,n=t.XpG(2);t.R7$(4),t.JRh(e.originalName),t.R7$(2),t.Lme(" ",n.formatFileSize(e.fileSize)," \u2022 ",n.formatDate(e.uploadedAt)," ")}}function E(o,a){if(1&o&&(t.j41(0,"div",1)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"h5",17),t.EFF(6),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s()(),t.j41(9,"div",1)(10,"div",18)(11,"div",19)(12,"label",20),t.EFF(13,"Project Type"),t.k0s(),t.j41(14,"p",21),t.EFF(15),t.nI1(16,"titlecase"),t.k0s()()(),t.j41(17,"div",18)(18,"div",19)(19,"label",20),t.EFF(20,"Tax Year"),t.k0s(),t.j41(21,"p",21),t.EFF(22),t.k0s()()(),t.j41(23,"div",18)(24,"div",19)(25,"label",20),t.EFF(26,"Due Date"),t.k0s(),t.j41(27,"p",21),t.EFF(28),t.k0s()()(),t.j41(29,"div",18)(30,"div",19)(31,"label",20),t.EFF(32,"Created"),t.k0s(),t.j41(33,"p",21),t.EFF(34),t.k0s()()()(),t.DNE(35,F,5,1,"div",22),t.k0s()(),t.DNE(36,k,11,3,"div",23),t.k0s(),t.j41(37,"div",24)(38,"div",14)(39,"div",15)(40,"h5",25),t.nrm(41,"i",26),t.EFF(42," Prepared Documents "),t.k0s(),t.j41(43,"p",27),t.EFF(44,"Download your completed tax documents prepared by your accountant."),t.k0s(),t.DNE(45,P,6,0,"div",28)(46,D,9,3,"div",29),t.k0s()(),t.j41(47,"div",14)(48,"div",15)(49,"h5",25),t.EFF(50,"Actions"),t.k0s(),t.j41(51,"div",30)(52,"button",31),t.nrm(53,"i",32),t.EFF(54," View/Edit Intake Form "),t.k0s(),t.j41(55,"button",33),t.nrm(56,"i",34),t.EFF(57," Contact Accountant "),t.k0s()()()()()()),2&o){const e=t.XpG();t.R7$(6),t.JRh(e.project.name),t.R7$(),t.HbH(e.getStatusClass(e.project.status)),t.R7$(),t.JRh(e.getStatusLabel(e.project.status)),t.R7$(7),t.JRh(t.bMT(16,15,e.project.projectType)),t.R7$(7),t.JRh(e.project.taxYear||"Not specified"),t.R7$(6),t.JRh(e.formatDate(e.project.dueDate||"")),t.R7$(6),t.JRh(e.formatDate(e.project.createdAt)),t.R7$(),t.Y8G("ngIf",e.project.description),t.R7$(),t.Y8G("ngIf",e.intakeFormData),t.R7$(9),t.Y8G("ngIf",!e.documents||0===e.documents.length),t.R7$(),t.Y8G("ngForOf",e.documents),t.R7$(6),t.Y8G("routerLink",t.lJ4(17,b))("queryParams",t.eq3(18,f,e.projectId)),t.R7$(3),t.Y8G("routerLink",t.lJ4(20,j))}}function C(o,a){1&o&&(t.j41(0,"div",10)(1,"div",45),t.nrm(2,"i",48),t.j41(3,"p",21),t.EFF(4,"Project not found or failed to load"),t.k0s()()())}let x=(()=>{class o{constructor(e,n,i){this.route=e,this.router=n,this.apiService=i,this.destroy$=new u.B,this.project=null,this.intakeFormData=null,this.documents=[],this.isLoading=!1}ngOnInit(){this.route.params.subscribe(e=>{this.projectId=+e.projectId,this.projectId&&(this.loadProjectDetail(),this.loadProjectDocuments())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadProjectDetail(){this.isLoading=!0,this.apiService.getProjectDetail(this.projectId).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{e.success&&(this.project=e.project||null,this.intakeFormData=this.project?.intakeFormData||null),this.isLoading=!1},error:e=>{console.error("Error loading project detail:",e),this.isLoading=!1,m().fire({title:"Error",text:"Failed to load project details.",icon:"error"})}})}loadProjectDocuments(){this.apiService.getProjectDocuments(this.projectId).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{e.success&&(this.documents=e.documents||[])},error:e=>{console.error("Error loading project documents:",e)}})}downloadDocument(e){this.apiService.downloadProjectDocument(e.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{const i=window.URL.createObjectURL(n),c=window.document.createElement("a");c.href=i,c.download=e.originalName,c.click(),window.URL.revokeObjectURL(i)},error:n=>{console.error("Error downloading document:",n),m().fire({title:"Download Failed",text:"Failed to download document.",icon:"error"})}})}getStatusClass(e){return{active:"badge bg-success",in_progress:"badge bg-primary",completed:"badge bg-info",on_hold:"badge bg-warning",cancelled:"badge bg-danger"}[e]||"badge bg-secondary"}getStatusLabel(e){return{active:"Active",in_progress:"In Progress",completed:"Completed",on_hold:"On Hold",cancelled:"Cancelled"}[e]||e}formatFileSize(e){if(0===e)return"0 Bytes";const c=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,c)).toFixed(2))+" "+["Bytes","KB","MB","GB"][c]}formatDate(e){return e?new Date(e).toLocaleDateString():"Not set"}goBack(){this.router.navigate(["/client-portal/projects"])}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(p.nX),t.rXU(p.Ix),t.rXU(_.G))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-project-detail"]],standalone:!0,features:[t.aNF],decls:13,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-flex","align-items-center","justify-content-between"],[1,"mb-0","font-size-18"],[1,"page-title-right"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"ri-arrow-left-line","me-1"],["class","text-center py-5",4,"ngIf"],["class","row",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"col-xl-8","col-12"],[1,"card"],[1,"card-body"],[1,"d-flex","align-items-center","mb-4"],[1,"card-title","mb-0","me-3"],[1,"col-md-6"],[1,"mb-3"],[1,"form-label","text-muted"],[1,"mb-0"],["class","mb-3",4,"ngIf"],["class","card",4,"ngIf"],[1,"col-xl-4","col-12"],[1,"card-title"],[1,"ri-file-text-line","me-2"],[1,"text-muted","mb-3"],["class","text-center text-muted py-4",4,"ngIf"],["class","border rounded p-3 mb-3 document-item",4,"ngFor","ngForOf"],[1,"d-grid","gap-2"],[1,"btn","btn-outline-primary",3,"routerLink","queryParams"],[1,"ri-edit-line","me-2"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"ri-message-2-line","me-2"],[1,"table-responsive"],[1,"table","table-borderless"],[4,"ngFor","ngForOf"],[1,"text-muted","fw-medium",2,"width","30%"],[1,"text-center","text-muted","py-4"],[1,"ri-file-search-line","font-size-24","mb-2","d-block"],[1,"border","rounded","p-3","mb-3","document-item"],[1,"d-flex","align-items-center","justify-content-between"],[1,"flex-grow-1"],[1,"mb-1","text-truncate"],[1,"text-muted"],["title","Download document",1,"btn","btn-primary","btn-sm","ms-2",3,"click"],[1,"ri-download-line"],[1,"ri-error-warning-line","font-size-24","mb-2","d-block"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),t.EFF(5,"Project Details"),t.k0s(),t.j41(6,"div",5)(7,"button",6),t.bIt("click",function(){return i.goBack()}),t.nrm(8,"i",7),t.EFF(9," Back to Projects "),t.k0s()()()()(),t.DNE(10,v,4,0,"div",8)(11,E,58,21,"div",9)(12,C,5,0,"div",8),t.k0s()),2&n&&(t.R7$(10),t.Y8G("ngIf",i.isLoading),t.R7$(),t.Y8G("ngIf",!i.isLoading&&i.project),t.R7$(),t.Y8G("ngIf",!i.isLoading&&!i.project))},dependencies:[s.MD,s.Sq,s.bT,s.PV,s.lG],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid rgba(0,0,0,.125)}.card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#6c757d}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.375rem .75rem}.bg-success[_ngcontent-%COMP%]{background-color:#28a745!important}.bg-primary[_ngcontent-%COMP%]{background-color:#007bff!important}.bg-info[_ngcontent-%COMP%]{background-color:#17a2b8!important}.bg-warning[_ngcontent-%COMP%]{background-color:#ffc107!important;color:#212529!important}.bg-danger[_ngcontent-%COMP%]{background-color:#dc3545!important}.bg-secondary[_ngcontent-%COMP%]{background-color:#6c757d!important}.document-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out;cursor:pointer}.document-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#007bff!important}.table-borderless[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:.75rem 0}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fw-medium[_ngcontent-%COMP%]{font-weight:500}.d-grid[_ngcontent-%COMP%]{display:grid}.gap-2[_ngcontent-%COMP%]{gap:.5rem}@media (max-width: 768px){.card[_ngcontent-%COMP%]{margin-bottom:1rem}.btn-sm[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}.document-item[_ngcontent-%COMP%]{padding:1rem!important}}"]})}}return o})()}}]);
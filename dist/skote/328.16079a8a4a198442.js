"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[328],{4328:(L,u,d)=>{d.r(u),d.d(u,{ClientPortalModule:()=>U});var l=d(177),r=d(9417),p=d(803),e=d(4438);function g(s,c){if(1&s){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",25),e.nrm(3,"i",26),e.EFF(4),e.k0s()(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"td")(13,"span"),e.EFF(14),e.nI1(15,"titlecase"),e.k0s()(),e.j41(16,"td")(17,"button",27),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.downloadDocument(n))}),e.nrm(18,"i",28),e.k0s()()()}if(2&s){const t=c.$implicit,o=e.XpG();e.R7$(4),e.SpI(" ",t.name," "),e.R7$(2),e.JRh(t.type),e.R7$(2),e.JRh(t.size),e.R7$(2),e.JRh(e.i5U(11,7,t.uploadDate,"shortDate")),e.R7$(3),e.HbH(o.getStatusClass(t.status)),e.R7$(),e.SpI(" ",e.bMT(15,10,t.status)," ")}}function h(s,c){1&s&&(e.j41(0,"tr")(1,"td",29),e.EFF(2," No documents found matching your criteria. "),e.k0s()())}let b=(()=>{class s{constructor(){this.documents=[],this.filteredDocuments=[],this.selectedCategory="all",this.searchTerm=""}ngOnInit(){this.loadDocuments()}loadDocuments(){this.documents=[{id:1,name:"W2_2024.pdf",type:"PDF",size:"245 KB",uploadDate:"2024-01-15",status:"approved",category:"tax-documents"},{id:2,name:"Bank_Statement_Jan2024.pdf",type:"PDF",size:"1.2 MB",uploadDate:"2024-02-01",status:"reviewed",category:"financial-statements"},{id:3,name:"Receipt_Office_Supplies.jpg",type:"Image",size:"890 KB",uploadDate:"2024-02-10",status:"pending",category:"receipts"}],this.filteredDocuments=[...this.documents]}filterDocuments(){this.filteredDocuments=this.documents.filter(t=>{const o="all"===this.selectedCategory||t.category===this.selectedCategory,n=t.name.toLowerCase().includes(this.searchTerm.toLowerCase());return o&&n})}onCategoryChange(){this.filterDocuments()}onSearchChange(){this.filterDocuments()}getStatusClass(t){switch(t){case"approved":return"badge bg-success";case"reviewed":return"badge bg-info";case"pending":return"badge bg-warning";default:return"badge bg-secondary"}}downloadDocument(t){console.log("Downloading document:",t.name)}uploadDocument(){console.log("Upload document functionality")}static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-documents"]],decls:58,vars:4,consts:[[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"card-title","mb-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"ri-upload-cloud-line","me-1"],[1,"row","mb-4"],[1,"col-md-6"],["for","categoryFilter",1,"form-label"],["id","categoryFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value","all"],["value","tax-documents"],["value","financial-statements"],["value","receipts"],["value","other"],["for","searchInput",1,"form-label"],["type","text","id","searchInput","placeholder","Search by document name...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-nowrap","table-hover"],[1,"table-light"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"alert","alert-info","mt-4"],[1,"alert-heading"],[1,"mb-0"],[1,"d-flex","align-items-center"],[1,"ri-file-text-line","me-2","text-muted"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"ri-download-line"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4,"Documents"),e.k0s(),e.j41(5,"button",4),e.bIt("click",function(){return n.uploadDocument()}),e.nrm(6,"i",5),e.EFF(7,"Upload Document "),e.k0s()(),e.j41(8,"div",6)(9,"div",7)(10,"label",8),e.EFF(11,"Filter by Category"),e.k0s(),e.j41(12,"select",9),e.mxI("ngModelChange",function(i){return e.DH7(n.selectedCategory,i)||(n.selectedCategory=i),i}),e.bIt("change",function(){return n.onCategoryChange()}),e.j41(13,"option",10),e.EFF(14,"All Categories"),e.k0s(),e.j41(15,"option",11),e.EFF(16,"Tax Documents"),e.k0s(),e.j41(17,"option",12),e.EFF(18,"Financial Statements"),e.k0s(),e.j41(19,"option",13),e.EFF(20,"Receipts"),e.k0s(),e.j41(21,"option",14),e.EFF(22,"Other"),e.k0s()()(),e.j41(23,"div",7)(24,"label",15),e.EFF(25,"Search Documents"),e.k0s(),e.j41(26,"input",16),e.mxI("ngModelChange",function(i){return e.DH7(n.searchTerm,i)||(n.searchTerm=i),i}),e.bIt("input",function(){return n.onSearchChange()}),e.k0s()()(),e.j41(27,"div",17)(28,"table",18)(29,"thead",19)(30,"tr")(31,"th"),e.EFF(32,"Document Name"),e.k0s(),e.j41(33,"th"),e.EFF(34,"Type"),e.k0s(),e.j41(35,"th"),e.EFF(36,"Size"),e.k0s(),e.j41(37,"th"),e.EFF(38,"Upload Date"),e.k0s(),e.j41(39,"th"),e.EFF(40,"Status"),e.k0s(),e.j41(41,"th"),e.EFF(42,"Actions"),e.k0s()()(),e.j41(43,"tbody"),e.DNE(44,g,19,12,"tr",20)(45,h,3,0,"tr",21),e.k0s()()(),e.j41(46,"div",22)(47,"h6",23),e.EFF(48,"Upload Guidelines:"),e.k0s(),e.j41(49,"ul",24)(50,"li"),e.EFF(51,"Accepted formats: PDF, JPG, PNG, DOC, DOCX"),e.k0s(),e.j41(52,"li"),e.EFF(53,"Maximum file size: 10MB"),e.k0s(),e.j41(54,"li"),e.EFF(55,"Please organize documents by category for easier processing"),e.k0s(),e.j41(56,"li"),e.EFF(57,"Uploaded documents will be reviewed within 1-2 business days"),e.k0s()()()()()),2&o&&(e.R7$(12),e.R50("ngModel",n.selectedCategory),e.R7$(14),e.R50("ngModel",n.searchTerm),e.R7$(18),e.Y8G("ngForOf",n.filteredDocuments),e.R7$(),e.Y8G("ngIf",0===n.filteredDocuments.length))},dependencies:[l.Sq,l.bT,r.xH,r.y7,r.me,r.wz,r.BC,r.vS,l.PV,l.vh],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;border-top:none}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem}.alert-info[_ngcontent-%COMP%]{border-left:4px solid #17a2b8}.card-title[_ngcontent-%COMP%]{font-weight:600}"]})}}return s})();function f(s,c){1&s&&(e.j41(0,"span"),e.nrm(1,"i",20),e.EFF(2,"Completed "),e.k0s())}function C(s,c){1&s&&(e.j41(0,"span"),e.nrm(1,"i",21),e.EFF(2,"Continue "),e.k0s())}function y(s,c){1&s&&(e.j41(0,"span"),e.nrm(1,"i",22),e.EFF(2,"Start Form "),e.k0s())}function F(s,c){if(1&s){const t=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",1)(3,"div",10),e.nrm(4,"i",11),e.j41(5,"span"),e.EFF(6),e.nI1(7,"titlecase"),e.nI1(8,"replace"),e.k0s()(),e.j41(9,"h5",12),e.EFF(10),e.k0s(),e.j41(11,"p",13),e.EFF(12),e.k0s(),e.j41(13,"div",14)(14,"small",15),e.nrm(15,"i",16),e.EFF(16),e.nI1(17,"date"),e.k0s(),e.nrm(18,"br"),e.j41(19,"small",15),e.nrm(20,"i",17),e.EFF(21),e.k0s()(),e.j41(22,"button",18),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.openForm(n))}),e.DNE(23,f,3,0,"span",19)(24,C,3,0,"span",19)(25,y,3,0,"span",19),e.k0s()()()()}if(2&s){const t=c.$implicit,o=e.XpG();e.R7$(),e.AVh("border-success","completed"===t.status)("border-warning","in-progress"===t.status),e.R7$(3),e.HbH(o.getStatusIcon(t.status)),e.R7$(),e.HbH(o.getStatusClass(t.status)),e.R7$(),e.JRh(e.brH(8,19,e.bMT(7,17,t.status),"-"," ")),e.R7$(4),e.JRh(t.title),e.R7$(2),e.JRh(t.description),e.R7$(4),e.SpI(" Due: ",e.i5U(17,23,t.dueDate,"shortDate")," "),e.R7$(5),e.SpI(" ",t.category," "),e.R7$(),e.Y8G("disabled","completed"===t.status),e.R7$(),e.Y8G("ngIf","completed"===t.status),e.R7$(),e.Y8G("ngIf","in-progress"===t.status),e.R7$(),e.Y8G("ngIf","not-started"===t.status)}}function _(s,c){if(1&s){const t=e.RV6();e.j41(0,"div",23)(1,"div",24)(2,"div",25)(3,"div",26)(4,"h5",27),e.EFF(5),e.k0s(),e.j41(6,"button",28),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeForm())}),e.k0s()(),e.j41(7,"div",29)(8,"form",30)(9,"div",4)(10,"div",31)(11,"label",32),e.EFF(12,"Business Name *"),e.k0s(),e.nrm(13,"input",33),e.k0s(),e.j41(14,"div",31)(15,"label",34),e.EFF(16,"Business Type *"),e.k0s(),e.j41(17,"select",35)(18,"option",36),e.EFF(19,"Select Business Type"),e.k0s(),e.j41(20,"option",37),e.EFF(21,"LLC"),e.k0s(),e.j41(22,"option",38),e.EFF(23,"Corporation"),e.k0s(),e.j41(24,"option",39),e.EFF(25,"Partnership"),e.k0s(),e.j41(26,"option",40),e.EFF(27,"Sole Proprietorship"),e.k0s()()()(),e.j41(28,"div",4)(29,"div",31)(30,"label",41),e.EFF(31,"Tax ID (EIN) *"),e.k0s(),e.nrm(32,"input",42),e.k0s(),e.j41(33,"div",31)(34,"label",43),e.EFF(35,"Phone Number *"),e.k0s(),e.nrm(36,"input",44),e.k0s()(),e.j41(37,"div",14)(38,"label",45),e.EFF(39,"Business Address *"),e.k0s(),e.nrm(40,"textarea",46),e.k0s(),e.j41(41,"div",4)(42,"div",31)(43,"label",47),e.EFF(44,"Email Address *"),e.k0s(),e.nrm(45,"input",48),e.k0s(),e.j41(46,"div",31)(47,"label",49),e.EFF(48,"Annual Revenue"),e.k0s(),e.nrm(49,"input",50),e.k0s()(),e.j41(50,"div",4)(51,"div",31)(52,"label",51),e.EFF(53,"Number of Employees"),e.k0s(),e.nrm(54,"input",52),e.k0s()(),e.j41(55,"div",14)(56,"label",53),e.EFF(57,"Business Description"),e.k0s(),e.nrm(58,"textarea",54),e.k0s()()(),e.j41(59,"div",55)(60,"button",56),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeForm())}),e.EFF(61,"Cancel"),e.k0s(),e.j41(62,"button",57),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.saveForm())}),e.EFF(63,"Save Draft"),e.k0s(),e.j41(64,"button",58),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitForm())}),e.EFF(65,"Submit Form"),e.k0s()()()()()}if(2&s){const t=e.XpG();e.xc7("display",t.showFormModal?"block":"none"),e.AVh("show",t.showFormModal),e.R7$(5),e.JRh(null==t.selectedForm?null:t.selectedForm.title),e.R7$(3),e.Y8G("formGroup",t.currentForm),e.R7$(54),e.Y8G("disabled",!t.currentForm.valid),e.R7$(2),e.Y8G("disabled",!t.currentForm.valid)}}function v(s,c){if(1&s&&e.nrm(0,"div",59),2&s){const t=e.XpG();e.AVh("show",t.showFormModal)}}let k=(()=>{class s{constructor(t){this.fb=t,this.intakeForms=[],this.selectedForm=null,this.showFormModal=!1,this.currentForm=this.fb.group({businessName:["",r.k0.required],businessType:["",r.k0.required],taxId:["",r.k0.required],address:["",r.k0.required],phone:["",r.k0.required],email:["",[r.k0.required,r.k0.email]],annualRevenue:[""],numberOfEmployees:[""],businessDescription:[""]})}ngOnInit(){this.loadIntakeForms()}loadIntakeForms(){this.intakeForms=[{id:1,title:"Business Information Form",description:"Basic business details and contact information",status:"completed",dueDate:"2024-01-15",category:"Business Setup"},{id:2,title:"Tax Preparation Questionnaire",description:"Annual tax preparation information and documentation requirements",status:"in-progress",dueDate:"2024-03-15",category:"Tax Preparation"},{id:3,title:"Bookkeeping Services Setup",description:"Monthly bookkeeping service preferences and requirements",status:"not-started",dueDate:"2024-02-28",category:"Bookkeeping"}]}getStatusClass(t){switch(t){case"completed":return"badge bg-success";case"in-progress":return"badge bg-warning";default:return"badge bg-secondary"}}getStatusIcon(t){switch(t){case"completed":return"ri-check-line";case"in-progress":return"ri-time-line";default:return"ri-file-list-line"}}openForm(t){this.selectedForm=t,this.showFormModal=!0,1===t.id&&this.currentForm.patchValue({businessName:"Sample Business LLC",businessType:"LLC",taxId:"12-3456789",address:"123 Main St, City, State 12345",phone:"(555) 123-4567",email:"business@example.com",annualRevenue:"500000",numberOfEmployees:"5",businessDescription:"Professional services company"})}closeForm(){this.showFormModal=!1,this.selectedForm=null}saveForm(){this.currentForm.valid&&this.selectedForm&&(console.log("Saving form data:",this.currentForm.value),this.selectedForm.status="in-progress",this.closeForm())}submitForm(){this.currentForm.valid&&this.selectedForm&&(console.log("Submitting form data:",this.currentForm.value),this.selectedForm.status="completed",this.closeForm())}static{this.\u0275fac=function(o){return new(o||s)(e.rXU(r.ok))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-intake"]],decls:10,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"card-title","mb-4"],[1,"text-muted","mb-4"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","modal fade","tabindex","-1",3,"show","display",4,"ngIf"],["class","modal-backdrop fade",3,"show",4,"ngIf"],[1,"col-lg-4","col-md-6","mb-4"],[1,"card","border","h-100"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"font-size-24","text-primary"],[1,"card-title"],[1,"card-text","text-muted"],[1,"mb-3"],[1,"text-muted"],[1,"ri-calendar-line","me-1"],[1,"ri-folder-line","me-1"],["type","button",1,"btn","btn-primary","btn-sm",3,"click","disabled"],[4,"ngIf"],[1,"ri-check-line","me-1"],[1,"ri-edit-line","me-1"],[1,"ri-play-line","me-1"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"col-md-6","mb-3"],["for","businessName",1,"form-label"],["type","text","id","businessName","formControlName","businessName",1,"form-control"],["for","businessType",1,"form-label"],["id","businessType","formControlName","businessType",1,"form-select"],["value",""],["value","LLC"],["value","Corporation"],["value","Partnership"],["value","Sole Proprietorship"],["for","taxId",1,"form-label"],["type","text","id","taxId","formControlName","taxId",1,"form-control"],["for","phone",1,"form-label"],["type","tel","id","phone","formControlName","phone",1,"form-control"],["for","address",1,"form-label"],["id","address","rows","2","formControlName","address",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","annualRevenue",1,"form-label"],["type","number","id","annualRevenue","formControlName","annualRevenue",1,"form-control"],["for","numberOfEmployees",1,"form-label"],["type","number","id","numberOfEmployees","formControlName","numberOfEmployees",1,"form-control"],["for","businessDescription",1,"form-label"],["id","businessDescription","rows","3","formControlName","businessDescription",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-outline-primary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"modal-backdrop","fade"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"h4",2),e.EFF(3,"Intake Forms"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Complete the required forms below to help us serve you better. Click on any form to get started."),e.k0s(),e.j41(6,"div",4),e.DNE(7,F,26,26,"div",5),e.k0s()()(),e.DNE(8,_,66,8,"div",6)(9,v,1,2,"div",7)),2&o&&(e.R7$(7),e.Y8G("ngForOf",n.intakeForms),e.R7$(),e.Y8G("ngIf",n.showFormModal),e.R7$(),e.Y8G("ngIf",n.showFormModal))},dependencies:[l.Sq,l.bT,r.qT,r.xH,r.y7,r.me,r.Q0,r.wz,r.BC,r.cb,r.j4,r.JD,l.PV,l.vh],styles:[".card.border-success[_ngcontent-%COMP%]{border-color:#28a745!important}.card.border-warning[_ngcontent-%COMP%]{border-color:#ffc107!important}.card-title[_ngcontent-%COMP%]{font-weight:600}.modal.show[_ngcontent-%COMP%]{background-color:#00000080}.modal-backdrop.show[_ngcontent-%COMP%]{opacity:.5}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem}.form-label[_ngcontent-%COMP%]{font-weight:500}"]})}}return s})();var x=d(5538);const M=["messagesContainer"];function I(s,c){if(1&s&&(e.j41(0,"div",17)(1,"span",18),e.EFF(2),e.k0s()()),2&s){const t=e.XpG().$implicit,o=e.XpG();e.R7$(2),e.JRh(o.formatDate(t.timestamp))}}function T(s,c){1&s&&e.nrm(0,"i",53)}function w(s,c){1&s&&e.nrm(0,"i",54)}function j(s,c){if(1&s&&(e.j41(0,"div",49)(1,"div",50),e.DNE(2,T,1,0,"i",51)(3,w,1,0,"i",52),e.k0s()()),2&s){const t=e.XpG().$implicit,o=e.XpG();e.R7$(),e.AVh("bg-primary","ACCOUNTANT"===t.senderType)("bg-gradient-ai",o.isAIMessage(t)),e.R7$(),e.Y8G("ngIf","ACCOUNTANT"===t.senderType),e.R7$(),e.Y8G("ngIf",o.isAIMessage(t))}}function E(s,c){if(1&s&&(e.j41(0,"div",55),e.EFF(1),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.senderName)}}function D(s,c){1&s&&(e.j41(0,"div",56)(1,"button",57),e.nrm(2,"i",58),e.k0s()())}function O(s,c){if(1&s&&(e.j41(0,"div",40),e.DNE(1,I,3,1,"div",41),e.j41(2,"div",42),e.DNE(3,j,4,6,"div",43),e.j41(4,"div",44),e.DNE(5,E,2,1,"div",45),e.j41(6,"div",46),e.EFF(7),e.k0s(),e.j41(8,"div",47),e.EFF(9),e.k0s()(),e.DNE(10,D,3,0,"div",48),e.k0s()()),2&s){const t=c.$implicit,o=c.index,n=e.XpG();e.R7$(),e.Y8G("ngIf",n.shouldShowDateSeparator(o)),e.R7$(),e.AVh("message-sent",n.isMyMessage(t))("message-received",!n.isMyMessage(t)),e.R7$(),e.Y8G("ngIf",!n.isMyMessage(t)),e.R7$(),e.AVh("bubble-sent",n.isMyMessage(t))("bubble-received","ACCOUNTANT"===t.senderType)("bubble-ai",n.isAIMessage(t)),e.R7$(),e.Y8G("ngIf",!n.isMyMessage(t)),e.R7$(2),e.JRh(t.content),e.R7$(2),e.JRh(n.formatTime(t.timestamp)),e.R7$(),e.Y8G("ngIf",!n.isMyMessage(t))}}function P(s,c){1&s&&(e.j41(0,"div",59)(1,"div",60)(2,"span",61),e.EFF(3,"Loading..."),e.k0s()(),e.j41(4,"small",62),e.EFF(5,"Loading messages..."),e.k0s()())}const R=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>d.e(796).then(d.bind(d,8796)).then(s=>s.ClientDashboardComponent)},{path:"documents",component:b},{path:"intake",component:k},{path:"chat",component:(()=>{class s{constructor(t){this.chatService=t,this.messages=[],this.newMessage="",this.currentThread=null,this.isLoading=!1,this.subscriptions=[],this.currentUser=this.chatService.getCurrentUser()}ngOnInit(){this.loadMessages()}ngAfterViewChecked(){this.scrollToBottom()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadMessages(){this.isLoading=!0;const t=this.currentUser?.id||1,o=this.loadMessagesFromStorage(t);if(o.length>0)return this.messages=o,void(this.isLoading=!1);const n=this.chatService.getThread(t).subscribe({next:a=>{this.currentThread=a.thread,this.messages=a.messages,this.saveMessagesToStorage(t,this.messages),this.isLoading=!1},error:a=>{console.error("Error loading messages:",a),this.isLoading=!1,this.loadMockMessages(),this.saveMessagesToStorage(t,this.messages)}});this.subscriptions.push(n)}loadMockMessages(){this.messages=[{content:"Hello! Welcome to our chat system. How can I help you today?",senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date("2024-02-10T09:00:00"),threadId:1},{content:"Hi Sarah! I have a question about my quarterly tax payments.",senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date("2024-02-10T09:15:00"),threadId:1},{content:"Of course! I'd be happy to help with your quarterly payments. What specific question do you have?",senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date("2024-02-10T09:16:00"),threadId:1}]}loadMessagesFromStorage(t){try{const o=`chat_messages_client_${t}`,n=localStorage.getItem(o);if(n)return JSON.parse(n).map(i=>({...i,timestamp:new Date(i.timestamp)}))}catch(o){console.error("Error loading messages from storage:",o)}return[]}saveMessagesToStorage(t,o){try{const n=`chat_messages_client_${t}`;localStorage.setItem(n,JSON.stringify(o))}catch(n){console.error("Error saving messages to storage:",n)}}sendMessage(){if(this.newMessage.trim()&&this.currentThread){const t={content:this.newMessage.trim(),senderType:"CLIENT"},o=this.currentUser?.id||1,n=this.chatService.sendMessage(o,t).subscribe({next:a=>{const i={content:this.newMessage,senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(i),this.saveMessagesToStorage(o,this.messages),this.newMessage="",i.content.toLowerCase().includes("@ai")&&this.handleAIResponse(i.content)},error:a=>{console.error("Error sending message:",a);const i={content:this.newMessage,senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(i),this.saveMessagesToStorage(o,this.messages),this.newMessage="",i.content.toLowerCase().includes("@ai")&&this.handleAIResponse(i.content)}});this.subscriptions.push(n)}}addLocalMessage(){const t={content:this.newMessage.trim(),senderId:this.currentUser?.id||2,senderName:"You",senderType:"CLIENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(t),this.newMessage="",setTimeout(()=>{this.simulateAccountantResponse()},2e3)}simulateAccountantResponse(){const t=["Thank you for your message. I'll review this and get back to you shortly.","I understand your concern. Let me look into this for you.","That's a great question. I'll need to check a few things and respond within the hour.","I've received your message and will provide a detailed response soon."],n={content:t[Math.floor(Math.random()*t.length)],senderId:1,senderName:"Sarah Johnson, CPA",senderType:"ACCOUNTANT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(n),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages)}handleAIResponse(t){setTimeout(()=>{const o=["I understand you're asking about tax matters. Based on current tax regulations, here's what I can tell you: For quarterly payments, you should calculate 25% of your expected annual tax liability and submit by the quarterly deadlines.","That's a great tax question! Here's some guidance: Business expenses must be ordinary and necessary for your trade or business. Keep detailed records and receipts for all deductions.","I can help with that tax inquiry. Here's what you should know: The standard deduction for 2024 is $14,600 for single filers and $29,200 for married filing jointly.","Thank you for your tax question. Here's some helpful information: Self-employment tax is 15.3% of your net self-employment earnings, covering Social Security and Medicare taxes."],a={content:o[Math.floor(Math.random()*o.length)],senderId:0,senderName:"Tax AI Agent",senderType:"AI_AGENT",timestamp:new Date,threadId:this.currentThread?.id||1};this.messages.push(a),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages),this.scrollToBottom()},1500)}triggerAIResponse(t){const o=this.chatService.getAIResponse(t).subscribe({next:n=>{this.messages.push({content:n.message,senderId:0,senderName:"Tax AI Agent",senderType:"AI_AGENT",timestamp:new Date,threadId:this.currentThread?.id||1}),this.saveMessagesToStorage(this.currentUser?.id||1,this.messages),this.scrollToBottom()},error:n=>{console.error("Error getting AI response:",n),this.handleAIResponse(t)}});this.subscriptions.push(o)}onKeyPress(t){"Enter"===t.key&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())}scrollToBottom(){try{this.messagesContainer&&(this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight)}catch(t){console.error("Error scrolling to bottom:",t)}}formatTime(t){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(t)}formatDate(t){const o=new Date,n=new Date(t);if(n.toDateString()===o.toDateString())return"Today";const a=new Date(o);return a.setDate(a.getDate()-1),n.toDateString()===a.toDateString()?"Yesterday":n.toLocaleDateString()}shouldShowDateSeparator(t){if(0===t)return!0;const n=this.messages[t-1];return this.messages[t].timestamp.toDateString()!==n.timestamp.toDateString()}isMyMessage(t){return"CLIENT"===t.senderType&&t.senderId===this.currentUser?.id}isAIMessage(t){return"AI_AGENT"===t.senderType}static{this.\u0275fac=function(o){return new(o||s)(e.rXU(x.m))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-chat"]],viewQuery:function(o,n){if(1&o&&e.GBs(M,5),2&o){let a;e.mGM(a=e.lsd())&&(n.messagesContainer=a.first)}},standalone:!0,features:[e.aNF],decls:55,vars:5,consts:[["messagesContainer",""],[1,"chat-container"],[1,"chat-header"],[1,"d-flex","align-items-center"],[1,"avatar-container","me-3"],[1,"avatar-circle","bg-primary"],[1,"ri-user-line","text-white"],[1,"status-indicator"],[1,"mb-0","chat-title"],[1,"text-muted"],[1,"chat-actions"],[1,"btn","btn-light","btn-sm","me-2"],[1,"ri-search-line"],[1,"ri-settings-3-line"],[1,"btn","btn-light","btn-sm"],[1,"ri-more-2-line"],[1,"chat-messages"],[1,"date-separator"],[1,"date-label"],["class","message-container",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[1,"chat-input"],[1,"input-container"],[1,"btn","btn-light","attachment-btn"],[1,"ri-emotion-line"],[1,"ri-attachment-2"],[1,"ri-file-line"],[1,"input-wrapper"],["placeholder","Enter Message...","rows","1",1,"message-input",3,"ngModelChange","keypress","ngModel","disabled"],["type","button",1,"btn","send-btn",3,"click","disabled"],[1,"ri-send-plane-fill"],[1,"card","mt-3"],[1,"card-body"],[1,"card-title"],[1,"list-unstyled","mb-0"],[1,"mb-2"],[1,"ri-time-line","text-primary","me-2"],[1,"ri-calendar-line","text-primary","me-2"],[1,"ri-file-line","text-primary","me-2"],[1,"ri-phone-line","text-primary","me-2"],[1,"message-container"],["class","date-separator",4,"ngIf"],[1,"message-row"],["class","message-avatar",4,"ngIf"],[1,"message-bubble"],["class","message-sender",4,"ngIf"],[1,"message-text"],[1,"message-time"],["class","message-options",4,"ngIf"],[1,"message-avatar"],[1,"avatar-circle"],["class","ri-user-3-line text-white",4,"ngIf"],["class","ri-robot-2-line text-white",4,"ngIf"],[1,"ri-user-3-line","text-white"],[1,"ri-robot-2-line","text-white"],[1,"message-sender"],[1,"message-options"],[1,"btn","btn-sm","btn-light"],[1,"ri-more-2-fill"],[1,"loading-container"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"],[1,"visually-hidden"],[1,"text-muted","ms-2"]],template:function(o,n){if(1&o){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),e.nrm(5,"i",6),e.k0s(),e.nrm(6,"div",7),e.k0s(),e.j41(7,"div")(8,"h5",8),e.EFF(9,"Sarah Johnson, CPA"),e.k0s(),e.j41(10,"small",9),e.EFF(11,"Active now"),e.k0s()()(),e.j41(12,"div",10)(13,"button",11),e.nrm(14,"i",12),e.k0s(),e.j41(15,"button",11),e.nrm(16,"i",13),e.k0s(),e.j41(17,"button",14),e.nrm(18,"i",15),e.k0s()()(),e.j41(19,"div",16,0)(21,"div",17)(22,"span",18),e.EFF(23,"Today"),e.k0s()(),e.DNE(24,O,11,16,"div",19)(25,P,6,0,"div",20),e.k0s(),e.j41(26,"div",21)(27,"div",22)(28,"button",23),e.nrm(29,"i",24),e.k0s(),e.j41(30,"button",23),e.nrm(31,"i",25),e.k0s(),e.j41(32,"button",23),e.nrm(33,"i",26),e.k0s(),e.j41(34,"div",27)(35,"textarea",28),e.mxI("ngModelChange",function(m){return e.eBV(a),e.DH7(n.newMessage,m)||(n.newMessage=m),e.Njj(m)}),e.bIt("keypress",function(m){return e.eBV(a),e.Njj(n.onKeyPress(m))}),e.k0s()(),e.j41(36,"button",29),e.bIt("click",function(){return e.eBV(a),e.Njj(n.sendMessage())}),e.nrm(37,"i",30),e.k0s()()()(),e.j41(38,"div",31)(39,"div",32)(40,"h6",33),e.EFF(41,"Chat Guidelines"),e.k0s(),e.j41(42,"ul",34)(43,"li",35),e.nrm(44,"i",36),e.EFF(45,"Response time: Usually within 2-4 hours during business hours"),e.k0s(),e.j41(46,"li",35),e.nrm(47,"i",37),e.EFF(48,"Business hours: Monday-Friday, 9 AM - 6 PM EST"),e.k0s(),e.j41(49,"li",35),e.nrm(50,"i",38),e.EFF(51,"For document sharing, please use the Documents section"),e.k0s(),e.j41(52,"li"),e.nrm(53,"i",39),e.EFF(54,"For urgent matters, please call: (555) 123-4567"),e.k0s()()()()}2&o&&(e.R7$(24),e.Y8G("ngForOf",n.messages),e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(10),e.R50("ngModel",n.newMessage),e.Y8G("disabled",n.isLoading),e.R7$(),e.Y8G("disabled",!n.newMessage.trim()||n.isLoading))},dependencies:[l.MD,l.Sq,l.bT,r.YN,r.me,r.BC,r.vS],styles:['.chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;max-height:800px;background:#fff;border-radius:12px;box-shadow:0 4px 20px #0000001a;overflow:hidden}.chat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:#fff;border-bottom:1px solid #f0f0f0;position:sticky;top:0;z-index:10}.avatar-container[_ngcontent-%COMP%]{position:relative}.avatar-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px}.bg-gradient-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.status-indicator[_ngcontent-%COMP%]{position:absolute;bottom:2px;right:2px;width:12px;height:12px;background:#10b981;border:2px solid #ffffff;border-radius:50%}.chat-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:16px}.chat-actions[_ngcontent-%COMP%]{display:flex;gap:4px}.chat-messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px;background:#f9fafb;scroll-behavior:smooth}.date-separator[_ngcontent-%COMP%]{text-align:center;margin:20px 0;position:relative}.date-separator[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:0;right:0;height:1px;background:#e5e7eb;z-index:1}.date-label[_ngcontent-%COMP%]{background:#f9fafb;color:#6b7280;padding:4px 12px;font-size:12px;font-weight:500;position:relative;z-index:2}.message-container[_ngcontent-%COMP%]{margin-bottom:8px}.message-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px;margin-bottom:12px}.message-sent[_ngcontent-%COMP%]{justify-content:flex-end}.message-received[_ngcontent-%COMP%]{justify-content:flex-start}.message-avatar[_ngcontent-%COMP%]{width:32px;height:32px;flex-shrink:0}.message-avatar[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:32px;height:32px;font-size:14px;box-shadow:0 2px 8px #00000026}.message-avatar[_ngcontent-%COMP%]   .bg-primary[_ngcontent-%COMP%]{background:#6366f1!important}.message-avatar[_ngcontent-%COMP%]   .bg-gradient-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)!important}.message-bubble[_ngcontent-%COMP%]{max-width:320px;padding:12px 16px;border-radius:18px;position:relative;word-wrap:break-word}.bubble-sent[_ngcontent-%COMP%]{background:#6366f1;color:#fff;border-bottom-right-radius:6px;margin-left:auto}.bubble-received[_ngcontent-%COMP%]{background:#fff;color:#1f2937;border:1px solid #e5e7eb;border-bottom-left-radius:6px}.bubble-ai[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-bottom-left-radius:6px}.message-sender[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#6366f1;margin-bottom:4px}.bubble-sent[_ngcontent-%COMP%]   .message-sender[_ngcontent-%COMP%]{color:#fffc}.bubble-ai[_ngcontent-%COMP%]   .message-sender[_ngcontent-%COMP%]{color:#ffffffe6}.message-text[_ngcontent-%COMP%]{line-height:1.4;font-size:14px}.message-time[_ngcontent-%COMP%]{font-size:11px;opacity:.7;margin-top:4px;text-align:right}.bubble-received[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#6b7280}.message-options[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s}.message-row[_ngcontent-%COMP%]:hover   .message-options[_ngcontent-%COMP%]{opacity:1}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#6b7280}.chat-input[_ngcontent-%COMP%]{padding:16px 20px;background:#fff;border-top:1px solid #f0f0f0}.input-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:24px;padding:8px 12px;transition:border-color .2s}.input-container[_ngcontent-%COMP%]:focus-within{border-color:#6366f1;box-shadow:0 0 0 3px #6366f11a}.attachment-btn[_ngcontent-%COMP%]{border:none;background:transparent;color:#6b7280;padding:8px;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;transition:all .2s}.attachment-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.input-wrapper[_ngcontent-%COMP%]{flex:1}.message-input[_ngcontent-%COMP%]{width:100%;border:none;background:transparent;resize:none;outline:none;font-size:14px;line-height:1.4;padding:8px 0;color:#1f2937;max-height:120px}.message-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.send-btn[_ngcontent-%COMP%]{background:#6366f1;border:none;color:#fff;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s;cursor:pointer}.send-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#5856eb;transform:scale(1.05)}.send-btn[_ngcontent-%COMP%]:disabled{background:#d1d5db;cursor:not-allowed;transform:none}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.chat-container[_ngcontent-%COMP%]{height:100vh;border-radius:0}.message-bubble[_ngcontent-%COMP%]{max-width:280px}.chat-header[_ngcontent-%COMP%]{padding:12px 16px}.chat-messages[_ngcontent-%COMP%]{padding:16px}.chat-input[_ngcontent-%COMP%]{padding:12px 16px}}']})}}return s})()}];let S=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[p.iI.forChild(R),p.iI]})}}return s})();var N=d(6551),A=d(1745),$=d(8580),G=d(779),B=d(3816);let U=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[l.MD,r.YN,r.X1,S,N.T,A.V,$.zE,G.Q_,B.jr]})}}return s})()}}]);
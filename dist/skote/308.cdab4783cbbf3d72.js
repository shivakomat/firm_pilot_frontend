"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[308],{6308:(de,v,m)=>{m.r(v),m.d(v,{ClientsModule:()=>re});var u=m(177),p=m(803),r=m(9417),y=m(6551),f=m(779),R=m(8032),c=m.n(R),t=m(4438),b=m(6344);const T=["newClientModal"],$=["editClientModal"],I=["inviteClientModal"],D=(i,o)=>o.value,S=(i,o)=>o.id;function M(i,o){if(1&i&&(t.j41(0,"option",112),t.EFF(1),t.k0s()),2&i){const e=o.$implicit;t.Y8G("value",e.value),t.R7$(),t.JRh(e.label)}}function w(i,o){if(1&i&&(t.j41(0,"div",106),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.lastInvitedAt,"short"))}}function P(i,o){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"span",103),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"span",103),t.EFF(14),t.k0s()(),t.j41(15,"td")(16,"span",103),t.EFF(17),t.k0s(),t.DNE(18,w,3,4,"div",106),t.k0s(),t.j41(19,"td"),t.EFF(20),t.nI1(21,"date"),t.k0s(),t.j41(22,"td")(23,"div",113)(24,"button",114),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.viewClientDetail(n))}),t.nrm(25,"i",115),t.k0s(),t.j41(26,"button",116),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.viewClientProjects(n))}),t.nrm(27,"i",117),t.k0s(),t.j41(28,"button",118),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.openInviteModal(n))}),t.nrm(29,"i",119),t.k0s(),t.j41(30,"button",120),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.openEditModal(n))}),t.nrm(31,"i",121),t.k0s(),t.j41(32,"button",122),t.nrm(33,"i",123),t.k0s()()()()}if(2&i){const e=o.$implicit,l=t.XpG();t.R7$(2),t.JRh(e.firstName),t.R7$(2),t.JRh(e.lastName),t.R7$(2),t.JRh(e.email||"N/A"),t.R7$(2),t.JRh(l.formatPhoneForDisplay(e.phone)),t.R7$(2),t.Y8G("ngClass","INDIVIDUAL"===e.entityType?"bg-primary":"bg-info"),t.R7$(),t.SpI(" ",e.entityType||"N/A"," "),t.R7$(2),t.Y8G("ngClass",l.getClientStatusClass(e.status)),t.R7$(),t.SpI(" ",l.getClientStatusText(e.status)," "),t.R7$(2),t.Y8G("ngClass",l.getInvitationStatusClass(e.invitationStatus)),t.R7$(),t.SpI(" ",l.getInvitationStatusText(e.invitationStatus)," "),t.R7$(),t.vxM(18,e.lastInvitedAt?18:-1),t.R7$(2),t.JRh(t.i5U(21,13,e.createdAt,"short")),t.R7$(8),t.Y8G("disabled","accepted"===e.invitationStatus)}}function G(i,o){1&i&&(t.j41(0,"tr")(1,"td",124)(2,"div",110),t.nrm(3,"i",125),t.EFF(4,' No clients found. Click "New Client" to add your first client. '),t.k0s()()())}function O(i,o){1&i&&t.EFF(0," First name is required. ")}function B(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,O,1,0),t.k0s()),2&i){let e;const l=t.XpG();t.R7$(),t.vxM(1,null!=(e=l.createClientForm.get("firstName"))&&null!=e.errors&&e.errors.required?1:-1)}}function L(i,o){1&i&&t.EFF(0," Last name is required. ")}function A(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,L,1,0),t.k0s()),2&i){let e;const l=t.XpG();t.R7$(),t.vxM(1,null!=(e=l.createClientForm.get("lastName"))&&null!=e.errors&&e.errors.required?1:-1)}}function V(i,o){1&i&&t.EFF(0," Email is required. ")}function X(i,o){1&i&&t.EFF(0," Please enter a valid email address. ")}function Y(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,V,1,0)(2,X,1,0),t.k0s()),2&i){let e,l;const n=t.XpG();t.R7$(),t.vxM(1,null!=(e=n.createClientForm.get("email"))&&null!=e.errors&&e.errors.required?1:-1),t.R7$(),t.vxM(2,null!=(l=n.createClientForm.get("email"))&&null!=l.errors&&l.errors.email?2:-1)}}function z(i,o){1&i&&t.EFF(0," Entity type is required. ")}function q(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,z,1,0),t.k0s()),2&i){let e;const l=t.XpG();t.R7$(),t.vxM(1,null!=(e=l.createClientForm.get("entityType"))&&null!=e.errors&&e.errors.required?1:-1)}}function U(i,o){1&i&&t.EFF(0," Status is required. ")}function J(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,U,1,0),t.k0s()),2&i){let e;const l=t.XpG();t.R7$(),t.vxM(1,null!=(e=l.createClientForm.get("status"))&&null!=e.errors&&e.errors.required?1:-1)}}function H(i,o){1&i&&(t.nrm(0,"span",126),t.EFF(1," Creating... "))}function K(i,o){1&i&&t.EFF(0," Add Client ")}function Q(i,o){1&i&&t.EFF(0," First name is required. ")}function Z(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,Q,1,0),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(1,null!=e.ef.firstName.errors&&e.ef.firstName.errors.required?1:-1)}}function W(i,o){1&i&&t.EFF(0," Last name is required. ")}function tt(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,W,1,0),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(1,null!=e.ef.lastName.errors&&e.ef.lastName.errors.required?1:-1)}}function et(i,o){1&i&&t.EFF(0," Please enter a valid email address. ")}function it(i,o){if(1&i&&(t.j41(0,"div",50),t.DNE(1,et,1,0),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.vxM(1,null!=e.ef.email.errors&&e.ef.email.errors.email?1:-1)}}function nt(i,o){1&i&&(t.nrm(0,"span",126),t.EFF(1," Updating... "))}function lt(i,o){1&i&&t.EFF(0," Update Client ")}function ot(i,o){if(1&i&&(t.j41(0,"div",106),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("Last sent: ",t.i5U(2,1,null==e.selectedClient?null:e.selectedClient.lastInvitedAt,"medium"),"")}}function st(i,o){1&i&&(t.nrm(0,"span",126),t.EFF(1," Resending... "))}function at(i,o){1&i&&(t.nrm(0,"i",128),t.EFF(1,"Resend Invitation "))}function rt(i,o){if(1&i&&(t.j41(0,"button",127),t.DNE(1,st,2,0)(2,at,2,0),t.k0s()),2&i){const e=t.XpG();t.Y8G("disabled",e.inviteLoading),t.R7$(),t.vxM(1,e.inviteLoading?1:2)}}function dt(i,o){1&i&&(t.nrm(0,"span",126),t.EFF(1," Sending... "))}function ct(i,o){1&i&&(t.nrm(0,"i",130),t.EFF(1,"Send Invitation "))}function mt(i,o){if(1&i&&(t.j41(0,"button",129),t.DNE(1,dt,2,0)(2,ct,2,0),t.k0s()),2&i){const e=t.XpG();t.Y8G("disabled",e.inviteLoading),t.R7$(),t.vxM(1,e.inviteLoading?1:2)}}let ut=(()=>{class i{constructor(e,l,n){this.apiService=e,this.formBuilder=l,this.router=n,this.clients=[],this.filteredClients=[],this.searchTerm="",this.statusFilter="all",this.statusOptions=[{value:"all",label:"All Clients"},{value:"lead",label:"Lead"},{value:"invited",label:"Invited"},{value:"active",label:"Active"},{value:"complete",label:"Complete"}],this.submitted=!1,this.loading=!1,this.error="",this.editSubmitted=!1,this.editLoading=!1,this.selectedClient=null,this.inviteSubmitted=!1,this.inviteLoading=!1}applyFilters(){let e=[...this.clients];if("all"!==this.statusFilter&&(e=e.filter(l=>l.status===this.statusFilter)),this.searchTerm.trim()){const l=this.searchTerm.toLowerCase();e=e.filter(n=>n.firstName?.toLowerCase().includes(l)||n.lastName?.toLowerCase().includes(l)||n.email?.toLowerCase().includes(l))}this.filteredClients=e}searchClients(){this.applyFilters()}onStatusFilterChange(){this.applyFilters()}ngOnInit(){this.breadCrumbItems=[{label:"Clients"},{label:"Clients List",active:!0}],this.createClientForm=this.formBuilder.group({firstName:["",[r.k0.required]],lastName:["",[r.k0.required]],email:["",[r.k0.required,r.k0.email]],phoneNumber:[""],entityType:["",[r.k0.required]],status:["lead",[r.k0.required]]}),this.editClientForm=this.formBuilder.group({firstName:["",[r.k0.required]],lastName:["",[r.k0.required]],email:["",[r.k0.email]],phoneNumber:[""],entityType:[""],status:[""]}),this.inviteClientForm=this.formBuilder.group({emailTemplate:[this.getDefaultEmailTemplate()]}),this.loadClients()}saveClient(){if(this.submitted=!0,this.createClientForm.valid){this.loading=!0,this.error="",this.apiService.debugTokenStatus();const e={email:this.createClientForm.value.email,firstName:this.createClientForm.value.firstName,lastName:this.createClientForm.value.lastName};this.createClientForm.value.phoneNumber&&this.createClientForm.value.phoneNumber.trim()&&(e.phone=this.cleanPhoneNumber(this.createClientForm.value.phoneNumber)),this.createClientForm.value.entityType&&(e.entityType=this.createClientForm.value.entityType),this.createClientForm.value.status&&(e.status=this.createClientForm.value.status),this.apiService.createClient(e).subscribe({next:l=>{this.loading=!1,l.success?(c().fire({title:"Success!",text:"Client has been created successfully.",icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),this.createClientForm.reset(),this.createClientForm.patchValue({entityType:"INDIVIDUAL",status:"lead"}),this.submitted=!1,this.loadClients(),this.newClientModal?.hide()):(this.error=l.message||"Failed to create client",c().fire({title:"Error!",text:this.error,icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"}))},error:l=>{this.loading=!1,console.error("Error creating client:",l);let n="Failed to create client. Please try again.";401===l.status||403===l.status?n="Authentication failed. Please log in again.":l.error?.message?n=l.error.message:l.message&&(n=l.message),this.error=n,c().fire({title:"Error!",text:n,icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"})}})}else console.log("Form is invalid"),Object.keys(this.createClientForm.controls).forEach(e=>{this.createClientForm.get(e)?.markAsTouched()})}loadClients(){this.apiService.getClients().subscribe({next:e=>{console.log("Clients response:",e),e.success&&e.clients?(this.clients=e.clients,this.applyFilters()):(console.warn("No clients found in response"),this.clients=[],this.filteredClients=[])},error:e=>{console.error("Error loading clients:",e),this.clients=[],this.filteredClients=[]}})}get f(){return this.createClientForm.controls}get ef(){return this.editClientForm.controls}formatPhoneNumber(e){let l=e.target.value.replace(/\D/g,"");l.length>=6?l=`(${l.slice(0,3)}) ${l.slice(3,6)}-${l.slice(6,10)}`:l.length>=3?l=`(${l.slice(0,3)}) ${l.slice(3)}`:l.length>0&&(l=`(${l}`),l.length>14&&(l=l.slice(0,14)),e.target.value=l,"client-phone-input"===e.target.id?this.createClientForm.patchValue({phoneNumber:l}):"editPhoneNumber"===e.target.id&&this.editClientForm.patchValue({phoneNumber:l})}cleanPhoneNumber(e){return e?e.replace(/\D/g,""):""}formatPhoneForDisplay(e){if(!e)return"";const l=e.replace(/\D/g,"");return 10===l.length?`(${l.slice(0,3)}) ${l.slice(3,6)}-${l.slice(6)}`:e}viewClientDetail(e){this.router.navigate(["/clients/detail",e.id])}viewClientProjects(e){this.router.navigate(["/tax-consultant/client-projects",e.id])}openEditModal(e){this.selectedClient=e;const l=this.formatPhoneForDisplay(e.phone||"");this.editClientForm.patchValue({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phoneNumber:l,entityType:e.entityType||"",status:e.status||""}),this.editSubmitted=!1,this.editClientModal?.show()}updateClient(){if(this.editSubmitted=!0,this.editClientForm.invalid)return;this.editLoading=!0;const e={firstName:this.ef.firstName.value,lastName:this.ef.lastName.value,email:this.ef.email.value||void 0,phone:this.ef.phoneNumber.value?this.cleanPhoneNumber(this.ef.phoneNumber.value):void 0,entityType:this.ef.entityType.value||void 0,status:this.ef.status.value||void 0};this.apiService.updateClient(this.selectedClient.id,e).subscribe({next:l=>{console.log("Client updated:",l),l.success?(c().fire({title:"Success!",text:"Client has been updated successfully.",icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),this.editClientModal?.hide(),this.loadClients(),this.editClientForm.reset(),this.selectedClient=null):c().fire({title:"Error!",text:l.message||"Failed to update client.",icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"}),this.editLoading=!1},error:l=>{console.error("Error updating client:",l),this.editLoading=!1;let n="Failed to update client. Please try again.";l.error?.message?n=l.error.message:l.message&&(n=l.message),c().fire({title:"Error!",text:n,icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"})}})}getDefaultEmailTemplate(){return"Dear {clientName},\n\nYou have been invited to access your client portal for Firm Pilot.\n\nAs a valued client, you now have secure access to:\n\u2022 View your account information\n\u2022 Upload and manage documents\n\u2022 Track the progress of your services\n\u2022 Communicate directly with our team\n\nTo get started, please click the link below to set up your account:\n{invitationLink}\n\nThis invitation will expire on {expiryDate}. If you have any questions, please don't hesitate to contact us.\n\nBest regards,\n{firmName}"}openInviteModal(e){this.selectedClient=e,this.inviteClientForm.patchValue({emailTemplate:this.getDefaultEmailTemplate()}),this.inviteSubmitted=!1,this.inviteClientModal?.show()}sendInvitation(){this.inviteSubmitted=!0,!this.inviteClientForm.invalid&&this.selectedClient?.id&&(this.inviteLoading=!0,this.apiService.inviteClient(this.selectedClient.id,{message:this.inviteClientForm.value.emailTemplate||void 0}).subscribe({next:l=>{console.log("Invitation sent:",l),l.success?(c().fire({title:"Success!",text:"Invitation has been sent successfully.",icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),this.inviteClientModal?.hide(),this.loadClients(),this.inviteClientForm.reset(),this.selectedClient=null):c().fire({title:"Error!",text:l.message||"Failed to send invitation.",icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"}),this.inviteLoading=!1},error:l=>{console.error("Error sending invitation:",l),this.inviteLoading=!1;let n="Failed to send invitation. Please try again.";401===l.status||403===l.status?n="Authentication failed. Please log in again.":l.error?.message?n=l.error.message:l.message&&(n=l.message),c().fire({title:"Error!",text:n,icon:"error",confirmButtonColor:"#d33",confirmButtonText:"OK"})}}))}getInvitationStatusClass(e){switch(e){case"pending":return"bg-warning";case"sent":return"bg-info";case"accepted":return"bg-success";case"expired":return"bg-danger";default:return"bg-secondary"}}getInvitationStatusText(e){switch(e){case"pending":return"Pending";case"sent":return"Sent";case"accepted":return"Accepted";case"expired":return"Expired";default:return"Not Invited"}}get if(){return this.inviteClientForm.controls}getClientStats(){return{total:this.clients.length,lead:this.clients.filter(a=>"lead"===a.status).length,invited:this.clients.filter(a=>"invited"===a.status).length,active:this.clients.filter(a=>"active"===a.status).length,complete:this.clients.filter(a=>"complete"===a.status).length}}getClientStatusClass(e){switch(e){case"lead":return"bg-warning";case"invited":return"bg-info";case"active":return"bg-success";case"complete":return"bg-primary";default:return"bg-secondary"}}getClientStatusText(e){switch(e){case"lead":return"Lead";case"invited":return"Invited";case"active":return"Active";case"complete":return"Complete";default:return"Unknown"}}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(b.G),t.rXU(r.ze),t.rXU(p.Ix))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-clientlist"]],viewQuery:function(l,n){if(1&l&&(t.GBs(T,5),t.GBs($,5),t.GBs(I,5)),2&l){let s;t.mGM(s=t.lsd())&&(n.newClientModal=s.first),t.mGM(s=t.lsd())&&(n.editClientModal=s.first),t.mGM(s=t.lsd())&&(n.inviteClientModal=s.first)}},standalone:!0,features:[t.aNF],decls:320,vars:60,consts:[["newClientModal","bs-modal"],["editClientModal","bs-modal"],["inviteClientModal","bs-modal"],[1,"container-fluid"],[1,"mt-5","pt-4"],["title","Clients List",3,"breadcrumbItems"],[1,"row","mb-4"],[1,"col-xl-3","col-md-6"],[1,"card"],[1,"card-body"],[1,"d-flex"],[1,"flex-1","overflow-hidden"],[1,"text-truncate","font-size-14","mb-2"],[1,"mb-0"],[1,"text-primary"],[1,"bx","bx-user","font-size-24"],[1,"text-warning"],[1,"bx","bx-user-plus","font-size-24"],[1,"text-success"],[1,"bx","bx-check-circle","font-size-24"],[1,"bx","bx-check-double","font-size-24"],[1,"row"],[1,"col-lg-12"],[1,"row","mb-2"],[1,"col-sm-4"],[1,"search-box","me-2","mb-2","d-inline-block"],[1,"position-relative"],["type","text","id","searchTableList","placeholder","Search clients...",1,"form-control",3,"ngModelChange","ngModel"],[1,"bx","bx-search-alt","search-icon"],[1,"form-select","form-select-primary",3,"ngModelChange","ngModel"],[1,"text-sm-end"],["type","button",1,"btn","btn-info","btn-rounded","waves-effect","waves-light","mb-2","me-2",3,"click"],[1,"mdi","mdi-refresh","me-1"],["type","button","data-bs-toggle","modal",1,"btn","btn-success","btn-rounded","waves-effect","waves-light","addClient-modal","mb-2",3,"click"],[1,"mdi","mdi-plus","me-1"],[1,"table-responsive"],[1,"table","table-nowrap","align-middle"],[1,"table-light"],["bsModal","","id","newClientModal","tabindex","-1","aria-labelledby","newClientModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","newClientModalLabel",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["autocomplete","off","id","createClient-form","novalidate","",1,"needs-validation","createClient-form",3,"ngSubmit","formGroup"],[1,"col-lg-6"],[1,"mb-3"],["for","client-firstName-input",1,"form-label"],["type","text","id","client-firstName-input","placeholder","Enter first name","formControlName","firstName","required","",1,"form-control"],[1,"invalid-feedback"],["for","client-lastName-input",1,"form-label"],["type","text","id","client-lastName-input","placeholder","Enter last name","formControlName","lastName","required","",1,"form-control"],["for","client-email-input",1,"form-label"],[1,"text-danger"],["type","email","id","client-email-input","placeholder","Enter email address","formControlName","email","required","",1,"form-control"],["for","client-phone-input",1,"form-label"],["type","tel","id","client-phone-input","placeholder","(XXX) XXX-XXXX","formControlName","phoneNumber","maxlength","14",1,"form-control",3,"input"],["for","client-entityType-input",1,"form-label"],["id","client-entityType-input","formControlName","entityType","required","",1,"form-select"],["value",""],["value","INDIVIDUAL"],["value","BUSINESS"],["value","CORPORATION"],["value","PARTNERSHIP"],["value","LLC"],["for","client-status-input",1,"form-label"],["id","client-status-input","formControlName","status","required","",1,"form-select"],["value","lead"],["value","invited"],["value","active"],["value","inactive"],["value","suspended"],[1,"text-end"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],["type","submit","id","addClient-btn",1,"btn","btn-success",3,"disabled"],["bsModal","","id","editClientModal","tabindex","-1","aria-labelledby","editClientModalLabel","aria-hidden","true",1,"modal","fade"],["id","editClientModalLabel",1,"modal-title"],[3,"ngSubmit","formGroup"],["for","editFirstName",1,"form-label"],["type","text","id","editFirstName","formControlName","firstName",1,"form-control"],["for","editLastName",1,"form-label"],["type","text","id","editLastName","formControlName","lastName",1,"form-control"],["for","editEmail",1,"form-label"],["type","email","id","editEmail","formControlName","email",1,"form-control"],["for","editPhoneNumber",1,"form-label"],["type","tel","id","editPhoneNumber","formControlName","phoneNumber","placeholder","(XXX) XXX-XXXX","maxlength","14",1,"form-control",3,"input"],["for","editEntityType",1,"form-label"],["id","editEntityType","formControlName","entityType",1,"form-select"],["for","editStatus",1,"form-label"],["id","editStatus","formControlName","status",1,"form-select"],["type","submit","id","updateClient-btn",1,"btn","btn-primary",3,"disabled"],["bsModal","","id","inviteClientModal","tabindex","-1","aria-labelledby","inviteClientModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-lg"],["id","inviteClientModalLabel",1,"modal-title"],[1,"bx","bx-mail-send","me-2"],["autocomplete","off","id","inviteClient-form","novalidate","",1,"needs-validation","inviteClient-form",3,"ngSubmit","formGroup"],[1,"col-12"],[1,"card","bg-light"],[1,"card-body","p-3"],[1,"card-title","mb-2"],[1,"col-md-6"],[1,"mb-1"],[1,"badge",3,"ngClass"],[1,"form-label"],[1,"mt-2"],[1,"text-muted","small","mt-1"],["for","invite-template-input",1,"form-label"],["id","invite-template-input","rows","8","formControlName","emailTemplate","placeholder","Customize the invitation email...",1,"form-control"],[1,"form-text"],[1,"text-muted"],["type","submit",1,"btn","btn-warning"],[3,"value"],[1,"d-flex","gap-2"],["type","button","title","View Client Details",1,"btn","btn-sm","btn-outline-success",3,"click"],[1,"bx","bx-show"],["type","button","title","View Client Projects",1,"btn","btn-sm","btn-outline-info",3,"click"],[1,"bx","bx-briefcase"],["type","button","title","Send Invitation Email",1,"btn","btn-sm","btn-outline-primary",3,"click","disabled"],[1,"bx","bx-mail-send"],["type","button","title","Edit Client Details",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bx","bx-pencil"],["type","button","title","Delete Client",1,"btn","btn-sm","btn-outline-danger"],[1,"bx","bx-trash"],["colspan","9",1,"text-center","py-4"],[1,"bx","bx-user-plus","font-size-48","text-muted","d-block","mb-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],["type","submit",1,"btn","btn-warning",3,"disabled"],[1,"bx","bx-refresh","me-1"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"bx","bx-mail-send","me-1"]],template:function(l,n){if(1&l){const s=t.RV6();t.j41(0,"div",3)(1,"div",4),t.nrm(2,"app-page-title",5),t.k0s(),t.j41(3,"div",6)(4,"div",7)(5,"div",8)(6,"div",9)(7,"div",10)(8,"div",11)(9,"p",12),t.EFF(10,"Total Clients"),t.k0s(),t.j41(11,"h4",13),t.EFF(12),t.k0s()(),t.j41(13,"div",14),t.nrm(14,"i",15),t.k0s()()()()(),t.j41(15,"div",7)(16,"div",8)(17,"div",9)(18,"div",10)(19,"div",11)(20,"p",12),t.EFF(21,"Leads"),t.k0s(),t.j41(22,"h4",13),t.EFF(23),t.k0s()(),t.j41(24,"div",16),t.nrm(25,"i",17),t.k0s()()()()(),t.j41(26,"div",7)(27,"div",8)(28,"div",9)(29,"div",10)(30,"div",11)(31,"p",12),t.EFF(32,"Active"),t.k0s(),t.j41(33,"h4",13),t.EFF(34),t.k0s()(),t.j41(35,"div",18),t.nrm(36,"i",19),t.k0s()()()()(),t.j41(37,"div",7)(38,"div",8)(39,"div",9)(40,"div",10)(41,"div",11)(42,"p",12),t.EFF(43,"Complete"),t.k0s(),t.j41(44,"h4",13),t.EFF(45),t.k0s()(),t.j41(46,"div",14),t.nrm(47,"i",20),t.k0s()()()()()(),t.j41(48,"div",21)(49,"div",22)(50,"div",8)(51,"div",9)(52,"div",23)(53,"div",24)(54,"div",25)(55,"div",26)(56,"input",27),t.mxI("ngModelChange",function(a){return t.eBV(s),t.DH7(n.searchTerm,a)||(n.searchTerm=a),t.Njj(a)}),t.bIt("ngModelChange",function(){return t.eBV(s),t.Njj(n.searchClients())}),t.k0s(),t.nrm(57,"i",28),t.k0s()()(),t.j41(58,"div",24)(59,"select",29),t.mxI("ngModelChange",function(a){return t.eBV(s),t.DH7(n.statusFilter,a)||(n.statusFilter=a),t.Njj(a)}),t.bIt("ngModelChange",function(){return t.eBV(s),t.Njj(n.onStatusFilterChange())}),t.Z7z(60,M,2,2,"option",null,D),t.k0s()(),t.j41(62,"div",24)(63,"div",30)(64,"button",31),t.bIt("click",function(){return t.eBV(s),t.Njj(n.loadClients())}),t.nrm(65,"i",32),t.EFF(66," Refresh "),t.k0s(),t.j41(67,"button",33),t.bIt("click",function(){t.eBV(s);const a=t.sdS(97);return t.Njj(a.show())}),t.nrm(68,"i",34),t.EFF(69," New Client"),t.k0s()()()(),t.j41(70,"div",35)(71,"table",36)(72,"thead",37)(73,"tr")(74,"th"),t.EFF(75,"First Name"),t.k0s(),t.j41(76,"th"),t.EFF(77,"Last Name"),t.k0s(),t.j41(78,"th"),t.EFF(79,"Email"),t.k0s(),t.j41(80,"th"),t.EFF(81,"Phone Number"),t.k0s(),t.j41(82,"th"),t.EFF(83,"Entity Type"),t.k0s(),t.j41(84,"th"),t.EFF(85,"Status"),t.k0s(),t.j41(86,"th"),t.EFF(87,"Invitation"),t.k0s(),t.j41(88,"th"),t.EFF(89,"Created Date"),t.k0s(),t.j41(90,"th"),t.EFF(91,"Actions"),t.k0s()()(),t.j41(92,"tbody"),t.Z7z(93,P,34,16,"tr",null,S,!1,G,5,0,"tr"),t.k0s()()()()()()()(),t.j41(96,"div",38,0)(98,"div",39)(99,"div",40)(100,"div",41)(101,"h5",42),t.EFF(102,"Add New Client"),t.k0s(),t.j41(103,"button",43),t.bIt("click",function(){t.eBV(s);const a=t.sdS(97);return t.Njj(a.hide())}),t.k0s()(),t.j41(104,"div",44)(105,"form",45),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(n.saveClient())}),t.j41(106,"div",21)(107,"div",46)(108,"div",47)(109,"label",48),t.EFF(110,"First Name"),t.k0s(),t.nrm(111,"input",49),t.DNE(112,B,2,1,"div",50),t.k0s()(),t.j41(113,"div",46)(114,"div",47)(115,"label",51),t.EFF(116,"Last Name"),t.k0s(),t.nrm(117,"input",52),t.DNE(118,A,2,1,"div",50),t.k0s()(),t.j41(119,"div",46)(120,"div",47)(121,"label",53),t.EFF(122,"Email Address "),t.j41(123,"span",54),t.EFF(124,"*"),t.k0s()(),t.nrm(125,"input",55),t.DNE(126,Y,3,2,"div",50),t.k0s()(),t.j41(127,"div",46)(128,"div",47)(129,"label",56),t.EFF(130,"Phone Number"),t.k0s(),t.j41(131,"input",57),t.bIt("input",function(a){return t.eBV(s),t.Njj(n.formatPhoneNumber(a))}),t.k0s()()(),t.j41(132,"div",46)(133,"div",47)(134,"label",58),t.EFF(135,"Entity Type "),t.j41(136,"span",54),t.EFF(137,"*"),t.k0s()(),t.j41(138,"select",59)(139,"option",60),t.EFF(140,"Select Entity Type"),t.k0s(),t.j41(141,"option",61),t.EFF(142,"Individual"),t.k0s(),t.j41(143,"option",62),t.EFF(144,"Business"),t.k0s(),t.j41(145,"option",63),t.EFF(146,"Corporation"),t.k0s(),t.j41(147,"option",64),t.EFF(148,"Partnership"),t.k0s(),t.j41(149,"option",65),t.EFF(150,"LLC"),t.k0s()(),t.DNE(151,q,2,1,"div",50),t.k0s()(),t.j41(152,"div",46)(153,"div",47)(154,"label",66),t.EFF(155,"Status "),t.j41(156,"span",54),t.EFF(157,"*"),t.k0s()(),t.j41(158,"select",67)(159,"option",60),t.EFF(160,"Select Status"),t.k0s(),t.j41(161,"option",68),t.EFF(162,"Lead"),t.k0s(),t.j41(163,"option",69),t.EFF(164,"Invited"),t.k0s(),t.j41(165,"option",70),t.EFF(166,"Active"),t.k0s(),t.j41(167,"option",71),t.EFF(168,"Inactive"),t.k0s(),t.j41(169,"option",72),t.EFF(170,"Suspended"),t.k0s()(),t.DNE(171,J,2,1,"div",50),t.k0s()(),t.j41(172,"div",22)(173,"div",73)(174,"button",74),t.bIt("click",function(){t.eBV(s);const a=t.sdS(97);return t.Njj(a.hide())}),t.EFF(175,"Cancel"),t.k0s(),t.j41(176,"button",75),t.DNE(177,H,2,0)(178,K,1,0),t.k0s()()()()()()()()(),t.j41(179,"div",76,1)(181,"div",39)(182,"div",40)(183,"div",41)(184,"h5",77),t.EFF(185,"Edit Client"),t.k0s(),t.j41(186,"button",43),t.bIt("click",function(){t.eBV(s);const a=t.sdS(180);return t.Njj(a.hide())}),t.k0s()(),t.j41(187,"div",44)(188,"form",78),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(n.updateClient())}),t.j41(189,"div",21)(190,"div",46)(191,"div",47)(192,"label",79),t.EFF(193,"First Name "),t.j41(194,"span",54),t.EFF(195,"*"),t.k0s()(),t.nrm(196,"input",80),t.DNE(197,Z,2,1,"div",50),t.k0s()(),t.j41(198,"div",46)(199,"div",47)(200,"label",81),t.EFF(201,"Last Name "),t.j41(202,"span",54),t.EFF(203,"*"),t.k0s()(),t.nrm(204,"input",82),t.DNE(205,tt,2,1,"div",50),t.k0s()(),t.j41(206,"div",46)(207,"div",47)(208,"label",83),t.EFF(209,"Email"),t.k0s(),t.nrm(210,"input",84),t.DNE(211,it,2,1,"div",50),t.k0s()(),t.j41(212,"div",46)(213,"div",47)(214,"label",85),t.EFF(215,"Phone Number"),t.k0s(),t.j41(216,"input",86),t.bIt("input",function(a){return t.eBV(s),t.Njj(n.formatPhoneNumber(a))}),t.k0s()()(),t.j41(217,"div",46)(218,"div",47)(219,"label",87),t.EFF(220,"Entity Type"),t.k0s(),t.j41(221,"select",88)(222,"option",60),t.EFF(223,"Select Entity Type"),t.k0s(),t.j41(224,"option",61),t.EFF(225,"Individual"),t.k0s(),t.j41(226,"option",62),t.EFF(227,"Business"),t.k0s(),t.j41(228,"option",63),t.EFF(229,"Corporation"),t.k0s(),t.j41(230,"option",64),t.EFF(231,"Partnership"),t.k0s(),t.j41(232,"option",65),t.EFF(233,"LLC"),t.k0s()()()(),t.j41(234,"div",46)(235,"div",47)(236,"label",89),t.EFF(237,"Status"),t.k0s(),t.j41(238,"select",90)(239,"option",60),t.EFF(240,"Select Status"),t.k0s(),t.j41(241,"option",68),t.EFF(242,"Lead"),t.k0s(),t.j41(243,"option",69),t.EFF(244,"Invited"),t.k0s(),t.j41(245,"option",70),t.EFF(246,"Active"),t.k0s(),t.j41(247,"option",71),t.EFF(248,"Inactive"),t.k0s(),t.j41(249,"option",72),t.EFF(250,"Suspended"),t.k0s()()()(),t.j41(251,"div",22)(252,"div",73)(253,"button",74),t.bIt("click",function(){t.eBV(s);const a=t.sdS(180);return t.Njj(a.hide())}),t.EFF(254,"Cancel"),t.k0s(),t.j41(255,"button",91),t.DNE(256,nt,2,0)(257,lt,1,0),t.k0s()()()()()()()()(),t.j41(258,"div",92,2)(260,"div",93)(261,"div",40)(262,"div",41)(263,"h5",94),t.nrm(264,"i",95),t.EFF(265,"Send Client Invitation "),t.k0s(),t.j41(266,"button",43),t.bIt("click",function(){t.eBV(s);const a=t.sdS(259);return t.Njj(a.hide())}),t.k0s()(),t.j41(267,"div",44)(268,"form",96),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(n.sendInvitation())}),t.j41(269,"div",6)(270,"div",97)(271,"div",98)(272,"div",99)(273,"h6",100),t.EFF(274,"Client Information"),t.k0s(),t.j41(275,"div",21)(276,"div",101)(277,"p",102)(278,"strong"),t.EFF(279,"Name:"),t.k0s(),t.EFF(280),t.k0s(),t.j41(281,"p",102)(282,"strong"),t.EFF(283,"Email:"),t.k0s(),t.EFF(284),t.k0s()(),t.j41(285,"div",101)(286,"p",102)(287,"strong"),t.EFF(288,"Entity Type:"),t.k0s(),t.EFF(289),t.k0s(),t.j41(290,"p",102)(291,"strong"),t.EFF(292,"Status:"),t.k0s(),t.j41(293,"span",103),t.EFF(294),t.k0s()()()()()()()(),t.j41(295,"div",21)(296,"div",97)(297,"div",47)(298,"label",104),t.EFF(299,"Current Invitation Status"),t.k0s(),t.j41(300,"div",105)(301,"span",103),t.EFF(302),t.k0s(),t.DNE(303,ot,3,4,"div",106),t.k0s()()()(),t.j41(304,"div",21)(305,"div",97)(306,"div",47)(307,"label",107),t.EFF(308,"Email Template"),t.k0s(),t.nrm(309,"textarea",108),t.j41(310,"div",109)(311,"small",110),t.EFF(312),t.k0s()()()()(),t.j41(313,"div",21)(314,"div",97)(315,"div",73)(316,"button",74),t.bIt("click",function(){t.eBV(s);const a=t.sdS(259);return t.Njj(a.hide())}),t.EFF(317,"Cancel"),t.k0s(),t.DNE(318,rt,3,2,"button",111)(319,mt,3,2),t.k0s()()()()()()()()}if(2&l){let s,d,a,g,h,k,j,E,x,N;t.R7$(2),t.Y8G("breadcrumbItems",n.breadCrumbItems),t.R7$(10),t.JRh(n.getClientStats().total),t.R7$(11),t.JRh(n.getClientStats().lead),t.R7$(11),t.JRh(n.getClientStats().active),t.R7$(11),t.JRh(n.getClientStats().complete),t.R7$(11),t.R50("ngModel",n.searchTerm),t.R7$(3),t.R50("ngModel",n.statusFilter),t.R7$(),t.Dyx(n.statusOptions),t.R7$(33),t.Dyx(n.filteredClients),t.R7$(12),t.Y8G("formGroup",n.createClientForm),t.R7$(6),t.AVh("is-invalid",n.submitted&&(null==(s=n.createClientForm.get("firstName"))?null:s.errors)),t.R7$(),t.vxM(112,n.submitted&&null!=(d=n.createClientForm.get("firstName"))&&d.errors?112:-1),t.R7$(5),t.AVh("is-invalid",n.submitted&&(null==(a=n.createClientForm.get("lastName"))?null:a.errors)),t.R7$(),t.vxM(118,n.submitted&&null!=(g=n.createClientForm.get("lastName"))&&g.errors?118:-1),t.R7$(7),t.AVh("is-invalid",n.submitted&&(null==(h=n.createClientForm.get("email"))?null:h.errors)),t.R7$(),t.vxM(126,n.submitted&&null!=(k=n.createClientForm.get("email"))&&k.errors?126:-1),t.R7$(12),t.AVh("is-invalid",n.submitted&&(null==(j=n.createClientForm.get("entityType"))?null:j.errors)),t.R7$(13),t.vxM(151,n.submitted&&null!=(E=n.createClientForm.get("entityType"))&&E.errors?151:-1),t.R7$(7),t.AVh("is-invalid",n.submitted&&(null==(x=n.createClientForm.get("status"))?null:x.errors)),t.R7$(13),t.vxM(171,n.submitted&&null!=(N=n.createClientForm.get("status"))&&N.errors?171:-1),t.R7$(3),t.Y8G("disabled",n.loading),t.R7$(2),t.Y8G("disabled",n.loading),t.R7$(),t.vxM(177,n.loading?177:178),t.R7$(11),t.Y8G("formGroup",n.editClientForm),t.R7$(8),t.AVh("is-invalid",n.editSubmitted&&n.ef.firstName.errors),t.R7$(),t.vxM(197,n.editSubmitted&&n.ef.firstName.errors?197:-1),t.R7$(7),t.AVh("is-invalid",n.editSubmitted&&n.ef.lastName.errors),t.R7$(),t.vxM(205,n.editSubmitted&&n.ef.lastName.errors?205:-1),t.R7$(5),t.AVh("is-invalid",n.editSubmitted&&n.ef.email.errors),t.R7$(),t.vxM(211,n.editSubmitted&&n.ef.email.errors?211:-1),t.R7$(42),t.Y8G("disabled",n.editLoading),t.R7$(2),t.Y8G("disabled",n.editLoading),t.R7$(),t.vxM(256,n.editLoading?256:257),t.R7$(12),t.Y8G("formGroup",n.inviteClientForm),t.R7$(12),t.Lme(" ",null==n.selectedClient?null:n.selectedClient.firstName," ",null==n.selectedClient?null:n.selectedClient.lastName,""),t.R7$(4),t.SpI(" ",null==n.selectedClient?null:n.selectedClient.email,""),t.R7$(5),t.SpI(" ",(null==n.selectedClient?null:n.selectedClient.entityType)||"N/A",""),t.R7$(4),t.Y8G("ngClass","lead"===(null==n.selectedClient?null:n.selectedClient.status)?"bg-info":"active"===(null==n.selectedClient?null:n.selectedClient.status)?"bg-success":"bg-secondary"),t.R7$(),t.SpI(" ",(null==n.selectedClient?null:n.selectedClient.status)||"N/A"," "),t.R7$(7),t.Y8G("ngClass",n.getInvitationStatusClass(null==n.selectedClient?null:n.selectedClient.invitationStatus)),t.R7$(),t.SpI(" ",n.getInvitationStatusText(null==n.selectedClient?null:n.selectedClient.invitationStatus)," "),t.R7$(),t.vxM(303,null!=n.selectedClient&&n.selectedClient.lastInvitedAt?303:-1),t.R7$(9),t.Ld(" Available variables: ","{","clientName","}",", ","{","firmName","}",", ","{","invitationLink","}",", ","{","expiryDate","}"," "),t.R7$(4),t.Y8G("disabled",n.inviteLoading),t.R7$(2),t.vxM(318,"pending"===(null==n.selectedClient?null:n.selectedClient.invitationStatus)||"sent"===(null==n.selectedClient?null:n.selectedClient.invitationStatus)?318:319)}},dependencies:[u.MD,u.YU,u.vh,r.YN,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.YS,r.tU,r.vS,r.X1,r.j4,r.JD,y.T,f.Q_,f.hZ]})}}return i})();var pt=m(1413),_=m(6977);const ft=["editClientModal"];function _t(i,o){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Lme("",e.client.firstName," ",e.client.lastName,"")}}function vt(i,o){1&i&&(t.j41(0,"span"),t.EFF(1,"Client Details"),t.k0s())}function bt(i,o){if(1&i){const e=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.sendEmail())}),t.nrm(1,"i",50),t.EFF(2," Send Email "),t.k0s()}}function Ct(i,o){if(1&i){const e=t.RV6();t.j41(0,"button",51),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.openEditModal())}),t.nrm(1,"i",52),t.EFF(2," Edit Client "),t.k0s()}}function Ft(i,o){if(1&i){const e=t.RV6();t.j41(0,"button",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.viewAllProjects())}),t.nrm(1,"i",54),t.EFF(2," All Projects "),t.k0s()}}function gt(i,o){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",55)(3,"div",56)(4,"div",57)(5,"span",58),t.EFF(6,"Loading..."),t.k0s()(),t.j41(7,"p",59),t.EFF(8,"Loading client details..."),t.k0s()()()()())}function ht(i,o){if(1&i&&(t.j41(0,"div",94)(1,"div",95)(2,"span",96),t.nrm(3,"i",97),t.k0s()(),t.j41(4,"div",98)(5,"h6",99),t.EFF(6),t.k0s(),t.j41(7,"p",75)(8,"span"),t.EFF(9),t.k0s()()()()),2&i){const e=o.$implicit,l=t.XpG(4);t.R7$(6),t.JRh(e.name),t.R7$(2),t.HbH(l.getProjectStatusClass(e.status)),t.R7$(),t.SpI(" ",l.getProjectStatusLabel(e.status)," ")}}function kt(i,o){if(1&i&&(t.j41(0,"div"),t.DNE(1,ht,10,4,"div",93),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngForOf",e.projects.slice(0,3))}}function jt(i,o){1&i&&(t.j41(0,"div",100),t.nrm(1,"i",101),t.EFF(2," No projects yet "),t.k0s())}function Et(i,o){if(1&i&&(t.j41(0,"div",94)(1,"div",95)(2,"span",102),t.nrm(3,"i",103),t.k0s()(),t.j41(4,"div",98)(5,"h6",99),t.EFF(6),t.k0s(),t.j41(7,"p",75)(8,"span"),t.EFF(9),t.nI1(10,"titlecase"),t.k0s()()()()),2&i){const e=o.$implicit,l=t.XpG(4);t.R7$(6),t.JRh(e.form.title),t.R7$(2),t.HbH(l.getIntakeFormStatusClass((null==e.response?null:e.response.status)||"draft")),t.R7$(),t.SpI(" ",t.bMT(10,4,(null==e.response?null:e.response.status)||"draft")," ")}}function xt(i,o){if(1&i&&(t.j41(0,"div"),t.DNE(1,Et,11,6,"div",93),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngForOf",e.intakeForms.slice(0,3))}}function Nt(i,o){1&i&&(t.j41(0,"div",100),t.nrm(1,"i",104),t.EFF(2," No forms yet "),t.k0s())}function yt(i,o){if(1&i&&(t.j41(0,"div")(1,"h5",90),t.EFF(2,"Client Overview"),t.k0s(),t.j41(3,"div",2)(4,"div",91)(5,"h6",22),t.EFF(6,"Recent Projects"),t.k0s(),t.DNE(7,kt,2,1,"div",7)(8,jt,3,0,"div",92),t.k0s(),t.j41(9,"div",91)(10,"h6",22),t.EFF(11,"Recent Forms"),t.k0s(),t.DNE(12,xt,2,1,"div",7)(13,Nt,3,0,"div",92),t.k0s()()()),2&i){const e=t.XpG(2);t.R7$(7),t.Y8G("ngIf",e.projects.length>0),t.R7$(),t.Y8G("ngIf",0===e.projects.length),t.R7$(4),t.Y8G("ngIf",e.intakeForms.length>0),t.R7$(),t.Y8G("ngIf",0===e.intakeForms.length)}}function Rt(i,o){if(1&i&&(t.j41(0,"p",75),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.description," ")}}function Tt(i,o){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"h6",99),t.EFF(3),t.k0s(),t.DNE(4,Rt,2,1,"p",114),t.k0s(),t.j41(5,"td")(6,"span",115),t.EFF(7),t.k0s()(),t.j41(8,"td")(9,"span"),t.EFF(10),t.k0s()(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td")(14,"button",116),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.viewProject(n))}),t.nrm(15,"i",117),t.k0s()()()}if(2&i){const e=o.$implicit,l=t.XpG(4);t.R7$(3),t.JRh(e.name),t.R7$(),t.Y8G("ngIf",e.description),t.R7$(3),t.JRh(l.getProjectTypeLabel(e.projectType)),t.R7$(2),t.HbH(l.getProjectStatusClass(e.status)),t.R7$(),t.SpI(" ",l.getProjectStatusLabel(e.status)," "),t.R7$(2),t.JRh(l.formatDate(e.dueDate||""))}}function $t(i,o){if(1&i&&(t.j41(0,"div",67)(1,"table",111)(2,"thead",112)(3,"tr")(4,"th"),t.EFF(5,"Project Name"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Type"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Status"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Due Date"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Actions"),t.k0s()()(),t.j41(14,"tbody"),t.DNE(15,Tt,16,7,"tr",113),t.k0s()()()),2&i){const e=t.XpG(3);t.R7$(15),t.Y8G("ngForOf",e.projects)}}function It(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",118),t.nrm(1,"i",119),t.j41(2,"h5"),t.EFF(3,"No Projects Yet"),t.k0s(),t.j41(4,"p",70),t.EFF(5,"This client doesn't have any projects. Create one to get started."),t.k0s(),t.j41(6,"button",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.viewAllProjects())}),t.nrm(7,"i",108),t.EFF(8," Create First Project "),t.k0s()()}}function Dt(i,o){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"div",105)(2,"h5",106),t.EFF(3),t.k0s(),t.j41(4,"button",107),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.viewAllProjects())}),t.nrm(5,"i",108),t.EFF(6," New Project "),t.k0s()(),t.DNE(7,$t,16,1,"div",109)(8,It,9,0,"div",110),t.k0s()}if(2&i){const e=t.XpG(2);t.R7$(3),t.SpI("Projects (",e.projects.length,")"),t.R7$(4),t.Y8G("ngIf",e.projects.length>0),t.R7$(),t.Y8G("ngIf",0===e.projects.length)}}function St(i,o){if(1&i&&(t.j41(0,"p",129),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,l=t.XpG(4);t.R7$(),t.SpI(" Submitted: ",l.formatDate(e.response.submittedAt)," ")}}function Mt(i,o){1&i&&(t.j41(0,"p",129),t.EFF(1," Not started yet "),t.k0s())}function wt(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",122)(1,"div",123)(2,"div",61)(3,"div",124)(4,"h6",106),t.EFF(5),t.k0s(),t.j41(6,"span"),t.EFF(7),t.nI1(8,"titlecase"),t.k0s()(),t.j41(9,"p",125)(10,"strong"),t.EFF(11,"Project:"),t.k0s(),t.EFF(12),t.k0s(),t.DNE(13,St,2,1,"p",126)(14,Mt,2,0,"p",126),t.j41(15,"button",127),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.openIntakeForm(n))}),t.nrm(16,"i",128),t.EFF(17),t.k0s()()()()}if(2&i){const e=o.$implicit,l=t.XpG(4);t.R7$(5),t.JRh(e.form.title),t.R7$(),t.HbH(l.getIntakeFormStatusClass((null==e.response?null:e.response.status)||"draft")),t.R7$(),t.SpI(" ",t.bMT(8,8,(null==e.response?null:e.response.status)||"draft")," "),t.R7$(5),t.SpI(" ",e.projectName," "),t.R7$(),t.Y8G("ngIf",null==e.response?null:e.response.submittedAt),t.R7$(),t.Y8G("ngIf",!e.response),t.R7$(3),t.SpI(" ",e.response?"View Form":"Open Form"," ")}}function Pt(i,o){if(1&i&&(t.j41(0,"div",2),t.DNE(1,wt,18,10,"div",121),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.Y8G("ngForOf",e.intakeForms)}}function Gt(i,o){1&i&&(t.j41(0,"div",118),t.nrm(1,"i",130),t.j41(2,"h5"),t.EFF(3,"No Intake Forms"),t.k0s(),t.j41(4,"p",70),t.EFF(5,"No intake forms have been created for this client yet."),t.k0s()())}function Ot(i,o){if(1&i&&(t.j41(0,"div")(1,"div",105)(2,"h5",106),t.EFF(3),t.k0s()(),t.DNE(4,Pt,2,1,"div",12)(5,Gt,6,0,"div",110),t.k0s()),2&i){const e=t.XpG(2);t.R7$(3),t.SpI("Intake Forms (",e.intakeForms.length,")"),t.R7$(),t.Y8G("ngIf",e.intakeForms.length>0),t.R7$(),t.Y8G("ngIf",0===e.intakeForms.length)}}function Bt(i,o){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"div",132)(3,"div",95)(4,"span",133),t.nrm(5,"i",103),t.k0s()(),t.j41(6,"div")(7,"h6",134),t.EFF(8),t.k0s(),t.j41(9,"p",75),t.EFF(10),t.k0s()()()(),t.j41(11,"td")(12,"span",115),t.EFF(13),t.k0s()(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td")(17,"span"),t.EFF(18),t.k0s()(),t.j41(19,"td"),t.EFF(20),t.k0s(),t.j41(21,"td")(22,"button",135),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.downloadDocument(n))}),t.nrm(23,"i",136),t.j41(24,"span",137),t.EFF(25,"Download"),t.k0s()()()()}if(2&i){const e=o.$implicit,l=t.XpG(4);t.R7$(8),t.JRh(e.filename),t.R7$(2),t.JRh(e.mimeType),t.R7$(3),t.JRh(e.tag),t.R7$(2),t.JRh(l.formatFileSize(e.sizeBytes)),t.R7$(2),t.HbH(e.required?"badge bg-warning":"badge bg-secondary"),t.R7$(),t.SpI(" ",e.required?"Required":"Optional"," "),t.R7$(2),t.JRh(l.formatDate(e.uploadedAt)),t.R7$(2),t.Mz_("title","Download ",e.filename,"")}}function Lt(i,o){if(1&i&&(t.j41(0,"div",67)(1,"table",111)(2,"thead",112)(3,"tr")(4,"th"),t.EFF(5,"Document Name"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Tag"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Size"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Required"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Uploaded"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Actions"),t.k0s()()(),t.j41(16,"tbody"),t.DNE(17,Bt,26,10,"tr",113),t.k0s()()()),2&i){const e=t.XpG(3);t.R7$(17),t.Y8G("ngForOf",e.documents)}}function At(i,o){if(1&i&&(t.j41(0,"span",147),t.EFF(1),t.k0s()),2&i){const e=t.XpG().$implicit,l=t.XpG(4);t.R7$(),t.SpI(" Due: ",l.formatDate(e.dueDate)," ")}}function Vt(i,o){if(1&i&&(t.j41(0,"div",140)(1,"div",123)(2,"div",141)(3,"div",142)(4,"div",98)(5,"h6",99),t.EFF(6),t.k0s(),t.j41(7,"p",143),t.EFF(8),t.k0s(),t.j41(9,"div",144)(10,"span"),t.EFF(11),t.k0s(),t.DNE(12,At,2,1,"span",145),t.k0s()(),t.j41(13,"div",45),t.nrm(14,"i",146),t.k0s()()()()()),2&i){const e=o.$implicit;t.R7$(),t.AVh("border-success",e.fulfilled)("border-warning",!e.fulfilled),t.R7$(5),t.JRh(e.documentType),t.R7$(2),t.JRh(e.description),t.R7$(2),t.HbH(e.fulfilled?"badge bg-success":"badge bg-warning"),t.R7$(),t.SpI(" ",e.fulfilled?"Fulfilled":"Required"," "),t.R7$(),t.Y8G("ngIf",e.dueDate),t.R7$(2),t.HbH(e.fulfilled?"bx bx-check-circle text-success":"bx bx-time text-warning")}}function Xt(i,o){if(1&i&&(t.j41(0,"div",138)(1,"h6",22),t.EFF(2,"Document Requirements"),t.k0s(),t.j41(3,"div",2),t.DNE(4,Vt,15,12,"div",139),t.k0s()()),2&i){const e=t.XpG(3);t.R7$(4),t.Y8G("ngForOf",e.documentRequirements)}}function Yt(i,o){1&i&&(t.j41(0,"div",118),t.nrm(1,"i",148),t.j41(2,"h5"),t.EFF(3,"No Documents"),t.k0s(),t.j41(4,"p",70),t.EFF(5,"No documents have been uploaded for this client yet."),t.k0s()())}function zt(i,o){if(1&i&&(t.j41(0,"div")(1,"div",105)(2,"h5",106),t.EFF(3),t.k0s()(),t.DNE(4,Lt,18,1,"div",109)(5,Xt,5,1,"div",131)(6,Yt,6,0,"div",110),t.k0s()),2&i){const e=t.XpG(2);t.R7$(3),t.SpI("Documents (",e.documents.length,")"),t.R7$(),t.Y8G("ngIf",e.documents.length>0),t.R7$(),t.Y8G("ngIf",e.documentRequirements.length>0),t.R7$(),t.Y8G("ngIf",0===e.documents.length&&0===e.documentRequirements.length)}}function qt(i,o){if(1&i&&(t.j41(0,"p",153)(1,"strong"),t.EFF(2,"Accepted:"),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(4);t.R7$(3),t.SpI(" ",e.formatDate(e.invitation.acceptedAt)," ")}}function Ut(i,o){if(1&i&&(t.j41(0,"p",153)(1,"strong"),t.EFF(2,"Last Resent:"),t.k0s(),t.EFF(3),t.k0s()),2&i){const e=t.XpG(4);t.R7$(3),t.SpI(" ",e.formatDate(e.invitation.lastResentAt)," ")}}function Jt(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",123)(1,"div",61)(2,"div",150)(3,"div",151)(4,"h6",152),t.EFF(5,"Invitation Status"),t.k0s(),t.j41(6,"p",153)(7,"strong"),t.EFF(8,"Email:"),t.k0s(),t.EFF(9),t.k0s(),t.j41(10,"p",153)(11,"strong"),t.EFF(12,"Status:"),t.k0s(),t.j41(13,"span",154),t.EFF(14),t.nI1(15,"titlecase"),t.k0s()(),t.j41(16,"p",153)(17,"strong"),t.EFF(18,"Sent:"),t.k0s(),t.EFF(19),t.k0s(),t.DNE(20,qt,4,1,"p",155)(21,Ut,4,1,"p",155),t.j41(22,"p",153)(23,"strong"),t.EFF(24,"Resent Count:"),t.k0s(),t.EFF(25),t.k0s(),t.j41(26,"p",156)(27,"strong"),t.EFF(28,"Expires:"),t.k0s(),t.EFF(29),t.k0s()(),t.j41(30,"div",157)(31,"button",158),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.resendInvitation())}),t.nrm(32,"i",50),t.EFF(33),t.k0s()()()()()}if(2&i){const e=t.XpG(3);t.R7$(9),t.SpI(" ",e.invitation.email," "),t.R7$(4),t.HbH(e.getInvitationStatusClass(e.invitation.status)),t.R7$(),t.SpI(" ",t.bMT(15,11,e.invitation.status)," "),t.R7$(5),t.SpI(" ",e.formatDate(e.invitation.invitedAt)," "),t.R7$(),t.Y8G("ngIf",e.invitation.acceptedAt),t.R7$(),t.Y8G("ngIf",e.invitation.lastResentAt),t.R7$(4),t.SpI(" ",e.invitation.resentCount," "),t.R7$(4),t.SpI(" ",e.formatDate(e.invitation.expiresAt)," "),t.R7$(2),t.Y8G("disabled","accepted"===e.invitation.status),t.R7$(2),t.SpI(" ","accepted"===e.invitation.status?"Invitation Accepted":"Resend Invitation"," ")}}function Ht(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",118),t.nrm(1,"i",159),t.j41(2,"h5"),t.EFF(3,"No Invitation Sent"),t.k0s(),t.j41(4,"p",70),t.EFF(5,"No client portal invitation has been sent to this client yet."),t.k0s(),t.j41(6,"button",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.resendInvitation())}),t.nrm(7,"i",50),t.EFF(8," Send Invitation "),t.k0s()()}}function Kt(i,o){if(1&i&&(t.j41(0,"div")(1,"h5",90),t.EFF(2,"Client Portal Invitation"),t.k0s(),t.DNE(3,Jt,34,13,"div",149)(4,Ht,9,0,"div",110),t.k0s()),2&i){const e=t.XpG(2);t.R7$(3),t.Y8G("ngIf",e.invitation),t.R7$(),t.Y8G("ngIf",!e.invitation)}}function Qt(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"div",60)(2,"div",55)(3,"div",61)(4,"div",62)(5,"div",63)(6,"div",64),t.EFF(7),t.k0s()(),t.j41(8,"h5",65),t.EFF(9),t.k0s(),t.j41(10,"p",66)(11,"span"),t.EFF(12),t.k0s()()(),t.j41(13,"div",67)(14,"table",68)(15,"tbody")(16,"tr")(17,"th",69),t.EFF(18,"Email :"),t.k0s(),t.j41(19,"td",70),t.EFF(20),t.k0s()(),t.j41(21,"tr")(22,"th",69),t.EFF(23,"Phone :"),t.k0s(),t.j41(24,"td",70),t.EFF(25),t.k0s()(),t.j41(26,"tr")(27,"th",69),t.EFF(28,"Status :"),t.k0s(),t.j41(29,"td")(30,"span",71),t.EFF(31),t.k0s()()(),t.j41(32,"tr")(33,"th",69),t.EFF(34,"Joined :"),t.k0s(),t.j41(35,"td",70),t.EFF(36),t.k0s()()()()()()(),t.j41(37,"div",55)(38,"div",61)(39,"h5",72),t.EFF(40,"Quick Stats"),t.k0s(),t.j41(41,"div",2)(42,"div",73)(43,"div",62)(44,"h4",74),t.EFF(45),t.k0s(),t.j41(46,"p",75),t.EFF(47,"Active Projects"),t.k0s()()(),t.j41(48,"div",73)(49,"div",62)(50,"h4",76),t.EFF(51),t.k0s(),t.j41(52,"p",75),t.EFF(53,"Completed"),t.k0s()()()(),t.j41(54,"div",77)(55,"div",73)(56,"div",62)(57,"h4",78),t.EFF(58),t.k0s(),t.j41(59,"p",75),t.EFF(60,"Pending Forms"),t.k0s()()(),t.j41(61,"div",73)(62,"div",62)(63,"h4",79),t.EFF(64),t.k0s(),t.j41(65,"p",75),t.EFF(66,"Documents"),t.k0s()()()()()()(),t.j41(67,"div",80)(68,"div",55)(69,"div",61)(70,"ul",81)(71,"li",82)(72,"a",83),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActiveTab("overview"))}),t.nrm(73,"i",84),t.j41(74,"span",85),t.EFF(75,"Overview"),t.k0s()()(),t.j41(76,"li",82)(77,"a",83),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActiveTab("projects"))}),t.nrm(78,"i",86),t.j41(79,"span",85),t.EFF(80,"Projects"),t.k0s()()(),t.j41(81,"li",82)(82,"a",83),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActiveTab("intake"))}),t.nrm(83,"i",87),t.j41(84,"span",85),t.EFF(85,"Intake Forms"),t.k0s()()(),t.j41(86,"li",82)(87,"a",83),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActiveTab("documents"))}),t.nrm(88,"i",88),t.j41(89,"span",85),t.EFF(90,"Documents"),t.k0s()()(),t.j41(91,"li",82)(92,"a",83),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.setActiveTab("invitation"))}),t.nrm(93,"i",89),t.j41(94,"span",85),t.EFF(95,"Invitation"),t.k0s()()()()()(),t.j41(96,"div",55)(97,"div",61),t.DNE(98,yt,14,4,"div",7)(99,Dt,9,3,"div",7)(100,Ot,6,3,"div",7)(101,zt,7,4,"div",7)(102,Kt,5,2,"div",7),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(7),t.Lme(" ",null==e.client.firstName?null:e.client.firstName.charAt(0),"",null==e.client.lastName?null:e.client.lastName.charAt(0)," "),t.R7$(2),t.Lme("",e.client.firstName," ",e.client.lastName,""),t.R7$(2),t.HbH("INDIVIDUAL"===e.client.entityType?"badge bg-primary":"badge bg-info"),t.R7$(),t.SpI(" ",e.client.entityType||"N/A"," "),t.R7$(8),t.JRh(e.client.email||"Not provided"),t.R7$(5),t.JRh(e.formatPhoneForDisplay(e.client.phone||"")||"Not provided"),t.R7$(5),t.Y8G("ngClass","active"===e.client.status?"bg-success":"lead"===e.client.status?"bg-warning":"invited"===e.client.status?"bg-primary":"bg-info"),t.R7$(),t.SpI(" ",e.client.status||"N/A"," "),t.R7$(5),t.JRh(e.formatDate(e.client.createdAt)),t.R7$(9),t.JRh(e.getActiveProjectsCount()),t.R7$(6),t.JRh(e.getCompletedProjectsCount()),t.R7$(7),t.JRh(e.getPendingIntakeFormsCount()),t.R7$(6),t.JRh(e.documents.length),t.R7$(8),t.AVh("active","overview"===e.activeTab),t.R7$(5),t.AVh("active","projects"===e.activeTab),t.R7$(5),t.AVh("active","intake"===e.activeTab),t.R7$(5),t.AVh("active","documents"===e.activeTab),t.R7$(5),t.AVh("active","invitation"===e.activeTab),t.R7$(6),t.Y8G("ngIf","overview"===e.activeTab),t.R7$(),t.Y8G("ngIf","projects"===e.activeTab),t.R7$(),t.Y8G("ngIf","intake"===e.activeTab),t.R7$(),t.Y8G("ngIf","documents"===e.activeTab),t.R7$(),t.Y8G("ngIf","invitation"===e.activeTab)}}function Zt(i,o){if(1&i){const e=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"div",55)(3,"div",56),t.nrm(4,"i",160),t.j41(5,"h5"),t.EFF(6,"Client Not Found"),t.k0s(),t.j41(7,"p",70),t.EFF(8,"The requested client could not be found."),t.k0s(),t.j41(9,"button",120),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goBack())}),t.nrm(10,"i",161),t.EFF(11," Back to Clients "),t.k0s()()()()()}}function Wt(i,o){1&i&&(t.j41(0,"div"),t.EFF(1,"First name is required"),t.k0s())}function te(i,o){if(1&i&&(t.j41(0,"div",162),t.DNE(1,Wt,2,0,"div",7),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.ef.firstName.errors?null:e.ef.firstName.errors.required)}}function ee(i,o){1&i&&(t.j41(0,"div"),t.EFF(1,"Last name is required"),t.k0s())}function ie(i,o){if(1&i&&(t.j41(0,"div",162),t.DNE(1,ee,2,0,"div",7),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.ef.lastName.errors?null:e.ef.lastName.errors.required)}}function ne(i,o){1&i&&(t.j41(0,"div"),t.EFF(1,"Please enter a valid email address"),t.k0s())}function le(i,o){if(1&i&&(t.j41(0,"div",162),t.DNE(1,ne,2,0,"div",7),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.ef.email.errors?null:e.ef.email.errors.email)}}function oe(i,o){1&i&&t.nrm(0,"span",163)}let C=(()=>{class i{constructor(e,l,n,s){this.route=e,this.router=l,this.apiService=n,this.formBuilder=s,this.destroy$=new pt.B,this.client=null,this.projects=[],this.ongoingProjects=[],this.intakeForms=[],this.documents=[],this.documentRequirements=[],this.invitation=null,this.isLoading=!1,this.activeTab="overview",this.editSubmitted=!1,this.editLoading=!1,this.projectStatuses=[{value:"active",label:"Active",class:"badge bg-success"},{value:"in_progress",label:"In Progress",class:"badge bg-primary"},{value:"completed",label:"Completed",class:"badge bg-info"},{value:"on_hold",label:"On Hold",class:"badge bg-warning"},{value:"cancelled",label:"Cancelled",class:"badge bg-danger"}],this.projectTypes=[{value:"tax_return",label:"Tax Return"},{value:"quarterly_filing",label:"Quarterly Filing"},{value:"business_setup",label:"Business Setup"},{value:"audit",label:"Audit"},{value:"consultation",label:"Consultation"},{value:"other",label:"Other"}]}ngOnInit(){this.initializeEditForm(),this.route.params.subscribe(e=>{this.clientId=+e.id,this.clientId&&this.loadClientDetails()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeEditForm(){this.editClientForm=this.formBuilder.group({firstName:["",[r.k0.required]],lastName:["",[r.k0.required]],email:["",[r.k0.email]],phoneNumber:[""],entityType:[""],status:[""]})}loadClientDetails(){this.isLoading=!0,this.apiService.getClientDetails(this.clientId).pipe((0,_.Q)(this.destroy$)).subscribe({next:e=>{if(e.success&&e.clientDetails){const l=e.clientDetails;this.client=l.client,this.projects=l.projects,this.ongoingProjects=l.ongoingProjects,this.intakeForms=l.intakeForms,this.documents=l.documents,this.documentRequirements=l.documentRequirements,this.invitation=l.invitation||null}this.isLoading=!1},error:e=>{console.error("Error loading client details:",e),this.isLoading=!1,c().fire({title:"Error",text:"Failed to load client details.",icon:"error"})}})}setActiveTab(e){this.activeTab=e}goBack(){this.router.navigate(["/clients/list"])}viewProject(e){this.router.navigate(["/tax-consultant/project-detail",e.id])}viewAllProjects(){this.router.navigate(["/tax-consultant/client-projects",this.clientId])}openIntakeForm(e){console.log("Opening intake form:",e),c().fire({title:"Coming Soon",text:"Intake form integration will be available once the backend API is ready.",icon:"info"})}downloadDocument(e){console.log("Downloading document:",e),c().fire({title:"Downloading...",text:"Please wait while we prepare your document.",icon:"info",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{c().showLoading()}}),this.apiService.downloadDocument(e.id).pipe((0,_.Q)(this.destroy$)).subscribe({next:l=>{const n=window.URL.createObjectURL(l),s=window.document.createElement("a");s.href=n,s.download=e.filename,window.document.body.appendChild(s),s.click(),window.document.body.removeChild(s),window.URL.revokeObjectURL(n),c().fire({title:"Download Complete!",text:`${e.filename} has been downloaded successfully.`,icon:"success",timer:3e3,showConfirmButton:!1})},error:l=>{console.error("Error downloading document:",l);let n="Failed to download document. Please try again.";404===l.status?n="Document not found. It may have been moved or deleted.":403===l.status?n="You do not have permission to download this document.":401===l.status&&(n="Your session has expired. Please log in again."),c().fire({title:"Download Failed",text:n,icon:"error",confirmButtonText:"OK"})}})}sendEmail(){this.client?.email?c().fire({title:"Send Email",text:`Send an email to ${this.client.firstName} ${this.client.lastName} (${this.client.email})?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#556ee6",cancelButtonColor:"#74788d",confirmButtonText:"Send Email",cancelButtonText:"Cancel"}).then(e=>{if(e.isConfirmed){const l=encodeURIComponent(`Tax Services - ${this.client.firstName} ${this.client.lastName}`),n=encodeURIComponent(`Dear ${this.client.firstName},\n\nI hope this email finds you well.\n\nBest regards,\nYour Tax Consultant`);window.open(`mailto:${this.client.email}?subject=${l}&body=${n}`,"_blank"),c().fire({title:"Email Client Opened",text:"Your default email application should now be open with a pre-filled message.",icon:"success",timer:3e3,showConfirmButton:!1})}}):c().fire({title:"No Email Address",text:"This client does not have an email address on file.",icon:"warning"})}resendInvitation(){this.client&&this.apiService.inviteClient(this.client.id,{message:"Client portal invitation from your tax consultant."}).pipe((0,_.Q)(this.destroy$)).subscribe({next:l=>{l.success&&(c().fire({title:"Success!",text:"Invitation sent successfully.",icon:"success"}),this.loadClientDetails())},error:l=>{console.error("Error sending invitation:",l),c().fire({title:"Error",text:"Failed to send invitation.",icon:"error"})}})}openEditModal(){this.client&&(this.editClientForm.patchValue({firstName:this.client.firstName||"",lastName:this.client.lastName||"",email:this.client.email||"",phoneNumber:this.formatPhoneForDisplay(this.client.phone||""),entityType:this.client.entityType||"",status:this.client.status||""}),this.editSubmitted=!1,this.editClientModal?.show())}updateClient(){if(this.editSubmitted=!0,this.editClientForm.invalid||!this.client)return;this.editLoading=!0;const e=this.editClientForm.value,l=e.phoneNumber?e.phoneNumber.replace(/\D/g,""):"",n={firstName:e.firstName.trim(),lastName:e.lastName.trim(),email:e.email?e.email.trim():null,phone:l||null,entityType:e.entityType||null,status:e.status||null};this.apiService.updateClient(this.client.id,n).pipe((0,_.Q)(this.destroy$)).subscribe({next:s=>{this.editLoading=!1,s.success&&(c().fire({title:"Success!",text:"Client updated successfully.",icon:"success"}),this.editClientModal?.hide(),this.loadClientDetails(),this.editClientForm.reset())},error:s=>{this.editLoading=!1,console.error("Error updating client:",s),c().fire({title:"Error",text:"Failed to update client.",icon:"error"})}})}formatPhoneForDisplay(e){if(!e)return"";const l=e.replace(/\D/g,"");return 10===l.length?`(${l.slice(0,3)}) ${l.slice(3,6)}-${l.slice(6)}`:e}formatDate(e){return e?new Date(e).toLocaleDateString():"Not set"}getProjectStatusClass(e){const l=this.projectStatuses.find(n=>n.value===e);return l?l.class:"badge bg-secondary"}getProjectStatusLabel(e){const l=this.projectStatuses.find(n=>n.value===e);return l?l.label:e}getProjectTypeLabel(e){const l=this.projectTypes.find(n=>n.value===e);return l?l.label:e}getInvitationStatusClass(e){switch(e){case"accepted":return"badge bg-success";case"sent":return"badge bg-primary";case"pending":return"badge bg-warning";case"expired":return"badge bg-danger";default:return"badge bg-secondary"}}getIntakeFormStatusClass(e){switch(e){case"completed":return"badge bg-success";case"submitted":return"badge bg-info";case"draft":return"badge bg-warning";default:return"badge bg-secondary"}}get ef(){return this.editClientForm.controls}getActiveProjectsCount(){return this.projects.filter(e=>"active"===e.status||"in_progress"===e.status).length}getCompletedProjectsCount(){return this.projects.filter(e=>"completed"===e.status).length}getPendingIntakeFormsCount(){return this.intakeForms.filter(e=>"draft"===e.response?.status||!e.response).length}formatFileSize(e){if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(p.nX),t.rXU(p.Ix),t.rXU(b.G),t.rXU(r.ze))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-client-detail"]],viewQuery:function(l,n){if(1&l&&t.GBs(ft,5),2&l){let s;t.mGM(s=t.lsd())&&(n.editClientModal=s.first)}},standalone:!0,features:[t.aNF],decls:88,vars:21,consts:[["editClientModal","bs-modal"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],["title","Go Back to Clients List",1,"bx","bx-arrow-back","me-2","cursor-pointer",3,"click"],[4,"ngIf"],[1,"page-title-right"],["type","button","class","btn btn-outline-success me-2","title","Send Email",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-primary me-2","title","Edit Client",3,"click",4,"ngIf"],["type","button","class","btn btn-primary","title","View All Projects",3,"click",4,"ngIf"],["class","row",4,"ngIf"],["bsModal","","tabindex","-1","aria-labelledby","editClientModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","editClientModalLabel",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"col-lg-6"],[1,"mb-3"],["for","editFirstName",1,"form-label"],[1,"text-danger"],["type","text","id","editFirstName","formControlName","firstName",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","editLastName",1,"form-label"],["type","text","id","editLastName","formControlName","lastName",1,"form-control"],["for","editEmail",1,"form-label"],["type","email","id","editEmail","formControlName","email",1,"form-control"],["for","editPhoneNumber",1,"form-label"],["type","tel","id","editPhoneNumber","formControlName","phoneNumber","placeholder","(555) 123-4567",1,"form-control"],["for","editEntityType",1,"form-label"],["id","editEntityType","formControlName","entityType",1,"form-select"],["value",""],["value","INDIVIDUAL"],["value","BUSINESS"],["for","editStatus",1,"form-label"],["id","editStatus","formControlName","status",1,"form-select"],["value","lead"],["value","invited"],["value","active"],["value","complete"],[1,"col-lg-12"],[1,"text-end"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],["type","button","title","Send Email",1,"btn","btn-outline-success","me-2",3,"click"],[1,"bx","bx-mail-send","me-1"],["type","button","title","Edit Client",1,"btn","btn-outline-primary","me-2",3,"click"],[1,"bx","bx-pencil","me-1"],["type","button","title","View All Projects",1,"btn","btn-primary",3,"click"],[1,"bx","bx-briefcase","me-1"],[1,"card"],[1,"card-body","text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"col-xl-4"],[1,"card-body"],[1,"text-center"],[1,"avatar-lg","mx-auto","mb-4"],[1,"avatar-title","bg-light","text-primary","rounded-circle","font-size-24"],[1,"font-size-16","mb-1"],[1,"text-muted","mb-3"],[1,"table-responsive"],[1,"table","table-borderless","mb-0"],["scope","row",1,"ps-0"],[1,"text-muted"],[1,"badge",3,"ngClass"],[1,"card-title","mb-3"],[1,"col-6"],[1,"mb-1","text-primary"],[1,"text-muted","mb-0","font-size-12"],[1,"mb-1","text-success"],[1,"row","mt-3"],[1,"mb-1","text-warning"],[1,"mb-1","text-info"],[1,"col-xl-8"],["role","tablist",1,"nav","nav-tabs","nav-tabs-custom","nav-justified"],[1,"nav-item"],["role","tab",1,"nav-link",3,"click"],[1,"bx","bx-home","font-size-20"],[1,"d-none","d-sm-block"],[1,"bx","bx-briefcase","font-size-20"],[1,"bx","bx-file","font-size-20"],[1,"bx","bx-folder","font-size-20"],[1,"bx","bx-mail-send","font-size-20"],[1,"card-title","mb-4"],[1,"col-md-6"],["class","text-muted text-center py-3",4,"ngIf"],["class","d-flex align-items-center mb-3",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","mb-3"],[1,"avatar-xs","me-3"],[1,"avatar-title","bg-light","text-primary","rounded-circle"],[1,"bx","bx-briefcase"],[1,"flex-grow-1"],[1,"mb-1","font-size-14"],[1,"text-muted","text-center","py-3"],[1,"bx","bx-briefcase","font-size-24","d-block","mb-2"],[1,"avatar-title","bg-light","text-info","rounded-circle"],[1,"bx","bx-file"],[1,"bx","bx-file","font-size-24","d-block","mb-2"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"card-title","mb-0"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bx","bx-plus","me-1"],["class","table-responsive",4,"ngIf"],["class","text-center py-5",4,"ngIf"],[1,"table","table-nowrap","align-middle","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf"],["class","text-muted mb-0 font-size-12",4,"ngIf"],[1,"badge","bg-light","text-dark"],["type","button","title","View Project Details",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bx","bx-show"],[1,"text-center","py-5"],[1,"bx","bx-briefcase","font-size-48","text-muted","d-block","mb-3"],["type","button",1,"btn","btn-primary",3,"click"],["class","col-md-6 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","mb-4"],[1,"card","border"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"text-muted","font-size-13","mb-2"],["class","text-muted font-size-12 mb-3",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bx","bx-edit","me-1"],[1,"text-muted","font-size-12","mb-3"],[1,"bx","bx-file","font-size-48","text-muted","d-block","mb-3"],["class","mt-4",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"avatar-title","bg-light","text-primary","rounded"],[1,"mb-0","font-size-14"],["type","button",1,"btn","btn-sm","btn-outline-success",3,"click","title"],[1,"bx","bx-download","me-1"],[1,"d-none","d-md-inline"],[1,"mt-4"],["class","col-md-6 mb-3",4,"ngFor","ngForOf"],[1,"col-md-6","mb-3"],[1,"card-body","p-3"],[1,"d-flex","justify-content-between","align-items-start"],[1,"text-muted","mb-2","font-size-12"],[1,"d-flex","align-items-center","gap-2"],["class","text-muted font-size-12",4,"ngIf"],[1,"font-size-20"],[1,"text-muted","font-size-12"],[1,"bx","bx-folder","font-size-48","text-muted","d-block","mb-3"],["class","card border",4,"ngIf"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"mb-2"],[1,"text-muted","mb-2"],[1,"ms-2"],["class","text-muted mb-2",4,"ngIf"],[1,"text-muted","mb-0"],[1,"col-md-4","text-end"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"bx","bx-mail-send","font-size-48","text-muted","d-block","mb-3"],[1,"bx","bx-user-x","font-size-48","text-muted","d-block","mb-3"],[1,"bx","bx-arrow-back","me-1"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(l,n){if(1&l){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",5)(5,"i",6),t.bIt("click",function(){return t.eBV(s),t.Njj(n.goBack())}),t.k0s(),t.DNE(6,_t,2,2,"span",7)(7,vt,2,0,"span",7),t.k0s(),t.j41(8,"div",8),t.DNE(9,bt,3,0,"button",9)(10,Ct,3,0,"button",10)(11,Ft,3,0,"button",11),t.k0s()()()(),t.DNE(12,gt,9,0,"div",12)(13,Qt,103,31,"div",12)(14,Zt,12,0,"div",12),t.k0s(),t.j41(15,"div",13,0)(17,"div",14)(18,"div",15)(19,"div",16)(20,"h5",17),t.EFF(21,"Edit Client"),t.k0s(),t.j41(22,"button",18),t.bIt("click",function(){t.eBV(s);const a=t.sdS(16);return t.Njj(null==a?null:a.hide())}),t.k0s()(),t.j41(23,"div",19)(24,"form",20),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(n.updateClient())}),t.j41(25,"div",2)(26,"div",21)(27,"div",22)(28,"label",23),t.EFF(29,"First Name "),t.j41(30,"span",24),t.EFF(31,"*"),t.k0s()(),t.nrm(32,"input",25),t.DNE(33,te,2,1,"div",26),t.k0s()(),t.j41(34,"div",21)(35,"div",22)(36,"label",27),t.EFF(37,"Last Name "),t.j41(38,"span",24),t.EFF(39,"*"),t.k0s()(),t.nrm(40,"input",28),t.DNE(41,ie,2,1,"div",26),t.k0s()()(),t.j41(42,"div",2)(43,"div",21)(44,"div",22)(45,"label",29),t.EFF(46,"Email"),t.k0s(),t.nrm(47,"input",30),t.DNE(48,le,2,1,"div",26),t.k0s()(),t.j41(49,"div",21)(50,"div",22)(51,"label",31),t.EFF(52,"Phone Number"),t.k0s(),t.nrm(53,"input",32),t.k0s()()(),t.j41(54,"div",2)(55,"div",21)(56,"div",22)(57,"label",33),t.EFF(58,"Entity Type"),t.k0s(),t.j41(59,"select",34)(60,"option",35),t.EFF(61,"Select Entity Type"),t.k0s(),t.j41(62,"option",36),t.EFF(63,"Individual"),t.k0s(),t.j41(64,"option",37),t.EFF(65,"Business"),t.k0s()()()(),t.j41(66,"div",21)(67,"div",22)(68,"label",38),t.EFF(69,"Status"),t.k0s(),t.j41(70,"select",39)(71,"option",35),t.EFF(72,"Select Status"),t.k0s(),t.j41(73,"option",40),t.EFF(74,"Lead"),t.k0s(),t.j41(75,"option",41),t.EFF(76,"Invited"),t.k0s(),t.j41(77,"option",42),t.EFF(78,"Active"),t.k0s(),t.j41(79,"option",43),t.EFF(80,"Complete"),t.k0s()()()()(),t.j41(81,"div",44)(82,"div",45)(83,"button",46),t.bIt("click",function(){t.eBV(s);const a=t.sdS(16);return t.Njj(null==a?null:a.hide())}),t.EFF(84,"Cancel"),t.k0s(),t.j41(85,"button",47),t.DNE(86,oe,1,0,"span",48),t.EFF(87," Update Client "),t.k0s()()()()()()()()}2&l&&(t.R7$(6),t.Y8G("ngIf",n.client),t.R7$(),t.Y8G("ngIf",!n.client),t.R7$(2),t.Y8G("ngIf",n.client&&n.client.email),t.R7$(),t.Y8G("ngIf",n.client),t.R7$(),t.Y8G("ngIf",n.client),t.R7$(),t.Y8G("ngIf",n.isLoading),t.R7$(),t.Y8G("ngIf",!n.isLoading&&n.client),t.R7$(),t.Y8G("ngIf",!n.isLoading&&!n.client),t.R7$(10),t.Y8G("formGroup",n.editClientForm),t.R7$(8),t.AVh("is-invalid",n.editSubmitted&&n.ef.firstName.errors),t.R7$(),t.Y8G("ngIf",n.editSubmitted&&n.ef.firstName.errors),t.R7$(7),t.AVh("is-invalid",n.editSubmitted&&n.ef.lastName.errors),t.R7$(),t.Y8G("ngIf",n.editSubmitted&&n.ef.lastName.errors),t.R7$(6),t.AVh("is-invalid",n.editSubmitted&&n.ef.email.errors),t.R7$(),t.Y8G("ngIf",n.editSubmitted&&n.ef.email.errors),t.R7$(35),t.Y8G("disabled",n.editLoading),t.R7$(2),t.Y8G("disabled",n.editLoading),t.R7$(),t.Y8G("ngIf",n.editLoading))},dependencies:[u.MD,u.YU,u.Sq,u.bT,u.PV,r.YN,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.X1,r.j4,r.JD,f.Q_,f.hZ],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.avatar-lg[_ngcontent-%COMP%]{height:5rem;width:5rem}.avatar-xs[_ngcontent-%COMP%]{height:2rem;width:2rem}.avatar-title[_ngcontent-%COMP%]{align-items:center;background-color:var(--bs-primary);color:#fff;display:flex;font-weight:500;height:100%;justify-content:center;width:100%}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border:none;color:#74788d;padding:12px 20px}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:transparent;border-bottom:2px solid var(--bs-primary);color:var(--bs-primary)}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{border:none;color:var(--bs-primary)}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#495057;border-top:none}.card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid rgba(0,0,0,.125)}.card-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500}.text-muted[_ngcontent-%COMP%]{color:#74788d!important}.font-size-12[_ngcontent-%COMP%]{font-size:.75rem!important}.font-size-13[_ngcontent-%COMP%]{font-size:.8125rem!important}.font-size-14[_ngcontent-%COMP%]{font-size:.875rem!important}.font-size-16[_ngcontent-%COMP%]{font-size:1rem!important}.font-size-18[_ngcontent-%COMP%]{font-size:1.125rem!important}.font-size-20[_ngcontent-%COMP%]{font-size:1.25rem!important}.font-size-24[_ngcontent-%COMP%]{font-size:1.5rem!important}.font-size-48[_ngcontent-%COMP%]{font-size:3rem!important}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);transition:all .2s ease-in-out}.card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026;transition:all .3s ease-in-out}.tab-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:8px 12px;font-size:.875rem}.nav-tabs-custom[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none!important}.page-title-box[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important;gap:1rem}.page-title-right[_ngcontent-%COMP%]{width:100%}.page-title-right[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}}.bg-success[_ngcontent-%COMP%]{background-color:#34c38f!important}.bg-primary[_ngcontent-%COMP%]{background-color:#556ee6!important}.bg-warning[_ngcontent-%COMP%]{background-color:#f1b44c!important}.bg-danger[_ngcontent-%COMP%]{background-color:#f46a6a!important}.bg-info[_ngcontent-%COMP%]{background-color:#50a5f1!important}.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;color:#495057!important}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.empty-state[_ngcontent-%COMP%]{padding:3rem 1rem;text-align:center}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.5;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#495057;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#74788d;margin-bottom:1.5rem}.modal-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.modal-title[_ngcontent-%COMP%]{color:#495057;font-weight:600}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:var(--bs-primary);box-shadow:0 0 0 .2rem #556ee640}.is-invalid[_ngcontent-%COMP%]{border-color:#f46a6a}.invalid-feedback[_ngcontent-%COMP%]{color:#f46a6a;font-size:.875rem}.quick-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{text-align:center;padding:1rem}.quick-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.25rem}.quick-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;letter-spacing:.5px;margin-bottom:0}.document-card[_ngcontent-%COMP%], .form-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.document-card[_ngcontent-%COMP%]:hover, .form-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1rem #00000026}.avatar-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;text-transform:uppercase}"]})}}return i})();var F=m(400);const se=[{path:"list",component:ut,canActivate:[F.K],data:{role:"ACCOUNTANT"}},{path:"detail/:id",component:C,canActivate:[F.K],data:{role:"ACCOUNTANT"}}];let ae=(()=>{class i{static{this.\u0275fac=function(l){return new(l||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[p.iI.forChild(se),p.iI]})}}return i})(),re=(()=>{class i{static{this.\u0275fac=function(l){return new(l||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[u.MD,ae,C]})}}return i})()}}]);
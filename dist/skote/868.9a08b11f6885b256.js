"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[868],{7868:(D,v,s)=>{s.r(v),s.d(v,{InvitationsModule:()=>G});var m=s(177),l=s(9417),p=s(803),g=s(6551),t=s(4438),u=s(6344);const f=(e,a)=>a.value,h=(e,a)=>a.id;function _(e,a){if(1&e&&(t.j41(0,"option",31),t.EFF(1),t.k0s()),2&e){const n=a.$implicit;t.Y8G("value",n.value),t.R7$(),t.JRh(n.label)}}function C(e,a){1&e&&(t.j41(0,"div",30)(1,"div",32)(2,"span",33),t.EFF(3,"Loading..."),t.k0s()(),t.j41(4,"p",34),t.EFF(5,"Loading invitations..."),t.k0s()())}function b(e,a){if(1&e&&(t.j41(0,"div",35),t.nrm(1,"i",36),t.EFF(2),t.k0s()),2&e){const n=t.XpG();t.R7$(2),t.SpI("",n.error," ")}}function F(e,a){if(1&e&&(t.EFF(0),t.nI1(1,"date")),2&e){const n=t.XpG().$implicit;t.SpI(" ",t.i5U(1,1,n.invitedAt,"medium")," ")}}function I(e,a){1&e&&(t.j41(0,"span",44),t.EFF(1,"-"),t.k0s())}function x(e,a){if(1&e&&(t.j41(0,"span",45),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const n=t.XpG().$implicit;t.Y8G("ngClass","expired"===n.status?"text-danger":"text-muted"),t.R7$(),t.SpI(" ",t.i5U(2,2,n.expiresAt,"medium")," ")}}function M(e,a){1&e&&(t.j41(0,"span",44),t.EFF(1,"-"),t.k0s())}function k(e,a){if(1&e&&(t.EFF(0),t.nI1(1,"date")),2&e){const n=t.XpG().$implicit;t.SpI(" ",t.i5U(1,1,n.acceptedAt,"medium")," ")}}function j(e,a){1&e&&(t.j41(0,"span",44),t.EFF(1,"-"),t.k0s())}function E(e,a){if(1&e){const n=t.RV6();t.j41(0,"button",46),t.bIt("click",function(){t.eBV(n);const o=t.XpG().$implicit,r=t.XpG(2);return t.Njj(r.resendInvitation(o))}),t.nrm(1,"i",47),t.k0s()}}function y(e,a){if(1&e){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"a",40),t.bIt("click",function(){const o=t.eBV(n).$implicit,r=t.XpG(2);return t.Njj(r.viewClientDetail(o))}),t.EFF(3),t.k0s()(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td")(7,"span",41),t.EFF(8),t.k0s()(),t.j41(9,"td"),t.DNE(10,F,2,4)(11,I,2,0),t.k0s(),t.j41(12,"td"),t.DNE(13,x,3,5,"span")(14,M,2,0),t.k0s(),t.j41(15,"td"),t.DNE(16,k,2,4)(17,j,2,0),t.k0s(),t.j41(18,"td")(19,"div",42),t.DNE(20,E,2,0,"button",43),t.k0s()()()}if(2&e){const n=a.$implicit,i=t.XpG(2);t.R7$(3),t.SpI(" ",n.clientName," "),t.R7$(2),t.JRh(n.email),t.R7$(2),t.Y8G("ngClass",i.getInvitationStatusClass(n.status)),t.R7$(),t.SpI(" ",i.getInvitationStatusText(n.status)," "),t.R7$(2),t.vxM(10,n.invitedAt?10:11),t.R7$(3),t.vxM(13,n.expiresAt?13:14),t.R7$(3),t.vxM(16,n.acceptedAt?16:17),t.R7$(4),t.vxM(20,i.canResendInvitation(n)?20:-1)}}function R(e,a){1&e&&t.EFF(0," No invitations found. Start by inviting clients from the client list. ")}function T(e,a){if(1&e&&t.EFF(0),2&e){const n=t.XpG(3);t.SpI(" No ",n.statusFilter," invitations found. ")}}function S(e,a){if(1&e&&(t.j41(0,"tr")(1,"td",48)(2,"div",44),t.nrm(3,"i",49),t.DNE(4,R,1,0)(5,T,1,1),t.k0s()()()),2&e){const n=t.XpG(2);t.R7$(4),t.vxM(4,"all"===n.statusFilter?4:5)}}function $(e,a){if(1&e&&(t.j41(0,"div",37)(1,"table",38)(2,"thead",39)(3,"tr")(4,"th"),t.EFF(5,"Client Name"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Email"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Status"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Sent Date"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Expires Date"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Accepted Date"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Actions"),t.k0s()()(),t.j41(18,"tbody"),t.Z7z(19,y,21,8,"tr",null,h,!1,S,6,1,"tr"),t.k0s()()()),2&e){const n=t.XpG();t.R7$(19),t.Dyx(n.filteredInvitations)}}let P=(()=>{class e{constructor(n,i){this.apiService=n,this.router=i,this.invitations=[],this.filteredInvitations=[],this.searchTerm="",this.loading=!1,this.error="",this.statusFilter="all",this.statusOptions=[{value:"all",label:"All Invitations"},{value:"pending",label:"Pending"},{value:"sent",label:"Sent"},{value:"accepted",label:"Accepted"},{value:"expired",label:"Expired"}]}ngOnInit(){this.breadCrumbItems=[{label:"Invitations"},{label:"Invitation Management",active:!0}],this.loadInvitations()}loadInvitations(){this.loading=!0,this.error="",this.apiService.getInvitations().subscribe({next:n=>{console.log("Invitations API Response:",n),console.log("Response type:",typeof n),console.log("Response keys:",Object.keys(n||{})),n&&n.success&&n.invitations?(console.log("Invitations array:",n.invitations),console.log("Invitations count:",n.invitations.length),this.invitations=n.invitations,this.applyFilters()):(console.warn("No invitations found in response or response format unexpected"),this.invitations=[],this.filteredInvitations=[]),this.loading=!1},error:n=>{console.error("Error loading invitations:",n),this.error="Failed to load invitations. Please try again.",this.loading=!1,(401===n.status||403===n.status)&&(this.error="Authentication failed. Please log in again.")}})}applyFilters(){let n=[...this.invitations];if("all"!==this.statusFilter&&(n=n.filter(i=>i.status===this.statusFilter)),this.searchTerm.trim()){const i=this.searchTerm.toLowerCase();n=n.filter(o=>o.clientName?.toLowerCase().includes(i)||o.email?.toLowerCase().includes(i))}this.filteredInvitations=n}onSearchChange(){this.applyFilters()}onStatusFilterChange(){this.applyFilters()}canResendInvitation(n){return"pending"===n.status||"expired"===n.status}resendInvitation(n){console.log("Sending invitation to:",n.clientName),n.id?confirm(`Send invitation email to ${n.clientName||n.email}?`)&&this.apiService.resendInvitation(n.id).subscribe({next:i=>{i.success&&(this.loadInvitations(),console.log("Invitation sent successfully!"),alert(`Invitation email sent successfully to ${n.clientName||n.email}!`))},error:i=>{console.error("Error sending invitation:",i),alert("Failed to send invitation email. Please try again.")}}):console.error("No invitation ID provided")}viewClientDetail(n){n.clientId&&this.router.navigate(["/clients/detail",n.clientId])}getInvitationStatusClass(n){switch(n){case"pending":return"bg-warning";case"sent":return"bg-info";case"accepted":return"bg-success";case"expired":return"bg-danger";default:return"bg-secondary"}}getInvitationStatusText(n){switch(n){case"pending":return"Pending";case"sent":return"Sent";case"accepted":return"Accepted";case"expired":return"Expired";default:return"Unknown"}}getInvitationStats(){return{total:this.invitations.length,pending:this.invitations.filter(c=>"pending"===c.status).length,sent:this.invitations.filter(c=>"sent"===c.status).length,accepted:this.invitations.filter(c=>"accepted"===c.status).length,expired:this.invitations.filter(c=>"expired"===c.status).length}}static{this.\u0275fac=function(i){return new(i||e)(t.rXU(u.G),t.rXU(p.Ix))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-invitation-management"]],standalone:!0,features:[t.aNF],decls:69,vars:9,consts:[[1,"container-fluid"],["title","Invitation Management",3,"breadcrumbItems"],[1,"row","mb-4"],[1,"col-xl-3","col-md-6"],[1,"card"],[1,"card-body"],[1,"d-flex"],[1,"flex-1","overflow-hidden"],[1,"text-truncate","font-size-14","mb-2"],[1,"mb-0"],[1,"text-primary"],[1,"bx","bx-mail-send","font-size-24"],[1,"text-warning"],[1,"bx","bx-time-five","font-size-24"],[1,"text-success"],[1,"bx","bx-check-circle","font-size-24"],[1,"text-danger"],[1,"bx","bx-x-circle","font-size-24"],[1,"row"],[1,"col-lg-12"],[1,"row","mb-2"],[1,"col-sm-4"],[1,"search-box","me-2","mb-2","d-inline-block"],[1,"position-relative"],["type","text","id","searchTableList","placeholder","Search invitations...",1,"form-control",3,"ngModelChange","ngModel"],[1,"bx","bx-search-alt","search-icon"],[1,"form-select",3,"ngModelChange","ngModel"],[1,"text-sm-end"],["type","button",1,"btn","btn-success","btn-rounded","waves-effect","waves-light","mb-2",3,"click","disabled"],[1,"mdi","mdi-refresh","me-1"],[1,"text-center","py-4"],[3,"value"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],["role","alert",1,"alert","alert-danger"],[1,"bx","bx-error-circle","me-2"],[1,"table-responsive"],[1,"table","table-nowrap","align-middle"],[1,"table-light"],["href","javascript:void(0)","title","View client details",1,"text-primary","fw-medium",3,"click"],[1,"badge",3,"ngClass"],[1,"d-flex","gap-2"],["type","button","title","Send Invitation Email",1,"btn","btn-sm","btn-outline-primary"],[1,"text-muted"],[3,"ngClass"],["type","button","title","Send Invitation Email",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bx","bx-mail-send"],["colspan","7",1,"text-center","py-4"],[1,"bx","bx-mail-send","font-size-48","text-muted","d-block","mb-2"]],template:function(i,o){1&i&&(t.j41(0,"div",0),t.nrm(1,"app-page-title",1),t.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"p",8),t.EFF(9,"Total Invitations"),t.k0s(),t.j41(10,"h4",9),t.EFF(11),t.k0s()(),t.j41(12,"div",10),t.nrm(13,"i",11),t.k0s()()()()(),t.j41(14,"div",3)(15,"div",4)(16,"div",5)(17,"div",6)(18,"div",7)(19,"p",8),t.EFF(20,"Pending"),t.k0s(),t.j41(21,"h4",9),t.EFF(22),t.k0s()(),t.j41(23,"div",12),t.nrm(24,"i",13),t.k0s()()()()(),t.j41(25,"div",3)(26,"div",4)(27,"div",5)(28,"div",6)(29,"div",7)(30,"p",8),t.EFF(31,"Accepted"),t.k0s(),t.j41(32,"h4",9),t.EFF(33),t.k0s()(),t.j41(34,"div",14),t.nrm(35,"i",15),t.k0s()()()()(),t.j41(36,"div",3)(37,"div",4)(38,"div",5)(39,"div",6)(40,"div",7)(41,"p",8),t.EFF(42,"Expired"),t.k0s(),t.j41(43,"h4",9),t.EFF(44),t.k0s()(),t.j41(45,"div",16),t.nrm(46,"i",17),t.k0s()()()()()(),t.j41(47,"div",18)(48,"div",19)(49,"div",4)(50,"div",5)(51,"div",20)(52,"div",21)(53,"div",22)(54,"div",23)(55,"input",24),t.mxI("ngModelChange",function(d){return t.DH7(o.searchTerm,d)||(o.searchTerm=d),d}),t.bIt("ngModelChange",function(){return o.onSearchChange()}),t.k0s(),t.nrm(56,"i",25),t.k0s()()(),t.j41(57,"div",21)(58,"select",26),t.mxI("ngModelChange",function(d){return t.DH7(o.statusFilter,d)||(o.statusFilter=d),d}),t.bIt("ngModelChange",function(){return o.onStatusFilterChange()}),t.Z7z(59,_,2,2,"option",null,f),t.k0s()(),t.j41(61,"div",21)(62,"div",27)(63,"button",28),t.bIt("click",function(){return o.loadInvitations()}),t.nrm(64,"i",29),t.EFF(65," Refresh "),t.k0s()()()(),t.DNE(66,C,6,0,"div",30)(67,b,3,1)(68,$,22,1),t.k0s()()()()()),2&i&&(t.R7$(),t.Y8G("breadcrumbItems",o.breadCrumbItems),t.R7$(10),t.JRh(o.getInvitationStats().total),t.R7$(11),t.JRh(o.getInvitationStats().pending),t.R7$(11),t.JRh(o.getInvitationStats().accepted),t.R7$(11),t.JRh(o.getInvitationStats().expired),t.R7$(11),t.R50("ngModel",o.searchTerm),t.R7$(3),t.R50("ngModel",o.statusFilter),t.R7$(),t.Dyx(o.statusOptions),t.R7$(4),t.Y8G("disabled",o.loading),t.R7$(3),t.vxM(66,o.loading?66:o.error?67:68))},dependencies:[m.MD,m.YU,m.vh,l.YN,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,g.T],styles:[".search-box[_ngcontent-%COMP%]{position:relative}.search-box[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;top:50%;right:12px;transform:translateY(-50%);color:#74788d;font-size:16px}.card[_ngcontent-%COMP%]{box-shadow:0 .75rem 1.5rem #12263f08;border:1px solid #eff2f7}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#495057;border-top:none}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;border-color:#eff2f7}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.35em .65em}.badge.bg-warning[_ngcontent-%COMP%]{color:#212529}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}.font-size-14[_ngcontent-%COMP%]{font-size:14px!important}.font-size-24[_ngcontent-%COMP%]{font-size:24px!important}.font-size-48[_ngcontent-%COMP%]{font-size:48px!important}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.btn-sm[_ngcontent-%COMP%]{padding:.2rem .4rem;font-size:.8rem}}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:transform .2s ease-in-out;box-shadow:0 1rem 2rem #12263f1a}"]})}}return e})();var w=s(964);const N=[{path:"",component:P,canActivate:[s(400).K],data:{role:"ACCOUNTANT"}},{path:"register/:token",component:w.I}];let z=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[p.iI.forChild(N),p.iI]})}}return e})(),G=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[m.MD,l.YN,l.X1,z]})}}return e})()}}]);